[{"title":"script æ ‡ç­¾çš„ defer ä¸ async å±æ€§ï¼ˆè½¬è½½ï¼‰","path":"/2023/03/17/async-and-defer/","content":"åŸæ–‡æˆ³è¿™é‡ŒğŸ‘‰ï¼šhttps://github.com/mrlmx/blogs/issues/4 å‰è¨€åœ¨é¢è¯•çš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€é“ç»å…¸çš„é¢è¯•é¢˜ï¼š å¦‚ä½•ä¼˜åŒ–ç½‘é¡µåŠ è½½é€Ÿåº¦ï¼Ÿ å¸¸è§„çš„å›ç­”ä¸­æ€»ä¼šæœ‰ä¸€æ¡ï¼š æŠŠ css æ–‡ä»¶æ”¾åœ¨é¡µé¢é¡¶éƒ¨ï¼ŒæŠŠ js æ–‡ä»¶æ”¾åœ¨é¡µé¢åº•éƒ¨ã€‚ é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦æŠŠ js æ–‡ä»¶æ”¾åœ¨é¡µé¢çš„æœ€åº•éƒ¨å‘¢ï¼Ÿ æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹è¿™æ®µä»£ç ï¼š 1234567891011121314&lt;!DOCTYPE html&gt;&lt;html lang=&quot;zh&quot;&gt; &lt;head&gt; &lt;title&gt;Hi&lt;/title&gt; &lt;script&gt; console.log(&quot;Howdy ~&quot;); &lt;/script&gt; &lt;script src=&quot;https://unpkg.com/vue@3.2.41/dist/vue.global.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;https://unpkg.com/vue-router@4.1.5/dist/vue-router.global.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; Hello ğŸ‘‹ğŸ» ~ &lt;/body&gt;&lt;/html&gt; ä»–çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼š åœ¨æ§åˆ¶å°æ‰“å°ï¼šHowdy ~ è¯·æ±‚å¹¶æ‰§è¡Œ vue.global.js è¯·æ±‚å¹¶æ‰§è¡Œ vue-router.global.js åœ¨é¡µé¢ä¸­å±•ç¤ºï¼šHello ğŸ‘‹ğŸ» ~ è§¦å‘ DOMContentLoaded äº‹ä»¶ æµè§ˆå™¨çš„è§£æè§„åˆ™æ˜¯ï¼šå¦‚æœé‡åˆ° script æ ‡ç­¾ï¼Œåˆ™æš‚åœæ„å»º DOMï¼Œè½¬è€Œå¼€å§‹æ‰§è¡Œ script æ ‡ç­¾ï¼Œå¦‚æœæ˜¯å¤–éƒ¨ scriptï¼Œé‚£ä¹ˆæµè§ˆå™¨è¿˜éœ€è¦ä¸€ç›´ç­‰å¾…å…¶ã€Œä¸‹è½½ã€å¹¶ã€Œæ‰§è¡Œã€åï¼Œå†ç»§ç»­è§£æåé¢çš„ HTMLã€‚ å¦‚æœè¯·æ±‚å¹¶æ‰§è¡Œã€Œvue.global.jsã€éœ€è¦ 3 ç§’ï¼Œã€Œvue-router.global.jsã€éœ€è¦ 2 ç§’ï¼Œé‚£ä¹ˆé¡µé¢ä¸­çš„ Hello ğŸ‘‹ğŸ» ~ï¼Œåˆ™è‡³å°‘éœ€è¦ 5 ç§’ä»¥ä¸Šæ‰ä¼šå±•ç¤ºå‡ºæ¥ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œscript æ ‡ç­¾ä¼šé˜»å¡æµè§ˆå™¨è§£æ HTMLï¼Œå¦‚æœæŠŠ script éƒ½æ”¾åœ¨ head ä¸­ï¼Œåœ¨ç½‘ç»œä¸ä½³çš„æƒ…å†µä¸‹ï¼Œå°±ä¼šå¯¼è‡´é¡µé¢é•¿æœŸå¤„äºç™½å±çŠ¶æ€ã€‚ åœ¨å¾ˆä¹…ä»¥å‰ï¼Œä¸€èˆ¬éƒ½æ˜¯å°†è¿™äº›å¤–è”è„šæœ¬ï¼Œæ”¾åœ¨ body æ ‡ç­¾çš„æœ€åé¢ï¼Œç¡®ä¿å…ˆè§£æå±•ç¤º body ä¸­çš„å†…å®¹ï¼Œç„¶åå†ä¸€ä¸ªä¸ªè¯·æ±‚æ‰§è¡Œè¿™äº›å¤–è”è„šæœ¬ã€‚ é‚£æœ‰æ²¡æœ‰å…¶ä»–æ›´ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆå‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œç°åœ¨ script æ ‡ç­¾æ–°å¢äº† 2 ä¸ªå±æ€§ï¼šdefer å’Œ asyncï¼Œå°±æ˜¯ä¸ºäº†è§£å†³æ­¤ç±»é—®é¢˜ï¼Œæå‡é¡µé¢æ€§èƒ½çš„ã€‚ &lt;script defer&gt;å…ˆçœ‹ä¸€ä¸‹ MDN ä¸Šçš„è§£é‡Šï¼š è¿™ä¸ªå¸ƒå°”å±æ€§è¢«è®¾å®šç”¨æ¥é€šçŸ¥æµè§ˆå™¨è¯¥è„šæœ¬å°†åœ¨æ–‡æ¡£å®Œæˆè§£æåï¼Œè§¦å‘ DOMContentLoaded äº‹ä»¶å‰æ‰§è¡Œã€‚æœ‰ defer å±æ€§çš„è„šæœ¬ä¼šé˜»æ­¢ DOMContentLoaded äº‹ä»¶ï¼Œç›´åˆ°è„šæœ¬è¢«åŠ è½½å¹¶ä¸”è§£æå®Œæˆã€‚ æ–‡æ¡£æ˜¯ç›´æ¥æ€»ç»“äº†ä»–çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼Œå±•å¼€è¯´è¯´ç»†èŠ‚ï¼ŒåŠ æ·±ä¸€ä¸‹ç†è§£ã€‚ 1234567891011121314&lt;!DOCTYPE html&gt;&lt;html lang=&quot;zh&quot;&gt; &lt;head&gt; &lt;title&gt;Hi&lt;/title&gt; &lt;script&gt; console.log(&quot;Howdy ~&quot;); &lt;/script&gt; &lt;script defer src=&quot;https://unpkg.com/vue@3.2.41/dist/vue.global.js&quot;&gt;&lt;/script&gt; &lt;script defer src=&quot;https://unpkg.com/vue-router@4.1.5/dist/vue-router.global.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; Hello ğŸ‘‹ğŸ» ~ &lt;/body&gt;&lt;/html&gt; ä»–çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼š åœ¨æ§åˆ¶å°æ‰“å°ï¼šHowdy ~ åœ¨é¡µé¢ä¸­å±•ç¤ºï¼šHello ğŸ‘‹ğŸ» ~ è¯·æ±‚å¹¶æ‰§è¡Œ vue.global.js è¯·æ±‚å¹¶æ‰§è¡Œ vue-router.global.js è§¦å‘ DOMContentLoaded äº‹ä»¶ å¦‚æœåœ¨ script æ ‡ç­¾ä¸Šè®¾ç½®äº† defer å±æ€§ï¼Œé‚£ä¹ˆåœ¨æµè§ˆå™¨è§£æåˆ°è¿™é‡Œæ—¶ï¼Œä¼šé»˜é»˜çš„åœ¨åå°å¼€å§‹ä¸‹è½½æ­¤è„šæœ¬ï¼Œå¹¶ç»§ç»­è§£æåé¢çš„ HTMLï¼Œå¹¶ä¸ä¼šé˜»å¡è§£ææ“ä½œã€‚ ç­‰åˆ° HTML è§£æå®Œæˆä¹‹åï¼Œæµè§ˆå™¨ä¼šç«‹å³æ‰§è¡Œåå°ä¸‹è½½çš„è„šæœ¬ï¼Œè„šæœ¬æ‰§è¡Œå®Œæˆä¹‹åï¼Œæ‰ä¼šè§¦å‘ DOMContentLoaded äº‹ä»¶ã€‚ çœ‹èµ·æ¥è¿˜æ˜¯è›®å¥½ç†è§£çš„å§ï¼Ÿå’±ä»¬å†æ¥è®¨è®º 2 ä¸ªå°ç»†èŠ‚ï¼š Q1ï¼šå¦‚æœ HTML è§£æå®Œæˆä¹‹åï¼Œè®¾ç½®äº† defer å±æ€§çš„è„šæœ¬è¿˜æ²¡ä¸‹è½½å®Œæˆï¼Œä¼šæ€æ ·ï¼ŸA1ï¼šæµè§ˆå™¨ä¼šç­‰è„šæœ¬ä¸‹è½½å®Œæˆä¹‹åï¼Œå†æ‰§è¡Œæ­¤è„šæœ¬ï¼Œæ‰§è¡Œå®Œæˆä¹‹åï¼Œå†è§¦å‘ DOMContentLoaded äº‹ä»¶ã€‚ Q2ï¼šå¦‚æœæœ‰å¤šä¸ªè®¾ç½®äº† defer å±æ€§çš„è„šæœ¬ï¼Œé‚£æµè§ˆå™¨ä¼šå¦‚ä½•å¤„ç†ï¼ŸA2ï¼šæµè§ˆå™¨ä¼šå¹¶è¡Œçš„åœ¨åå°ä¸‹è½½è¿™äº›è„šæœ¬ï¼Œç­‰ HTML è§£æå®Œæˆï¼Œå¹¶ä¸”æ‰€æœ‰è„šæœ¬ä¸‹è½½å®Œæˆä¹‹åï¼Œå†æŒ‰ç…§ä»–ä»¬åœ¨ HTML ä¸­å‡ºç°çš„ç›¸å¯¹é¡ºåºæ‰§è¡Œï¼Œç­‰æ‰€æœ‰è„šæœ¬æ‰§è¡Œå®Œæˆä¹‹åï¼Œå†è§¦å‘ DOMContentLoaded äº‹ä»¶ã€‚ æœ€ä½³å®è·µï¼š å»ºè®®æ‰€æœ‰çš„å¤–è”è„šæœ¬éƒ½é»˜è®¤è®¾ç½®æ­¤å±æ€§ï¼Œå› ä¸ºä»–ä¸ä¼šé˜»å¡ HTML è§£æï¼Œå¯ä»¥å¹¶è¡Œä¸‹è½½ JavaScript èµ„æºï¼Œè¿˜å¯ä»¥æŒ‰ç…§ä»–ä»¬åœ¨ HTML ä¸­çš„ç›¸å¯¹é¡ºåºæ‰§è¡Œï¼Œç¡®ä¿æœ‰ä¾èµ–å…³ç³»çš„è„šæœ¬è¿è¡Œæ—¶ï¼Œä¸ä¼šç¼ºå°‘ä¾èµ–ã€‚ åœ¨ SPA çš„åº”ç”¨ä¸­ï¼Œå¯ä»¥è€ƒè™‘æŠŠæ‰€æœ‰çš„ script æ ‡ç­¾åŠ ä¸Š defer å±æ€§ï¼Œå¹¶ä¸”æ”¾åˆ° body çš„æœ€åé¢ã€‚åœ¨ç°ä»£æµè§ˆå™¨ä¸­ï¼Œå¯ä»¥å¹¶è¡Œä¸‹è½½æå‡é€Ÿåº¦ï¼Œä¹Ÿå¯ä»¥ç¡®ä¿åœ¨è€æµè§ˆå™¨ä¸­ï¼Œä¸é˜»å¡æµè§ˆå™¨è§£æ HTMLï¼Œèµ·åˆ°é™çº§çš„ä½œç”¨ã€‚ æ³¨æ„ï¼š defer å±æ€§ä»…é€‚ç”¨äºå¤–éƒ¨è„šæœ¬ï¼Œå¦‚æœ script è„šæœ¬æ²¡æœ‰ srcï¼Œåˆ™ä¼šå¿½ç•¥ defer ç‰¹æ€§ã€‚ defer å±æ€§å¯¹æ¨¡å—è„šæœ¬ï¼ˆ&lt;script type=&#39;module&#39;&gt;&lt;/script&gt;ï¼‰æ— æ•ˆï¼Œå› ä¸ºæ¨¡å—è„šæœ¬å°±æ˜¯ä»¥ defer çš„å½¢å¼åŠ è½½çš„ã€‚ &lt;script async&gt;æŒ‰ç…§æƒ¯ä¾‹ï¼Œå…ˆçœ‹ä¸€ä¸‹ MDN ä¸Šçš„è§£é‡Šï¼š å¯¹äºæ™®é€šè„šæœ¬ï¼Œå¦‚æœå­˜åœ¨ async å±æ€§ï¼Œé‚£ä¹ˆæ™®é€šè„šæœ¬ä¼šè¢«å¹¶è¡Œè¯·æ±‚ï¼Œå¹¶å°½å¿«è§£æå’Œæ‰§è¡Œã€‚å¯¹äºæ¨¡å—è„šæœ¬ï¼Œå¦‚æœå­˜åœ¨ async å±æ€§ï¼Œé‚£ä¹ˆè„šæœ¬åŠå…¶æ‰€æœ‰ä¾èµ–éƒ½ä¼šåœ¨å»¶ç¼“é˜Ÿåˆ—ä¸­æ‰§è¡Œï¼Œå› æ­¤å®ƒä»¬ä¼šè¢«å¹¶è¡Œè¯·æ±‚ï¼Œå¹¶å°½å¿«è§£æå’Œæ‰§è¡Œã€‚è¯¥å±æ€§èƒ½å¤Ÿæ¶ˆé™¤è§£æé˜»å¡çš„ Javascriptã€‚è§£æé˜»å¡çš„ Javascript ä¼šå¯¼è‡´æµè§ˆå™¨å¿…é¡»åŠ è½½å¹¶ä¸”æ‰§è¡Œè„šæœ¬ï¼Œä¹‹åæ‰èƒ½ç»§ç»­è§£æã€‚ æ„Ÿè§‰è¿™æ®µæè¿°çš„å·²ç»è›®æ¸…æ™°äº†ï¼Œä¸è¿‡å’±ä»¬è¿˜æ˜¯å…ˆçœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼Œå±•å¼€è¯´è¯´ç»†èŠ‚ï¼ŒåŠ æ·±ä¸€ä¸‹ç†è§£ã€‚ 1234567891011121314&lt;!DOCTYPE html&gt;&lt;html lang=&quot;zh&quot;&gt; &lt;head&gt; &lt;title&gt;Hi&lt;/title&gt; &lt;script&gt; console.log(&quot;Howdy ~&quot;); &lt;/script&gt; &lt;script async src=&quot;https://google-analytics.com/analytics.js&quot;&gt;&lt;/script&gt; &lt;script async src=&quot;https://ads.google.cn/ad.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; Hello ğŸ‘‹ğŸ» ~ &lt;/body&gt;&lt;/html&gt; ä»–çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼š åœ¨æ§åˆ¶å°æ‰“å°ï¼šHowdy ~ å¹¶è¡Œè¯·æ±‚ analytics.js å’Œ ad.js åœ¨é¡µé¢ä¸­å±•ç¤ºï¼šHello ğŸ‘‹ğŸ» ~ æ ¹æ®ç½‘ç»œçš„å®é™…æƒ…å†µï¼Œä»¥ä¸‹å‡ é¡¹ä¼šæ— åºæ‰§è¡Œ æ‰§è¡Œ analytics.js ï¼ˆä¸‹è½½å®Œåï¼Œç«‹å³æ‰§è¡Œï¼‰ æ‰§è¡Œ ad.js ï¼ˆä¸‹è½½å®Œåï¼Œç«‹å³æ‰§è¡Œï¼‰ è§¦å‘ DOMContentLoaded äº‹ä»¶ï¼ˆå¯èƒ½åœ¨åœ¨ä¸Šé¢ 2 ä¸ªè„šæœ¬ä¹‹å‰ï¼Œä¹‹é—´ï¼Œä¹‹åè§¦å‘ï¼‰ æµè§ˆå™¨åœ¨è§£æåˆ°å¸¦æœ‰ async å±æ€§çš„ script æ ‡ç­¾æ—¶ï¼Œä¹Ÿä¸ä¼šé˜»å¡é¡µé¢ï¼ŒåŒæ ·æ˜¯åœ¨åå°é»˜é»˜ä¸‹è½½æ­¤è„šæœ¬ã€‚å½“ä»–ä¸‹è½½å®Œåï¼Œæµè§ˆå™¨ä¼šæš‚åœè§£æ HTMLï¼Œç«‹é©¬æ‰§è¡Œæ­¤è„šæœ¬ã€‚ çœ‹èµ·æ¥è¿˜æ˜¯è›®å¥½ç†è§£çš„å§ï¼Ÿå’±ä»¬å†æ¥è®¨è®º 2 ä¸ªå°ç»†èŠ‚ï¼š Q1ï¼šå¦‚æœè®¾ç½®äº† async å±æ€§çš„ script ä¸‹è½½å®Œä¹‹åï¼Œæµè§ˆå™¨è¿˜æ²¡è§£æå®Œ HTMLï¼Œä¼šæ€æ ·ï¼ŸA1ï¼šæµè§ˆå™¨ä¼šæš‚åœè§£æ HTMLï¼Œç«‹é©¬æ‰§è¡Œæ­¤è„šæœ¬ï¼Œç­‰æ‰§è¡Œå®Œä¹‹åï¼Œå†ç»§ç»­è§£æ HTMLã€‚ Q2ï¼šå¦‚æœæœ‰å¤šä¸ª async å±æ€§çš„ script æ ‡ç­¾ï¼Œé‚£ç­‰ä»–ä»¬ä¸‹è½½å®Œæˆä¹‹åï¼Œä¼šæŒ‰ç…§ä»£ç é¡ºåºæ‰§è¡Œå—ï¼ŸA2ï¼šä¸ä¼šã€‚æ‰§è¡Œé¡ºåºæ˜¯ï¼šè°å…ˆä¸‹è½½å®Œæˆï¼Œè°å…ˆæ‰§è¡Œã€‚async çš„ç‰¹ç‚¹æ˜¯ã€Œå®Œå…¨ç‹¬ç«‹ã€ï¼Œä¸ä¾èµ–å…¶ä»–å†…å®¹ã€‚ æœ€ä½³å®è·µï¼š å½“æˆ‘ä»¬çš„é¡¹ç›®ï¼Œéœ€è¦é›†æˆå…¶ä»–ç‹¬ç«‹çš„ç¬¬ä¸‰æ–¹åº“æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ­¤å±æ€§ï¼Œä»–ä»¬ä¸ä¾èµ–æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¹Ÿä¸ä¾èµ–äºä»–ä»¬ã€‚é€šè¿‡è®¾ç½®æ­¤å±æ€§ï¼Œè®©æµè§ˆå™¨å¼‚æ­¥ä¸‹è½½å¹¶æ‰§è¡Œä»–ï¼Œæ˜¯ä¸ªä¸é”™çš„ä¼˜åŒ–æ–¹æ¡ˆã€‚ æ³¨æ„ï¼š async ç‰¹æ€§ä»…é€‚ç”¨äºå¤–éƒ¨è„šæœ¬ï¼Œå¦‚æœ script è„šæœ¬æ²¡æœ‰ srcï¼Œåˆ™ä¼šå¿½ç•¥ async ç‰¹æ€§ã€‚ æ€»ç»“defer ä¸é˜»å¡æµè§ˆå™¨è§£æ HTMLï¼Œç­‰è§£æå®Œ HTML ä¹‹åï¼Œæ‰ä¼šæ‰§è¡Œ scriptã€‚ ä¼šå¹¶è¡Œä¸‹è½½ JavaScript èµ„æºã€‚ ä¼šæŒ‰ç…§ HTML ä¸­çš„ç›¸å¯¹é¡ºåºæ‰§è¡Œè„šæœ¬ã€‚ ä¼šåœ¨è„šæœ¬ä¸‹è½½å¹¶æ‰§è¡Œå®Œæˆä¹‹åï¼Œæ‰ä¼šè§¦å‘ DOMContentLoaded äº‹ä»¶ã€‚ åœ¨è„šæœ¬æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸€å®šå¯ä»¥è·å–åˆ° HTML ä¸­å·²æœ‰çš„å…ƒç´ ã€‚ defer å±æ€§å¯¹æ¨¡å—è„šæœ¬æ— æ•ˆã€‚ é€‚ç”¨äºï¼šæ‰€æœ‰å¤–éƒ¨è„šæœ¬ï¼ˆé€šè¿‡ src å¼•ç”¨çš„ scriptï¼‰ã€‚ async ä¸é˜»å¡æµè§ˆå™¨è§£æ HTMLï¼Œä½†æ˜¯ script ä¸‹è½½å®Œæˆåï¼Œä¼šç«‹å³ä¸­æ–­æµè§ˆå™¨è§£æ HTMLï¼Œå¹¶æ‰§è¡Œæ­¤ scriptã€‚ ä¼šå¹¶è¡Œä¸‹è½½ JavaScript èµ„æºã€‚ äº’ç›¸ç‹¬ç«‹ï¼Œè°å…ˆä¸‹è½½å®Œï¼Œè°å…ˆæ‰§è¡Œï¼Œæ²¡æœ‰å›ºå®šçš„å…ˆåé¡ºåºï¼Œä¸å¯æ§ã€‚ ç”±äºæ²¡æœ‰ç¡®å®šçš„æ‰§è¡Œæ—¶æœºï¼Œæ‰€ä»¥åœ¨è„šæœ¬é‡Œé¢å¯èƒ½ä¼šè·å–ä¸åˆ° HTML ä¸­å·²æœ‰çš„å…ƒç´ ã€‚ DOMContentLoaded äº‹ä»¶å’Œ script è„šæœ¬æ— ç›¸å…³æ€§ï¼Œæ— æ³•ç¡®å®šä»–ä»¬çš„å…ˆåé¡ºåºã€‚ é€‚ç”¨äºï¼šç‹¬ç«‹çš„ç¬¬ä¸‰æ–¹è„šæœ¬ã€‚ å¦å¤–ï¼šasync å’Œ defer ä¹‹é—´æœ€å¤§çš„åŒºåˆ«åœ¨äºå®ƒä»¬çš„æ‰§è¡Œæ—¶æœºã€‚ One More Thing ä½ æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œå¦‚æœä¸€ä¸ª script æ ‡ç­¾åŒæ—¶è®¾ç½® defer å’Œ asyncï¼Œæµè§ˆå™¨ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ å…ˆè¯´ç»“è®ºï¼šä»è¡¨ç°å½¢å¼ä¸Šæ¥è¯´ï¼Œasync çš„ä¼˜å…ˆçº§æ¯” defer é«˜ï¼Œä¹Ÿå°±æ˜¯å¦‚æœåŒæ—¶å­˜åœ¨è¿™ 2 ä¸ªå±æ€§ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°†ä¼šä»¥ async çš„ç‰¹æ€§å»åŠ è½½æ­¤è„šæœ¬ã€‚ è¿™ä¸»è¦åˆ† 2 ç§æƒ…å†µï¼š å¦‚æœæ˜¯ã€Œæ™®é€šè„šæœ¬ã€ï¼Œæµè§ˆå™¨ä¼šä¼˜å…ˆåˆ¤æ–­ async å±æ€§æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ä»¥ async ç‰¹æ€§å»åŠ è½½æ­¤è„šæœ¬ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå†å»åˆ¤æ–­æ˜¯å¦å­˜åœ¨ defer å±æ€§ã€‚ å¦‚æœæ˜¯ã€Œæ¨¡å—è„šæœ¬ã€ï¼Œæµè§ˆå™¨ä¼šåˆ¤æ–­ async å±æ€§æ˜¯å¦å­˜åœ¨ï¼š å¦‚æœå­˜åœ¨ï¼Œæµè§ˆå™¨ä¼šå¹¶è¡Œä¸‹è½½æ­¤æ¨¡å—å’Œä»–çš„æ‰€æœ‰ä¾èµ–æ¨¡å—ï¼Œç­‰å…¨éƒ¨ä¸‹è½½å®Œæˆä¹‹åï¼Œä¼šç«‹åˆ»æ‰§è¡Œæ­¤è„šæœ¬ã€‚ å¦‚æœä¸å­˜åœ¨ï¼Œæµè§ˆå™¨ä¹Ÿä¼šå¹¶è¡Œä¸‹è½½æ­¤æ¨¡å—å’Œä»–çš„æ‰€æœ‰ä¾èµ–æ¨¡å—ï¼Œç„¶åç­‰æµè§ˆå™¨è§£æå®Œ HTML ä¹‹åï¼Œå†æ‰§è¡Œæ­¤è„šæœ¬ã€‚ å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼šåœ¨æ¨¡å—è„šæœ¬ä¸Šè®¾ç½® defer å±æ€§æ˜¯æ— æ•ˆçš„ã€‚ ä¸€å›¾èƒœåƒè¨€ æœ€åï¼Œç”¨ä¸€å¼ å›¾æ¦‚æ‹¬ä¸€ä¸‹è¿™ä¸¤ä¸ªå±æ€§çš„åŠ è½½æ¨¡å¼å§ï¼š æ€è€ƒé¢˜ğŸ¤” ä¸ºä»€ä¹ˆæµè§ˆå™¨åœ¨è§£æåˆ°æ™®é€šçš„ script æ ‡ç­¾æ—¶ï¼Œå¿…é¡»å…ˆæ‰§è¡Œä»–ï¼Ÿ æ™®é€šçš„ script æ ‡ç­¾ä¼šé˜»å¡æµè§ˆå™¨è§£æ HTMLï¼Œè¿™ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜ï¼Ÿ","tags":["async","defer"],"categories":["å­¦ä¹ ç¬”è®°"]},{"title":"æ³›å‹ç¼–ç¨‹ï¼ˆä¸‹ï¼‰","path":"/2023/02/07/typescript/ts-10/","content":"ä»‹ç»ä¸€äº› TS å†…ç½®å·¥å…·ç±»å‹çš„ç”¨æ³•åŠå®ç° Readonly &amp; Mutable123456789101112131415161718192021type Person = &#123; id: number; name: string; age: number &#125;;type Readonly&lt;T&gt; = &#123; readonly [K in keyof T]: T[K];&#125;;type X1 = Readonly&lt;Person&gt;;// &#123;// readonly id: number;// readonly name: string;// readonly age: number;// &#125;type Mutable&lt;T&gt; = &#123; -readonly [K in keyof T]: T[K];&#125;;type X9 = Mutable&lt;Readonly&lt;Person&gt;&gt;;// &#123;// id: number;// name: string;// age: number;// &#125; æ³¨æ„ï¼š Mutable å¹¶ä¸æ˜¯ TS å†…ç½®çš„å‡½æ•° -readonly [] è¡¨ç¤ºå»æ‰å±æ€§å‰é¢çš„ Readonly Partial &amp; Required123456789101112131415161718192021type Person = &#123; id: number; name: string; age: number &#125;;type Partial&lt;T&gt; = &#123; [K in keyof T]?: T[K];&#125;;type X2 = Partial&lt;Person&gt;;// &#123;// id?: number;// name?: string;// age?: number;// &#125;type Required&lt;T&gt; = &#123; [K in keyof T]-?: T[K];&#125;;type X3 = Required&lt;Person&gt;;// &#123;// id: number;// name: string;// age: number;// &#125; æ³¨æ„ -?ï¼Œè¡¨ç¤ºå»æ‰å±æ€§çš„å¯é€‰ï¼Œå˜ä¸ºå¿…é€‰ Exclude &amp; Extract12345type Exclude&lt;A, B&gt; = A extends B ? never : A;type X5 = Exclude&lt;1 | 2 | 3, 1 | 2&gt;; // 3type Extract&lt;A, B&gt; = A extends B ? A : never;type X6 = Extract&lt;1 | 2 | 3, 2 | 4&gt;; // 2 æŒ‰ç…§ä¹‹å‰è®²çš„ä¹˜æ³•åˆ†é…å¾‹ï¼Œæœ‰å¦‚ä¸‹ç†è§£è¿‡ç¨‹ï¼š 12345678type X5 = 1 | 2 | 3 extends 1 | 2 ? never : Atype X5 = | 1 extends 1 | 2 ? never : 1 // never| 2 extends 1 | 2 ? never : 2 // never| 3 extends 1 | 2 ? never : 3 // 3type X5 = never | never | 3 // 3 X6 çš„ç†è§£è¿‡ç¨‹åŒ X5ï¼Œè¿™é‡Œä¸èµ˜è¿° Omit &amp; Pick12345678910111213type Person = &#123; id: number; name: string; age: number &#125;;type Omit&lt;T, Key extends keyof T&gt; = Pick&lt;T, Exclude&lt;keyof T, Key&gt;&gt;;// æˆ–è€…type Omit&lt;T, Key&gt; = &#123; [K2 in keyof T as (K2 extends Key ? never : K2)]: T[K2];&#125;;type X7 = Omit&lt;Person, &#x27;name&#x27; | &#x27;age&#x27;&gt;; // &#123; id: number &#125;type Pick&lt;T, Key extends keyof T&gt; = &#123; [K2 in Key]: T[K2];&#125;;type X8 = Pick&lt;Person, &#x27;name&#x27; | &#x27;age&#x27;&gt;; // &#123; name: string; age: number &#125; Key extends keyof T æ˜¯ä¸€ä¸ªæ³›å‹çº¦æŸï¼Œçº¦æŸæ‰€ä¼ çš„ key å¿…é¡»åŒ…å«åœ¨ keyof T ä¸­ï¼Œå³å¿…é¡»æ˜¯ &#39;id&#39; | &#39;name&#39; | &#39;age&#39; çš„å­é›† Record12345type Record&lt;Key extends string | number | symbol, Value&gt; = &#123; [k in Key]: Value;&#125;;type X4 = Record&lt;string, string&gt;; // &#123; [x: string]: string &#125; ReturnType12345function f(a: number, b: number) &#123; return &#x27;a + b&#x27;&#125;type F = ReturnType&lt;typeof f&gt; // string å…¶ä»–è¿™é‡Œæ¨èä¸€ä¸ªç”¨äºç»ƒä¹  TS ç±»å‹ä½“æ“çš„ repoï¼šTypeScript ç±»å‹ä½“æ“å§¿åŠ¿åˆé›† çœ‹çœ‹åˆ«äººçš„ä½“æ“ï¼š ç”¨ TypeScript ç±»å‹è¿ç®—å®ç°ä¸€ä¸ªä¸­å›½è±¡æ£‹ç¨‹åº TypeScript ç±»å‹ä½“æ“å¤©èŠ±æ¿ï¼Œç”¨ç±»å‹è¿ç®—å†™ä¸€ä¸ª Lisp è§£é‡Šå™¨","tags":["TypeScript","æ³›å‹"],"categories":["å­¦ä¹ ç¬”è®°","TypeScript"]},{"title":"æ³›å‹ç¼–ç¨‹ï¼ˆä¸Šï¼‰","path":"/2023/02/06/typescript/ts-9/","content":"æ³›å‹å°±åƒå‡½æ•°å‡½æ•° 12const f = (a, b) =&gt; a + bconst result = f(1, 2) // 3 æ³›å‹ 12type F&lt;A, B&gt; = A | Btype Result = F&lt;string, number&gt; // string | number æ³›å‹å°±åƒå‡½æ•° å‡½æ•°çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ å‡½æ•°çš„æœ¬è´¨æ˜¯æ¨åæ‰§è¡Œçš„ã€éƒ¨åˆ†å¾…å®šçš„ä»£ç  123456789101112131415// ç«‹å³æ‰§è¡Œconsole.log(1)// æ¨åä¸€æ­¥æ‰§è¡Œconst f1 = () =&gt; console.log(1)f1()// æ¨åä¸¤æ­¥æ‰§è¡Œconst f2 = () =&gt; console.log(1)console.log(2)f2()// éƒ¨åˆ†å¾…å®šçš„const f3 = (fn, n) =&gt; fn(n) // å‚æ•°å¾…å®šf3(console.log, 3) æ³›å‹çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ æ³›å‹çš„æœ¬è´¨æ˜¯æ¨åæ‰§è¡Œçš„ã€éƒ¨åˆ†å¾…å®šçš„ç±»å‹ æ²¡æœ‰æ³›å‹çš„ç±»å‹ç³»ç»Ÿï¼Œå°±å¦‚åŒæ²¡æœ‰å‡½æ•°çš„ç¼–ç¨‹è¯­è¨€ ä»€ä¹ˆæ—¶å€™éœ€è¦æ³›å‹å½“æˆ‘ä»¬éœ€è¦å‡†ç¡®çš„å®šä¹‰è¿”å›å€¼çš„ç±»å‹çš„æ—¶å€™ï¼Œå°±éœ€è¦æ³›å‹ è¿™æ—¶å€™ä½ å¯èƒ½ä¼šè¯´ï¼Œåšç±»å‹æ”¶çª„ä¸å°±è¡Œäº†å—ï¼Ÿå°±åƒä¸‹é¢è¿™æ · 12345678910function echo(whatever: number | string | boolean) &#123; switch (typeof whatever) &#123; case &#x27;number&#x27;: return whatever; case &#x27;string&#x27;: return whatever; case &#x27;boolean&#x27;: return whatever; &#125;&#125; ä½†æ˜¯ä½ ä¼šå‘ç°ï¼Œè¿™æ ·å†™å¾—åˆ°çš„è¿”å›å€¼ç±»å‹æ˜¯ä¸å‡†ç¡®çš„ 123const a = echo(233);// æˆ‘ä»¬æœŸæœ› a çš„ç±»å‹æ˜¯ 233// ä½† a çš„ç±»å‹å´æ˜¯ string | number | boolean è¿™æ—¶å€™ï¼Œæ³›å‹å°±æ´¾ä¸Šç”¨åœºäº† 123456function echo&lt;T&gt;(whatever: T): T &#123; return whatever;&#125;const a = echo(233);// a çš„ç±»å‹ä¸º 233 ç®€å•æ³›å‹ç¤ºä¾‹12345678910type Union&lt;A, B&gt; = A | B;type Union3&lt;A, B, C&gt; = A | B | C;type Intersect&lt;A, B&gt; = A &amp; B;type Intersect3&lt;A, B, C&gt; = A &amp; B &amp; C;interface List&lt;A&gt; &#123; [index: number]: A;&#125;interface Hash&lt;V&gt; &#123; [key: string]: V;&#125; æ¡ä»¶ç±»å‹ï¼ˆConditional Typesï¼‰ T extends string å¯ç†è§£ä¸º T &lt;= stringï¼ˆT åŒ…å«äº stringï¼‰ 123456type R1 = LikeString&lt;&#x27;hi&#x27;&gt; // truetype R2 = LikeString&lt;true&gt; // falsetype S1 = LikeNumber&lt;2333&gt; // 1type S2 = LikeNumber&lt;false&gt; // 2type T1 = LikePerson&lt;&#123; name: &#x27;ClariS&#x27;, age: 18 &#125;&gt; // yestype T2 = LikePerson&lt;&#123; age: 1 &#125;&gt; // no æ³›å‹ä¸­çš„ç‰¹æ®Šè¿ç®—è§„åˆ™ ç°æœ‰å¦‚ä¸‹æ³›å‹ ToArray 1type ToArray&lt;T&gt; = T extends unknown ? T[] : never; é—®ï¼štype Result = ToArray&lt;string | number&gt; çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿ ç›´æ¥è¯´ç­”æ¡ˆï¼šResult ä¸º string[] | number[] ä½ å¯èƒ½ä¼šç–‘æƒ‘ï¼ŒæŒ‰ç…§ä¸€èˆ¬çš„ç†è§£ï¼Œstring | number æ˜¯åŒ…å«äº unknown çš„ï¼Œé‚£ä¹ˆ Result å°±åº”è¯¥æ˜¯ (string | number)[] å‘€ æŒ‰ç…§é€šå¸¸çš„ç†è§£æ˜¯æ²¡é”™ï¼Œä½†å› ä¸ºè¿™æ˜¯åœ¨æ³›å‹ä¸­ï¼Œå› æ­¤è§„åˆ™ä¼šæœ‰äº›è®¸ä¸åŒ å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ‹†åˆ†è¿‡ç¨‹æ¥è¿›è¡Œç†è§£è®°å¿†ï¼š 1234type Result = ToArray&lt;string | number&gt;;// type Result = (string | number) extends unknown ? ...// type Result = (string extends unknown ? ...) | (number extends unknown ? ...)// type Result = string[] | number[] å³æ³›å‹ä¸­çš„è”åˆç±»å‹ä¼šåˆ†å¼€è¿›è¡Œè¿ç®—ï¼Œè¿™å°±å¥½åƒæ˜¯ä¹˜æ³•ä¸­çš„åˆ†é…ç‡ (A + B) X C = A X C + B X C å†é—®ï¼štype Result2 = ToArray&lt;never&gt; çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿ ç­”æ¡ˆæ˜¯ never åŒæ ·æŒ‰ç…§ä¸€èˆ¬çš„ç†è§£ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼ˆéæ³›å‹ä¸­ï¼‰ï¼Œnever æ˜¯åŒ…å«äº unknown çš„ï¼Œé‚£ä¹ˆ Result åº”è¯¥æ˜¯ never[] æ‰å¯¹ ä½† Result åœ¨æ­¤å¤„å´ä¸º never 1type Result = ToArray&lt;never&gt;; // never å³æ³›å‹ä¸­çš„ never è¿›è¡Œä»»ä½•è¿ç®—éƒ½åªä¼šå¾—åˆ° neverï¼Œè¿™å°±å¥½åƒæ˜¯ä¹˜æ³•ä¸­çš„é›¶ 0 X C = 0 æ³¨æ„ï¼šä»¥ä¸Šè®¨è®ºçš„è§„åˆ™åªå¯¹æ³›å‹æœ‰æ•ˆ åœ¨æ³›å‹ä¸­ä½¿ç”¨ keyofkeyof èƒ½è·å–å¯¹è±¡çš„æ‰€æœ‰ keyï¼Œå¹¶å°†è·å–åˆ°çš„ key åšä¸€ä¸ªè”åˆï¼ˆå¹¶é›†ï¼‰ 1234type Person = &#123; name: string; age: number &#125;;type GetKeys&lt;T&gt; = keyof T;type Result = GetKeys&lt;Person&gt;;// ^-- &#x27;name&#x27; | &#x27;age&#x27; å¸¸å’Œæ˜ å°„ç±»å‹ä¸€èµ·ä½¿ç”¨ 123type Readonly&lt;T&gt; = &#123; readonly [K in keyof T]: T[K];&#125;; åœ¨æ³›å‹ä¸­ä½¿ç”¨ extends keyof12345type Person = &#123; name: string; age: number &#125;;type GetKeyType&lt;T, K extends keyof T&gt; = T[K];type Result1 = GetKeyType&lt;Person, &#x27;name&#x27;&gt;; // stringtype Result2 = GetKeyType&lt;Person, &#x27;age&#x27;&gt;; // numbertype Result3 = GetKeyType&lt;Person, &#x27;name&#x27; | &#x27;age&#x27;&gt;; // string | number K extends keyof T çš„å†™æ³•ç§°ä¸ºæ³›å‹çº¦æŸï¼ŒGetKeyType ç¬¬äºŒä¸ªå‚æ•° k çš„ç±»å‹å¿…é¡»åŒ…å«äº string | number","tags":["TypeScript","æ³›å‹"],"categories":["å­¦ä¹ ç¬”è®°","TypeScript"]},{"title":"æ·±å…¥å‡½æ•°ï¼šå‡½æ•°é‡è½½ã€this å’Œ as const","path":"/2023/02/03/typescript/ts-8/","content":"å‡½æ•°é‡è½½ï¼ˆoverloadï¼‰é‡è½½å…è®¸ä¸€ä¸ªå‡½æ•°åœ¨æ¥å—ä¸åŒæ•°é‡æˆ–ç±»å‹çš„å‚æ•°æ—¶ï¼Œä½œå‡ºä¸åŒçš„å¤„ç† 1234567891011121314151617function createDate(n: number): Date;function createDate(year: number, month: number, date: number): Date;// ä¸­é—´ä¸èƒ½å†™å…¶ä»–ä»£ç ï¼Œå‡½æ•°ç±»å‹å£°æ˜åé¢åªèƒ½æ¥å‡½æ•°çš„å®ç°function createDate(a: number, b?: number, c?: number): Date &#123; if (a !== undefined &amp;&amp; b !== undefined &amp;&amp; c !== undefined) &#123; return new Date(a, b, c); &#125; else if (a !== undefined &amp;&amp; b === undefined &amp;&amp; c === undefined) &#123; return new Date(a); &#125; else &#123; throw new Error(&#x27;ä¼ å‚é”™è¯¯&#x27;); &#125;&#125;createDate(1677772800000);createDate(2023, 2, 3); å…³äºå‡½æ•°é‡è½½ï¼š é‡è½½çš„æ€æƒ³æ¥è‡ªäº Java æˆ– C#ï¼Œå› ä¸ºå®ƒä»¬éƒ½ä¸æ”¯æŒè”åˆç±»å‹ é‡è½½æ˜¯ä¸ºäº†ä½¿åŒåå‡½æ•°å¯ä»¥æ¥å—ä¸åŒç±»å‹çš„å‚æ•° ä¸æ˜¯éå¾—ä½¿ç”¨é‡è½½ï¼Œå³ä½¿ä¸ç”¨å‡½æ•°é‡è½½ä¹Ÿå¯ä»¥å®ç°ä¸Šè¿°çš„åŠŸèƒ½123456789function createDateFromNumber(n: number): Date &#123; return new Date(n);&#125;function createDateFromYMD(year: number, month: number, date: number): Date &#123; return new Date(year, month, date);&#125;createDateFromNumber(1677772800000);createDateFromYMD(2023, 2, 3); å¤æ‚åº¦å®ˆæ’ï¼Œä½ ä¸å¯èƒ½æŠŠå¤æ‚åº¦å‡­ç©ºæŠ¹é™¤æ‰ï¼Œå› æ­¤ä½ åªèƒ½é€‰æ‹©æŠŠå¤æ‚åº¦ç•™ç»™è‡ªå·±æˆ–è€…æŠ›ç»™ç”¨æˆ·ã€‚æ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä½¿ç”¨å‡½æ•°é‡è½½å°±æ˜¯æŠŠå¤æ‚åº¦ç•™ç»™è‡ªå·±ï¼›è€Œæä¾›ä¸¤ä¸ªå‡½æ•°ä¾›ç”¨æˆ·é€‰æ‹©å°±æ˜¯æŠŠå¤æ‚åº¦ç•™ç»™ç”¨æˆ·ã€‚ æŒ‡å®š this çš„ç±»å‹1234567891011121314151617181920type Person = &#123; name: string &#125;;function f(this: Person, n: number) &#123; console.log(this.name + n);&#125;// 1. person.f(1)const p: Person &amp; &#123; f: typeof f &#125; = &#123; name: &#x27;ClariS&#x27;, f &#125;;p.f(1);// 2. f.call(person, 1)const p2: Person = &#123; name: &#x27;ClariS&#x27; &#125;;f.call(p2, 1);// 3. f.apply(person, [1])const p3: Person = &#123; name: &#x27;ClariS&#x27; &#125;;f.apply(p3, [1]);// 4. f.bind(person)(1)const p4: Person = &#123; name: &#x27;ClariS&#x27; &#125;;const newF = f.bind(p4);newF(1);// æˆ–newF.bind(null, 1); å‰©ä½™å‚æ•°1234567function sum(name: string, ...array: number[]) &#123; console.log(name); return array.reduce((result, n) =&gt; result + n, 0);&#125;sum(&#x27;one&#x27;, 1);sum(&#x27;two&#x27;, 1, 2);sum(&#x27;three&#x27;, 1, 2, 3); æ³¨æ„ï¼Œå‰©ä½™å‚æ•°åªèƒ½æ˜¯æœ€åä¸€ä¸ªå‚æ•° å±•å¼€å‚æ•°12345678function sum(...array: number[]) &#123; f.apply(null, array); // f(array[0], array[1], array[2], array[3], ...) f(...array);&#125;function f(...array: number[]) &#123; console.log(array);&#125; å¸¸é‡æ–­è¨€ï¼ˆas constï¼‰TS ä¼šåŒºåˆ«å¯¹å¾…å¯ä¿®æ”¹å’Œä¸å¯ä¿®æ”¹çš„å€¼çš„ç±»å‹æ¨æ–­ ä¾‹å¦‚ä¸‹é¢çš„ immutableString ä¼šè¢«æ¨æ–­æˆå•å€¼ç±»å‹ &#39;ClariS&#39; è€Œ mutableString åˆ™ä¼šè¢«æ¨æ–­æˆé€šç”¨çš„ string ç±»å‹ 12const immutableString = &#x27;ClariS&#x27;; // &#x27;ClariS&#x27;let mutableString = &#x27;vivy&#x27;; // string è€Œåœ¨ä¸€èˆ¬çš„å¯¹è±¡ä¸­ï¼Œç”±äºå¯¹è±¡çš„å±æ€§éƒ½å…·æœ‰å¯ä¿®æ”¹æ€§ï¼ŒTS éƒ½ä¼šå¯¹å®ƒä»¬ã€Œä»å®½ã€ç±»å‹æ¨æ–­ï¼Œä¾‹å¦‚ä¸‹é¢çš„ prop çš„ç±»å‹è¢«æ¨æ–­ä¸º string 123const obj = &#123; prop: &#x27;xxx&#x27; // string&#125;; æ ¹æœ¬åŸå› åœ¨äº TS ä¼šæ ¹æ®ä¸€ä¸ªå€¼åœ¨åç»­çš„é€»è¾‘ä¸­æ˜¯å¦å¯èƒ½è¢«ä¿®æ”¹è€Œç»™å‡ºä¸åŒçš„ç±»å‹æ¨æ–­ç»“æœï¼š å¯¹äºæœ‰å¯èƒ½è¢«ä¿®æ”¹çš„å€¼ï¼ŒTS é‡‡ç”¨è¾ƒä¸ºå®½æ¾çš„ç±»å‹æ¨æ–­ç­–ç•¥ï¼Œå³æŠŠä¸Šè¿° mutableStringï¼Œobj.props æ¨æ–­ä¸ºè¾ƒä¸ºå®½æ³›çš„ string ç±»å‹ï¼Œè¿™ä½¿æœªæ¥å¯èƒ½å‡ºç°çš„èµ‹å€¼å…·æœ‰æ›´å¤§çš„çµæ´»åº¦ å¯¹äºä¸å¯èƒ½è¢«é‡æ–°èµ‹å€¼çš„å€¼ï¼ŒTS é‡‡ç”¨è¾ƒä¸ºä¸¥æ ¼çš„ç±»å‹æ¨æ–­ç­–ç•¥ï¼Œå³æŠŠä¸Šè¿° immutableString æ¨æ–­ä¸ºå•å€¼ç±»å‹ &#39;ClariS&#39;ï¼Œè¿™æ ·æœªæ¥æŠŠimmutableString èµ‹å€¼ç»™åˆ«çš„å˜é‡æ—¶ï¼Œå‡ºç°ç±»å‹æ£€æŸ¥é”™è¯¯çš„å¯èƒ½æ€§æ›´å° å…³äºè¿™éƒ¨åˆ†å†…å®¹ï¼Œè¯¦ç»†å¯å‚è€ƒæ–‡ç« TypeScriptå¤œç‚¹å¿ƒï¼šç±»å‹æ¨æ–­çš„ç­–ç•¥ TS å¸¸é‡æ–­è¨€ å¸¸é‡æ–­è¨€å¯ä»¥æŠŠä¸€ä¸ªå€¼æ ‡è®°ä¸ºä¸€ä¸ªä¸å¯ç¯¡æ”¹çš„å¸¸é‡ï¼Œä»è€Œè®© TS ä»¥æœ€ä¸¥æ ¼çš„ç­–ç•¥æ¥è¿›è¡Œç±»å‹æ¨æ–­ è¿˜æ˜¯ä½¿ç”¨ä¸Šè¿°çš„ä¾‹å­ï¼Œç»™ä»–ä»¬åˆ†åˆ«åŠ ä¸Š as const åç±»å‹æ¨æ–­å¦‚ä¸‹ 12345let mutableString = &#x27;vivy&#x27; as const; // &#x27;vivy&#x27;const obj = &#123; prop: &#x27;xxx&#x27; as const // &#x27;xxx&#x27;&#125;; å†çœ‹çœ‹å…¶ä»–çš„ä¾‹å­ 12345const array1 = [1, &#x27;hi&#x27;]; // (string | number)[]array1.push(2); // ä¸æŠ¥é”™const array2 = [1, &#x27;hi&#x27;] as const; // readonly [1, &quot;hi&quot;]array2.push(2); // æŠ¥é”™ ä»ä»¥ä¸Šä¾‹å­ä¸­å¯ä»¥çœ‹å‡ºï¼Œas const ä¼šæŠŠç±»å‹æ¨çª„ï¼Œå¹¶ç»™ç±»å‹åŠ ä¸Š readonly å…³äºè¿™éƒ¨åˆ†å†…å®¹ï¼Œè¯¦ç»†å¯å‚è€ƒæ–‡ç« TypeScript å¤œç‚¹å¿ƒï¼šå¸¸é‡æ–­è¨€ const ä¸ as const çš„åŒºåˆ« as const ä¸­çš„ const ä¸æˆ‘ä»¬å£°æ˜å¸¸é‡æ—¶ä½¿ç”¨çš„ const æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ å…¶å®ä¸¤è€…æ— è®ºæ˜¯è¯­æ³•è¿˜æ˜¯è¯­ä¹‰ï¼Œéƒ½ç›¸å½“ä¸åŒï¼š const å¸¸é‡å£°æ˜æ˜¯ ES6 çš„è¯­æ³•ï¼Œå¯¹ TS è€Œè¨€ï¼Œå®ƒåªèƒ½åæ˜ è¯¥å¸¸é‡æœ¬èº«æ˜¯ä¸å¯è¢«é‡æ–°èµ‹å€¼çš„ï¼Œå®ƒçš„å­å±æ€§ä»ç„¶å¯ä»¥è¢«ä¿®æ”¹ï¼Œæ•… TS åªä¼šå¯¹å®ƒä»¬åšæ¾æ•£çš„ç±»å‹æ¨æ–­ as const æ˜¯ TS çš„è¯­æ³•ï¼Œå®ƒå‘Šè¯‰ TS å®ƒæ‰€æ–­è¨€çš„å€¼ä»¥åŠè¯¥å€¼çš„æ‰€æœ‰å±‚çº§çš„å­å±æ€§éƒ½æ˜¯ä¸å¯ç¯¡æ”¹çš„ï¼Œæ•…å¯¹æ¯ä¸€çº§å­å±æ€§éƒ½ä¼šåšæœ€ä¸¥æ ¼çš„ç±»å‹æ¨æ–­ more about the functionå®Œæ•´ç¤ºä¾‹1234567891011121314type Config = &#123; url: string; method: &#x27;GET&#x27; | &#x27;POST&#x27; | &#x27;PATCH&#x27; | &#x27;DELETE&#x27;; data?: unknown; headers?: unknown;&#125;;function ajax1(&#123; url, method, ...rest &#125;: Config = &#123; method: &#x27;GET&#x27;, url: &#x27;&#x27; &#125;) &#123; console.log(url, method, rest);&#125;function ajax2(&#123; url, method, ...rest &#125; = &#123; method: &#x27;GET&#x27;, url: &#x27;&#x27; &#125; as Config) &#123; console.log(url, method, rest);&#125; ç±»å‹ Config å¯ä»¥å†™åœ¨å·¦è¾¹ï¼Œä¹Ÿå¯ä»¥å†™åœ¨å³è¾¹ void è¿”å›å€¼ç±»å‹123456789101112131415161718function f1(): void &#123; return;&#125;function f2(): void &#123; return undefined;&#125;function f3(): void &#123;&#125;function f4(): void &#123; return null; // æŠ¥é”™ï¼šType &#x27;null&#x27; is not assignable to type &#x27;void&#x27;&#125;type F5 = () =&gt; void;const f5: F5 = () =&gt; &#123; return;&#125;;","tags":["TypeScript","as const","å‡½æ•°é‡è½½"],"categories":["å­¦ä¹ ç¬”è®°","TypeScript"]},{"title":"æ·±å…¥å‡½æ•°ï¼šå£°æ˜ã€å‚æ•°ã€è¿”å›å€¼","path":"/2023/02/01/typescript/ts-7/","content":"æ·±å…¥å¯¹è±¡è¯­æ³•æè¿°å¯¹è±¡çš„å±æ€§ä½¿ç”¨æ¥å£æè¿°å¯¹è±¡ 12345678type Person = &#123; name: string&#125;// æˆ–è€…interface Person &#123; name: string&#125; Person çš„å­é›†ä¸º 12345678910type Children = | &#123; name: string, age: string &#125; | &#123; name: string, age: number &#125; | &#123; name: string, age: boolean &#125; | &#123; name: string, age: null &#125; | &#123; name: string, age: undefined &#125; | &#123; name: string, age: object &#125; | &#123; name: string, gender: string &#125; | &#123; name: string, gender: number &#125;// ä»¥ä¸‹çœç•¥ä¸€ä¸‡è¡Œ ç´¢å¼•ç­¾åï¼ˆIndex Signatureï¼‰12345678type Hash = &#123; [k: string]: unknown length: number&#125;type List = &#123; [k: number]: unknown length: number&#125; æ˜ å°„ç±»å‹ï¼ˆMapped Typeï¼‰123456type Hash = &#123; [k in string]: unknown&#125;type List = &#123; [k in number]: unknown&#125; æ˜ å°„ç±»å‹å¤šç”¨äºæ³›å‹ 123type Readonly&lt;T&gt; = &#123; readonly [K in keyof T]: T[K];&#125;; éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½¿ç”¨äº†æ˜ å°„ç±»å‹ï¼Œå¯¹è±¡ä¸­å°±ä¸èƒ½å†æœ‰å…¶ä»–å±æ€§äº†ï¼Œè¿™ç‚¹ä¸ç´¢å¼•ç­¾åæœ‰æ‰€ä¸åŒ 12345type Hash = &#123; [k in string]: unknown length: number // ^-- A mapped type may not declare properties or methods.&#125; å¯é€‰å±æ€§å¯é€‰å±æ€§çš„å«ä¹‰æ˜¯è¯¥å±æ€§å¯ä»¥ä¸å­˜åœ¨ 12345interface InputProps &#123; defaultValue?: string; value?: boolean; onChange?: () =&gt; void;&#125; value?: boolean å¯è¿‘ä¼¼çš„ç†è§£æˆ value: boolean | undefinedï¼Œä½†æ˜¯åœ¨å£°æ˜å¯¹è±¡å±æ€§æ—¶ï¼Œvalue? å¯ä»¥ä¸å†™ï¼Œè€Œ value å¿…é¡»å†™ åªè¯»å±æ€§æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›å¯¹è±¡ä¸­çš„ä¸€äº›å­—æ®µåªèƒ½åœ¨åˆ›å»ºçš„æ—¶å€™è¢«èµ‹å€¼ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ readonly å®šä¹‰åªè¯»å±æ€§ 1234567891011interface User &#123; readonly id: number; readonly name: string; readonly scores: number[]; age?: number;&#125;const u: User = &#123; id: 1, name: &#x27;ClariS&#x27;, scores: [87, 65],&#125;; ä½¿ç”¨ readonly å®šä¹‰çš„å±æ€§åˆå§‹åŒ–åä¸èƒ½è¢«é‡æ–°èµ‹å€¼ 1234u.id = 2;// ^-- Cannot assign to &#x27;id&#x27; because it is a read-only property.tsu.scores = [100, 65]// ^-- Cannot assign to &#x27;scores&#x27; because it is a read-only property.ts ä½†æ˜¯å¹¶æ²¡æœ‰å¯¹ scores å†…éƒ¨çš„å±æ€§åšåªè¯»çº¦æŸï¼ˆåªè¯»çº¦æŸåªåœ¨ç¬¬ä¸€å±‚ï¼‰ 12u.scores[0] = 100;// ä¸æŠ¥é”™ æ·±å…¥å‡½æ•°è¯­æ³•å¯¹è±¡çš„è¯­æ³•å…¨éƒ½é€‚ç”¨äºå‡½æ•° 1234567type F = &#123; (a: number, b: number): number; readonly count?: number[];&#125;;const fn: F = (x, y) =&gt; x + y;fn.count[0] = 1; å£°æ˜å‡½æ•°çš„å››ç§æ–¹å¼å…ˆå†™ç±»å‹å†èµ‹å€¼12type F1 = (a: number, b: number) =&gt; number;const f1: F1 = (a, b) =&gt; a + b; ç®­å¤´å‡½æ•°1234const f2 = (a: number, b: number): number =&gt; &#123; return a + b;&#125;;type F2 = typeof f2; æ™®é€šå‡½æ•°1234function f3(this: unknown, a: number, b: number): number &#123; return a + b;&#125;type F3 = typeof f3; åŒ¿åæ™®é€šå‡½æ•°1234const f4 = function (this: unknown, a: number, b: number): number &#123; return a + b;&#125;;type F4 = typeof f4; æ„é€ å‡½æ•°12const f5 = new Function(&#x27;a&#x27;, &#x27;b&#x27;, &#x27;return a + b&#x27;);type F5 = typeof f5; å‡ ä¹æ²¡äººä¼šè¿™ä¹ˆå†™å§ ç±»å‹è°“è¯ä¹‹å‰åœ¨è”åˆç±»å‹ä¸­è®²è¿‡ï¼Œå¯ä»¥ä½¿ç”¨ç±»å‹è°“è¯ is æ¥æ”¶çª„ç±»å‹ï¼Œå½“æ—¶åªç®€å•æäº†ä¸€ä¸‹ä¸æ¨èä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œè¿™é‡Œè¯´ä¸€ä¸‹ä¸ºä»€ä¹ˆ 123456789101112type Person = &#123; name: string &#125;type Animal = &#123;&#125;function isPerson(x: Person | Animal): x is Person &#123; return &#x27;name&#x27; in x&#125;function fn(a: Person | Animal) &#123; if (isPerson(a)) &#123; a // Person &#125;&#125; å¯ä»¥ä½¿ç”¨ç®­å¤´å‡½æ•°å®ç° isPerson 1const isPerson = (x: Person | Animal): x is Person =&gt; &#x27;name&#x27; in x ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯ç®­å¤´å‡½æ•°ï¼Œä¸èƒ½å…ˆå†™ç±»å‹å†èµ‹å€¼ 123type A = (x: Person | Animal) =&gt; x is Personconst isPerson: A = x =&gt; &#x27;name&#x27; in x// ^--- Type &#x27;(x: Person | Animal) =&gt; boolean&#x27; is not assignable to type &#x27;A&#x27; åœ¨å³è¾¹åŠ ä¸Š x is Person å°±ä¸æŠ¥é”™äº† 12type A = (x: Person | Animal) =&gt; x is Personconst isPerson: A = (x): x is Person =&gt; &#x27;name&#x27; in x å‚æ•°ç›¸å…³è¯­æ³•å¯é€‰å‚æ•°123456789function addEventListener(eventType: string, fn: unknown, useCapture?: boolean) &#123; if (useCapture === undefined) &#123; useCapture = false &#125; // æµè§ˆå™¨å®ç° console.log(eventType, fn, useCapture)&#125;addEventListener(&#x27;click&#x27;, () =&gt; 1) å‚æ•°é»˜è®¤å€¼123456function addEventListener(eventType: string, fn: unknown, useCapture = false) &#123; // æµè§ˆå™¨å®ç° console.log(eventType, fn, useCapture)&#125;addEventListener(&#x27;click&#x27;, () =&gt; 1) å‚æ•°ä¹Ÿå¯ä»¥æ˜¯å‡½æ•°12345678910111213function addEventListener( eventType: string, fn: (this: HTMLElement, e: Event) =&gt; void, useCapture = false) &#123; // æµè§ˆå™¨å®ç°ï¼Œè¿™é‡Œåªæä¾›ä¼ªä»£ç  const element = &#123;&#125; as HTMLElement; const event = &#123;&#125; as Event; fn.call(element, event); console.log(eventType, fn, useCapture);&#125;addEventListener(&#x27;click&#x27;, () =&gt; 1); è¿”å›å€¼ä¹Ÿå¯ä»¥æ˜¯å‡½æ•°123456const add = (a: number, b: number) =&gt; a + btype CreateAdd = (x: number) =&gt; (y: number) =&gt; numberconst createAdd: CreateAdd = a =&gt; b =&gt; a + badd(6, 14)createAdd(6)(14)","tags":["TypeScript","æ˜ å°„ç±»å‹","ç´¢å¼•ç­¾å"],"categories":["å­¦ä¹ ç¬”è®°","TypeScript"]},{"title":"ç±»å‹å…¼å®¹ä¸èµ‹å€¼","path":"/2023/01/30/typescript/ts-6/","content":"ä¸ºä»€ä¹ˆè¦æœ‰ç±»å‹å…¼å®¹å› ä¸ºå®é™…å·¥ä½œä¸­ï¼Œå¾€å¾€æ— æ³•åšåˆ°ç±»å‹ä¸€è‡´ æ¯”å¦‚åœ¨ä¸Šé¢çš„ JS ä»£ç ä¸­ï¼Œå‡è®¾ runTask å‡½æ•°çš„å‚æ•°åªæ¥å—å…·æœ‰ aã€bã€c è¿™ 3 ä¸ª key çš„å¯¹è±¡ï¼Œä½†åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå³ä½¿æˆ‘ä»¬å¤šä¼ ä¸€ä¸ª dï¼Œä¹Ÿä¸ä¼šæŠ¥é”™ ä½ æœ‰çš„ï¼Œæˆ‘éƒ½æœ‰ï¼Œåˆ™æˆ‘èƒ½ä»£æ›¿ä½ ï¼›y æœ‰çš„ï¼Œx éƒ½æœ‰ï¼Œåˆ™ x å…¼å®¹ y ç®€å•ç±»å‹çš„å…¼å®¹ç±»å‹å°çš„å…¼å®¹ç±»å‹å¤§çš„ æ³¨æ„ï¼šå›¾ä¸­çš„å¤§å°åœ†åº”å½“æ˜¯åŒ…å«å…³ç³»ï¼Œå³å°åœ†åº”è¯¥åœ¨å¤§åœ†å†…éƒ¨ï¼Œæ­¤å¤„ä¸ºäº†å±•ç¤ºæ¸…æ™°å°†å°åœ†æŒªåˆ°äº†å¤–éƒ¨ï¼Œåé¢çš„å›¾ç¤ºäº¦å¦‚æ­¤ é›†åˆ hi å°äºé›†åˆ Aï¼Œå› æ­¤å°† hi èµ‹å€¼ç»™ a ä¸æŠ¥é”™ æ™®é€šå¯¹è±¡çš„å…¼å®¹å±æ€§å¤šçš„å…¼å®¹å±æ€§å°‘çš„ å¯¹è±¡å±æ€§è¶Šå¤šï¼Œé™åˆ¶è¶Šå¤šï¼Œè¡¨ç¤ºçš„é›†åˆèŒƒå›´è¶Šå°ï¼Œæ‰€ä»¥å…¶å®è¿˜æ˜¯ç±»å‹å°çš„å…¼å®¹ç±»å‹å¤§çš„ æ³¨æ„ï¼šå¯¹è±¡å…¼å®¹çš„å‰ææ˜¯å¿…é¡»å¾—å­˜åœ¨å…±åŒçš„å±æ€§ï¼Œæ­¤å¤„ä¸¤ä¸ªå¯¹è±¡å…±åŒçš„å±æ€§æ˜¯ name å’Œ age å…¼å®¹çš„æƒ…å†µä¸‹ï¼Œä½œä¸ºå‚æ•°ä¹Ÿä¸æŠ¥é”™ 123456789type Person = &#123; name: string; age: number &#125;let user = &#123; name: &#x27;ClariS&#x27;, age: 18, id: 1, email: &#x27;xxx@yyy.com&#x27; &#125;let p: Person = user // ä¸æŠ¥é”™const f1 = (p: Person) =&gt; &#123; console.log(p)&#125;f1(user) // ä¸æŠ¥é”™ æ¥å£çš„å…¼å®¹å­æ¥å£å…¼å®¹çˆ¶æ¥å£ å‡½æ•°çš„å…¼å®¹å‡½æ•°çš„å…¼å®¹æ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦è€ƒè™‘å‚æ•°å’Œè¿”å›å€¼ å‚æ•°ä¸ªæ•°ä¸åŒå­˜åœ¨ç›¸åŒç±»å‹çš„å‚æ•°çš„å‡½æ•°ï¼Œå‚æ•°å°‘çš„å…¼å®¹å‚æ•°å¤šçš„ å¦‚ä½•ç†è§£ä¸Šå›¾ä¸­çš„å…¼å®¹å…³ç³»ï¼Ÿï¼ˆå›¾ä¸­ç»¿è‰²ç®­å¤´ä»£è¡¨å¯ä»¥å…¼å®¹ï¼Œçº¢è‰²ç®­å¤´è¡¨ç¤ºä¸èƒ½å…¼å®¹ï¼‰ å¦‚ä½•ç†è§£ä¸Šå›¾ä¸­çš„ä»£ç ï¼Ÿï¼ˆå›¾ä¸­ç»¿è‰²ç®­å¤´ä»£è¡¨å¯ä»¥å…¼å®¹ï¼Œçº¢è‰²ç®­å¤´è¡¨ç¤ºä¸èƒ½å…¼å®¹ï¼‰ä¸»è¦çœ‹åˆ’çº¿çš„å³è¾¹å‚æ•°çš„éƒ¨åˆ†ï¼šä»ä¸Šå¾€ä¸‹çœ‹ï¼Œç®­å¤´å…¨ç»¿ï¼ˆa å’Œ b éƒ½æ˜¯ numberï¼‰ä»ä¸‹å¾€ä¸Šçœ‹ï¼Œå­˜åœ¨çº¢è‰²çš„ç®­å¤´ï¼ˆå‚æ•° s æ²¡æœ‰å¯ä»¥å…¼å®¹çš„å‚æ•°ï¼‰å› æ­¤ æ¥å—ä¸€ä¸ªå‚æ•°çš„å‡½æ•° å…¼å®¹ æ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œåè¿‡æ¥åˆ™ä¸è¡Œ ä¸ºä»€ä¹ˆå®¹å¿å‚æ•°å˜å°‘å‘¢ï¼Ÿä»ä¸‹ä¾‹ä¸­å¯ä»¥çª¥æ¢ä¸€äºŒ åœ¨ JS ä¸­ï¼Œå°‘å†™å‚æ•°æ˜¯å¾ˆå¸¸è§çš„äº‹æƒ… å‚æ•°ç±»å‹ä¸åŒå¯¹å‚æ•°è¦æ±‚å°‘çš„å…¼å®¹å¯¹å‚æ•°è¦æ±‚å¤šçš„ å’Œå‚æ•°çš„å…¼å®¹å…³ç³»æ­£å¥½ç›¸å ä»å‰é¢çš„ä¾‹å­æˆ‘ä»¬çŸ¥é“ï¼ŒMyMouseEvent æ˜¯å…¼å®¹ MyEvent çš„ï¼Œè¿™é‡Œå‡½æ•°çš„å…¼å®¹å…³ç³»å°±æ­£å¥½åè¿‡æ¥äº†ã€‚ è¿”å›å€¼ä¸åŒä¸è€ƒè™‘å‚æ•°ç±»å‹çš„æƒ…å†µä¸‹ï¼Œå‡½æ•°çš„å…¼å®¹å…³ç³»å’Œè¿”å›å€¼çš„å…¼å®¹å…³ç³»ä¿æŒä¸€è‡´ æ€è€ƒï¼šå¦‚æœå‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼åŒæ—¶å­˜åœ¨ä¸”å…¼å®¹å…³ç³»ç›¸åå‘¢ï¼Ÿ å®é™…å·¥ä½œä¸­çš„å‡½æ•°12345678910111213141516171819202122232425interface Event &#123; timestamp: number;&#125;interface MyMouseEvent extends Event &#123; x: number; y: number;&#125;function listenEvent(eventType: string, handler: (n: Event) =&gt; void) &#123; /* ... */&#125;// æˆ‘ä»¬å¸Œæœ›è¿™æ ·ç”¨ï¼Œä½†ä¼šæŠ¥é”™listenEvent(&quot;click&quot;, (e: MyMouseEvent) =&gt; console.log(e.x + &quot;,&quot; + e.y));// å› æ­¤åªèƒ½è¿™æ ·ç”¨listenEvent(&quot;click&quot;, (e: Event) =&gt; console.log((e as MyMouseEvent).x + &quot;,&quot; + (e as MyMouseEvent).y));// è¿˜å¯ä»¥è¿™ä¹ˆç”¨listenEvent(&quot;click&quot;, ((e: MyMouseEvent) =&gt; console.log(e.x + &quot;,&quot; + e.y)) as ( e: Event) =&gt; void);// è¿™ä¸ªå°±å¤ªç¦»è°±äº†ï¼Œä¹Ÿä¼šæŠ¥é”™listenEvent(&quot;click&quot;, (e: number) =&gt; console.log(e)); åœ¨ä¸å…³é—­ TS ä¸¥æ ¼æ£€æŸ¥çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® &quot;strictFunctionTypes&quot;: false æ¥é¿å…å‡½æ•°æŠ¥é”™ 12345678// tsconfig.json&#123; &quot;compilerOptions&quot;: &#123; &quot;strict&quot;: true, &quot;strictFunctionTypes&quot;: false, ... &#125;&#125; è®¾ç½® strictFunctionTypes: false å ç‰¹æ®Šç±»å‹çš„å…¼å®¹é¡¶ç±»å‹(Top Type) ä¸ åº•ç±»å‹(Bottom Type)","tags":["TypeScript"],"categories":["å­¦ä¹ ç¬”è®°","TypeScript"]},{"title":"TS ä¸­çš„ç±»å‹è¿ç®—ï¼šäº¤å‰ç±»å‹","path":"/2023/01/17/typescript/ts-5/","content":"äº¤å‰ç±»å‹ï¼ˆäº¤é›†ï¼‰è‹±æ–‡å…¨ç§°ï¼šintersection types 12type A = string &amp; number;// ^-- never äº¤å‰ç±»å‹ä¸€èˆ¬å¤šç”¨äºå¯¹è±¡ï¼Œè€Œä¸ç”¨äºç®€å•ç±»å‹ 123456type æœ‰å·¦æ‰‹çš„äºº = &#123; left: string &#125;const b = &#123; left: &#x27;yse&#x27;, right: &#x27;yes&#x27; &#125;const a1: æœ‰å·¦æ‰‹çš„äºº = b // ä¸æŠ¥é”™const a2: æœ‰å·¦æ‰‹çš„äºº = &#123; left: &#x27;yse&#x27;, right: &#x27;yes&#x27; &#125; // æŠ¥é”™ å¯ç”¨äºæ¥å£æ±‚äº¤é›† 1234567interface Colorful &#123; color: string;&#125;interface Circle &#123; radius: number;&#125;type ColorfulCircle = Colorful &amp; Circle; å¯ç”¨äºæ¨¡æ‹Ÿç»§æ‰¿ 1234567891011121314type Person = &#123; name: string; age: number;&#125;;type User = Person &amp; &#123; id: number; email: string;&#125;;const u: User = &#123; id: 1, name: &#x27;ClariS&#x27;, age: 18, email: &#x27;xxx@yyy.com&#x27;&#125;; äº¤å‰ç±»å‹çš„ç‰¹æ®Šæƒ…å†µ123456789101112131415type Person = &#123; name: string; age: number; id: string;&#125;;type User = Person &amp; &#123; id: number; email: string;&#125;;const u: User = &#123; id: 1 as never, // æ­¤å¤„ id çš„ç±»å‹ä¸º never name: &#x27;ClariS&#x27;, age: 18, email: &#x27;xxx@yyy.com&#x27;,&#125;; å½“æŠŠä¸Šé¢ id çš„ç±»å‹ä»ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ç±»å‹ï¼Œå˜ä¸ºæ¯”è¾ƒå°çš„ç±»å‹æ—¶ï¼Œæ•´ä¸ª User çš„ç±»å‹éƒ½ä¸º never 12345678910111213141516171819type Person = &#123; name: string; age: number; id: &#x27;A&#x27;;&#125;;type User = Person &amp; &#123; id: &#x27;B&#x27;; email: string;&#125;;const u: User = &#123; // User = never id: 1, name: &#x27;ClariS&#x27;, age: 18, email: &#x27;xxx@yyy.com&#x27;,&#125;;type A = &#123; kind: &#x27;A&#x27;; name: string &#125;;type B = &#123; kind: &#x27;B&#x27;; age: number &#125; &amp; A;// ^-- never ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå½“å¯¹è±¡å±æ€§å‘ç”Ÿå†²çªæ—¶ï¼Œtype åªä¼šæŠŠç±»å‹å˜ä¸º neverï¼Œä½†ç±»å‹å¹¶ä¸æŠ¥é”™ï¼Œåªåœ¨ä½¿ç”¨æ—¶æŠ¥é”™ï¼›è€Œ interface ä¼šç›´æ¥æŠ¥é”™ 12345678910interface Person &#123; name: string; age: number; id: string;&#125;interface User extends Person &#123; // ^-- Type &#x27;number&#x27; is not assignable to type &#x27;string&#x27; id: number; email: string;&#125; å‡½æ•°çš„äº¤é›†ä¼šå¾—åˆ°ä¸€ä¸ªå‚æ•°çš„å¹¶é›† 123456789101112type A = &#123; method: (a: number) =&gt; void;&#125;;type B = &#123; method: (a: string) =&gt; void;&#125; &amp; A;const b: B = &#123; method(a) &#123; a; // number | string &#125;&#125;; æ€»ç»“ï¼šäº¤å‰ç±»å‹å¸¸ç”¨äºæœ‰äº¤é›†çš„ç±»å‹ Aã€Bï¼Œå¦‚æœ Aã€B æ— äº¤é›†ï¼Œå¯èƒ½å¾—åˆ° neverï¼Œä¹Ÿå¯èƒ½åªæ˜¯å±æ€§ä¸º never","tags":["TypeScript"],"categories":["å­¦ä¹ ç¬”è®°","TypeScript"]},{"title":"TS ä¸­çš„ç±»å‹è¿ç®—ï¼šè”åˆç±»å‹","path":"/2023/01/12/typescript/ts-4/","content":"TS &#x3D; JS + ç±»å‹ç³»ç»Ÿ JS å¯ä»¥å¯¹å€¼è¿›è¡ŒåŠ å‡è¿ç®—ï¼Œå¦‚æœæŠŠ TS çš„ç±»å‹ç³»ç»Ÿå½“ä½œä¸€é—¨è¯­è¨€ï¼ŒTS ä¹ŸåŒæ ·å¯ä»¥å¯¹ç±»å‹è¿›è¡Œå„ç§è¿ç®— è”åˆç±»å‹ï¼ˆå¹¶é›†ï¼‰è‹±æ–‡å…¨ç§°ï¼šunion types type A = &#123; name: string &#125; è¡¨ç¤º name ä¸º string çš„æ‰€æœ‰å¯¹è±¡ä½†ä¸è¦é”™è¯¯åœ°è®¤ä¸ºè¿™äº›å¯¹è±¡åªæœ‰ name è¿™ä¸€ä¸ª keyæ¯”å¦‚å¯¹è±¡ &#123; name: &#39;ClariS&#39;; age: 18 &#125; ä¹Ÿæ˜¯å±äº A ç±»å‹çš„å³ A ç±»å‹çš„å¯¹è±¡å¯ä»¥æœ‰ ageï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰ ageåŒç†ï¼Œtype = &#123; age: number &#125; è¡¨ç¤º age ä¸º number çš„å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡çš„ name å¯ä»¥ä¸ºç©ºï¼Œä¹Ÿå¯ä»¥ä¸ä¸ºç©º å¦‚ä½•ä½¿ç”¨è”åˆç±»å‹ï¼Ÿ12345const f1 = (a: number | string) =&gt; &#123; &#x27;æ—¢ä¸èƒ½æŠŠ a å½“ä½œ number&#x27; &#x27;ä¹Ÿä¸èƒ½æŠŠ a å½“åš string&#x27; &#x27;é‚£ä¹ˆï¼Œæ€ä¹ˆä½¿ç”¨ a å˜é‡å‘¢ï¼Ÿ&#x27;&#125; å¦‚æœä¸æ‹†å¼€ç±»å‹ï¼Œå°±åªèƒ½ä½¿ç”¨ number å’Œ string å…±åŒæ‹¥æœ‰çš„æ–¹æ³•æˆ–å±æ€§ï¼Œæ¯”å¦‚ toString() å› æ­¤è¦ä½¿ç”¨è”åˆç±»å‹ï¼Œå°±å¾—å…ˆåŒºåˆ†ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¿›è¡Œç±»å‹æ”¶çª„(Narrowing) å¦‚ä½•è¿›è¡Œç±»å‹æ”¶çª„ï¼Ÿä½¿ç”¨ typeof123456789const f1 = (a: number | string) =&gt; &#123; if (typeof a === &#x27;number&#x27;) &#123; a.toFixed(2); &#125; else if (typeof a === &#x27;string&#x27;) &#123; parseFloat(a).toFixed(2); &#125; else &#123; throw new Error(&#x27;Never do this&#x27;); &#125;&#125;; typeof çš„å±€é™æ€§ï¼šæ— æ³•åŒºåˆ†æ•°ç»„ã€æ—¥æœŸã€æ™®é€šå¯¹è±¡ä»¥åŠ nullï¼ˆè¿”å›å€¼éƒ½æ˜¯ &quot;object&quot;ï¼‰ ä½¿ç”¨ instanceof123456789const f1 = (a: Array&lt;Date&gt; | Date) =&gt; &#123; if (a instanceof Date) &#123; a.toISOString(); &#125; else if (a instanceof Array) &#123; a[0].toISOString(); &#125; else &#123; throw new Error(&#x27;Never do this&#x27;); &#125;&#125;; instanceof çš„å±€é™æ€§ï¼š ä¸æ”¯æŒåŸºç¡€ç±»å‹ï¼Œstringã€numberã€bigintã€booleanã€symbolã€undefined ä¸æ”¯æŒ TS ç‹¬æœ‰çš„ç±»å‹123456789type Person = &#123; name: string &#125;;const f1 = (a: Person | Person[]) =&gt; &#123; if (a instanceof Person) &#123; // ^--- æŠ¥é”™ï¼štype ä¸èƒ½ç”¨ä½œ value &#125; else &#123; throw new Error(&#x27;Never do this&#x27;); &#125;&#125;; ä½¿ç”¨ in æ“ä½œç¬¦123456789type Person = &#123; name: string &#125;;const f1 = (a: Person | Person[]) =&gt; &#123; if (&#x27;name&#x27; in a) &#123; a; // Person &#125; else &#123; a; // Person[] &#125;&#125;; in æ“ä½œç¬¦çš„å±€é™æ€§ï¼šåªé€‚ç”¨äºéƒ¨åˆ†å¯¹è±¡ æ¯”å¦‚å½“åˆ¤æ–­çš„ä¸¤ä¸ªå¯¹è±¡å­˜åœ¨ç›¸åŒçš„ key ï¼ˆå­˜åœ¨ç›¸åŒ keyï¼Œå…¶ä¸­ä¸€ä¸ªå¯¹è±¡çš„ key å¯èƒ½ä¸å­˜åœ¨ï¼‰ï¼Œæˆ–ä¸ä¸ºé”®å€¼å¯¹å½¢å¼çš„å¯¹è±¡ï¼ˆæ¯”å¦‚æ—¥æœŸã€æ­£åˆ™ã€å‡½æ•°ç­‰ï¼‰æ—¶ï¼Œåˆ™æ— æ³•ä½¿ç”¨ in æ“ä½œç¬¦æ¥æ”¶çª„ç±»å‹ ä½¿ç”¨ JS ä¸­åˆ¤æ–­ç±»å‹çš„å‡½æ•°123456789const f1 = (a: string | string[]) =&gt; &#123; if (Array.isArray(a)) &#123; a.join(&#x27; &#x27;).toString(); &#125; else if (typeof a === &#x27;string&#x27;) &#123; parseFloat(a).toFixed(2); &#125; else &#123; throw new Error(&#x27;Never do this&#x27;); &#125;&#125;; ä½¿ç”¨é€»è¾‘12345678910111213141516171819202122const f1 = (a?: string[]) =&gt; &#123; if (a) &#123; a; // string[] &#125; else &#123; a; // undefined &#125;&#125;;const f2 = (a: string | number) =&gt; &#123; a = 1; a; // number&#125;;const f3 = (x: string | number, y: string | boolean) =&gt; &#123; if (x === y) &#123; x; // string y; // string &#125; else &#123; x; // string | number y; // string | number &#125;&#125;; ä½¿ç”¨ç±»å‹è°“è¯ isä¸Šè¿°æ‰€æœ‰çš„ç±»å‹æ”¶çª„æ–¹æ³•éƒ½æ˜¯é€šè¿‡ JavaScript æ¥å®ç°çš„ï¼Œæœ‰æ²¡æœ‰åŒºåˆ†ç±»å‹çš„ä¸‡å…¨ä¹‹æ³•ï¼Ÿ 12345678910111213141516type Rect = &#123; height: number; width: number &#125;;type Circle = &#123; center: [number, number]; radius: number &#125;;// æ¨èä½¿ç”¨æ™®é€šå‡½æ•°å®ç° isRectï¼Œè€Œä¸ä½¿ç”¨ç®­å¤´å‡½æ•°function isRect(x: Rect | Circle): x is Rect &#123; return &#x27;height&#x27; in x &amp;&amp; &#x27;width&#x27; in x;&#125;const f1 = (a: Rect | Circle) =&gt; &#123; if (isRect(a)) &#123; // `isRect(a)` åˆ¤æ–­ a æ˜¯ä¸æ˜¯ Rect a; // Rect &#125; else &#123; a; // Circle &#125;&#125;; ä¼˜ç‚¹ï¼šæ”¯æŒæ‰€æœ‰ TS ç±»å‹ç¼ºç‚¹ï¼šéœ€è¦è‡ªå·±å®ç°ï¼ŒæŒºéº»çƒ¦çš„ æœ‰æ²¡æœ‰æ›´ç®€å•çš„åŠæ³•ï¼Ÿ å¯è¾¨åˆ«è”åˆ12345678910111213interface Circle &#123; kind: &quot;circle&quot;; radius: number; &#125;interface Square &#123; kind: &quot;square&quot;; sideLength: number; &#125;type Shape = Circle | Squareconst f1 = (shape: Shape) =&gt; &#123; if (shape.kind === &#x27;circle&#x27;) &#123; shape // Circle &#125; else if (shape.kind === &#x27;square&#x27;) &#123; shape // Square &#125; else &#123; shape // never &#125;&#125; è®©å¤æ‚ç±»å‹çš„æ”¶çª„å˜æˆç®€å•ç±»å‹çš„å¯¹æ¯” å¯¹äºç±»å‹ T = A | B | C | D | ...ï¼Œæœ‰ä»¥ä¸‹è¦æ±‚ï¼š Aã€Bã€Cã€D... æœ‰ç›¸åŒå±æ€§ kind æˆ–å…¶ä»– kind çš„ç±»å‹æ˜¯ç®€å•ç±»å‹ å„ç±»å‹ä¸­çš„ kind å¯åŒºåˆ† åˆ™ç§° T ä¸ºå¯è¾¨åˆ«è”åˆ ä¸€å¥è¯æ€»ç»“ï¼šå…·æœ‰åŒåã€å¯è¾¨åˆ«çš„ç®€å•ç±»å‹çš„ key çš„è”åˆç±»å‹ï¼Œç§°ä¸ºå¯è¾¨åˆ«è”åˆ ä½¿ç”¨æ–­è¨€å¯ä»¥ä½¿ç”¨ as è¿›è¡Œå¼ºåˆ¶çš„ç±»å‹æ”¶ç¼© 1234567interface Circle &#123; kind: &quot;circle&quot;; radius: number; &#125;interface Square &#123; kind: &quot;square&quot;; sideLength: number; &#125;type Shape = Circle | Squareconst f1 = (shape: Shape) =&gt; &#123; (shape as Circle).radius = 4&#125; any ç­‰äºæ‰€æœ‰ç±»å‹çš„è”åˆå—ï¼Ÿè¿™é‡Œç›´æ¥ç»™å‡ºç»“è®ºï¼šany ä¸ç­‰äºæ‰€æœ‰ç±»å‹çš„è”åˆ æ³¨æ„ï¼šè¿™é‡Œçš„æ‰€æœ‰ç±»å‹ä¸åŒ…æ‹¬ never unknown any void ç”¨åè¯æ³•å¯ä»¥è¯æ˜ï¼š åªè¦ç±»å‹å‘ç”Ÿäº†è”åˆï¼Œå°±åªèƒ½ä½¿ç”¨å®ƒä»¬å…±åŒæ‹¥æœ‰çš„å±æ€§æˆ–æ–¹æ³•ï¼ˆæƒ³è¦ä½¿ç”¨å„è‡ªçš„æ–¹æ³•å°±å¿…é¡»åšç±»å‹æ”¶çª„ï¼‰ ä½†æ˜¯ä½¿ç”¨ any ä¹‹åï¼Œä¸åšç±»å‹æ”¶çª„å¯ä»¥ä½¿ç”¨æ‰€æœ‰ç±»å‹çš„æ–¹æ³• è¯´æ˜ any ä¸æ˜¯æ‰€æœ‰ç±»å‹çš„è”åˆ 1234567891011const f1 = (a: string | number) =&gt; &#123; a.toString(); a.toFixed(); // æŠ¥é”™ a.split(); // æŠ¥é”™&#125;;const f2 = (a: any) =&gt; &#123; a.toString(); a.toFixed(); a.split();&#125;; ä¸” ts çš„ç»å¤§éƒ¨åˆ†è§„åˆ™å¯¹ any ä¸ç”Ÿæ•ˆï¼Œä½†æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œany æ— æ³•èµ‹å€¼ç»™ never é‚£ä»€ä¹ˆç­‰äºæ‰€æœ‰ç±»å‹çš„è”åˆå‘¢ï¼Ÿ 1234567891011121314151617const f1 = (a: unknown) =&gt; &#123; if (a instanceof Date) &#123; a; // Date &#125;&#125;;type Rect = &#123; height: number; width: number &#125;;type Circle = &#123; center: [number, number]; radius: number &#125;;function isRect(x: Rect | Circle): x is Rect &#123; return &#x27;height&#x27; in x &amp;&amp; &#x27;width&#x27; in x;&#125;const f2 = (a: unknown) =&gt; &#123; if (isRect(a)) &#123; a; // Rect &#125;&#125;; å¯ä»¥çœ‹å‡ºï¼Œunknown æ˜¯å¯ä»¥æ”¶çª„åˆ°ä»»ä½•ç±»å‹çš„ï¼Œå› æ­¤ï¼Œunknown å°±æ˜¯æ‰€æœ‰ç±»å‹çš„è”åˆ","tags":["TypeScript"],"categories":["å­¦ä¹ ç¬”è®°","TypeScript"]},{"title":"TypeScript ä¸­çš„ç±»å‹ï¼ˆä¸‹ï¼‰","path":"/2022/12/29/typescript/ts-3/","content":"ä½•æ—¶ä½¿ç”¨ enum å®ä¾‹ä¸€ï¼šç”¨ A.todo å°†æ•°å­—æ˜ å°„æˆä¸€ä¸ªæœ‰æ„ä¹‰çš„è¯­æ³• å®ä¾‹äºŒï¼šå¯ä»¥ç”¨äºè¡¨ç¤ºæƒé™ ä»¥ä¸Šä»£ç ä¸­ï¼ŒManage = Read | Write | Delete æ˜¯ JS ä¸­çš„äºŒè¿›åˆ¶æ“ä½œï¼ˆäºŒè¿›åˆ¶æˆ–è¿ç®—ç¬¦ï¼‰ï¼Œ0b åœ¨ JS ä¸­è¡¨ç¤ºäºŒè¿›åˆ¶ ä½•æ—¶ç”¨ enum ä¼šæ˜¾å¾—å¾ˆå‘†ï¼Ÿ å¦‚ä¸Šæ‰€ç¤ºï¼Œå°† &#39;apple&#39; æ˜ å°„ä¸º Fruit.apple å®Œå…¨æ˜¯å¤šæ­¤ä¸€ä¸¾ï¼Œè¿˜æ˜¯åˆ«å†ç”¨ enum æ¥æ˜ å°„å­—ç¬¦ä¸²äº†å§ãƒ¾(-_-;) åªæ¨èç”¨ enum å¯¹æ•°å­—åšæ˜ å°„ï¼Œé™¤æ­¤ä¹‹å¤–éƒ½ä¸æ¨èä½¿ç”¨ enum ä½•æ—¶ä½¿ç”¨ typeTS ä¸­çš„ Type å«ä½œç±»å‹åˆ«åï¼ŒType Aliasesï¼Œå…¶å®å°±æ˜¯ç»™å…¶ä»–ç±»å‹å–ä¸ªåå­—ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š 1234567891011type Name = string;type FalseLike = &#x27;&#x27; | 0 | false | null | undefined;type Point = &#123; x: number; y: number &#125;;type Points = Point[];type Line = [Point, Point];type Circle = &#123; center: Point; radius: number &#125;;type Fn = (a: number, b: number) =&gt; number;type FnWithProps = &#123; (a: number, b: number): number; prop1: number;&#125;; å¦‚ä½•ä½“ç°å‡º type åªæ˜¯ä¸€ä¸ªåˆ«åï¼Ÿ 12type X = &#123; x: number &#125;type A = X ä»¥ä¸Š TS ä»£ç ä¸­ A çš„ç±»å‹æ˜¯ï¼Ÿç”±äº type åªæ˜¯ä¸€ä¸ªåˆ«åï¼Œå¹¶ä¸æ˜¯å£°æ˜äº†ä¸€ä¸ªçœŸæ­£çš„ç±»å‹ï¼Œæ­¤å¤„ A çš„ç±»å‹ä¸º { x: number } å¦‚ä½•ç†è§£ type FalseLike = &#39;&#39; | 0 | false | null | undefinedï¼Ÿ ä¸Šé¢çš„äº”ä¸ªå€¼å…¶å®éƒ½æ˜¯ç±»å‹ï¼Œç±»å‹å¯ä»¥ç†è§£ä¸ºé›†åˆï¼Œå› æ­¤å¯ä»¥çœ‹ä½œäº”ä¸ªé›†åˆå¹¶åœ¨ä¸€èµ·ï¼Œæ¯ä¸ªé›†åˆä¸­åªåŒ…å«ä¸€ä¸ªå€¼ï¼›å¦å¤–ï¼Œä¸æ”¯æŒ NaN ä½œä¸ºç±»å‹ï¼Œå› ä¸º NaN è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªå€¼è€Œä¸æ˜¯ç±»å‹ å¸¦æœ‰å±æ€§çš„å‡½æ•°çš„å£°æ˜æ–¹å¼ 12345678type FnWithProps = &#123; (a: number, b: number): number; props: string;&#125;;const fn: FnWithProps = (x, y) =&gt; x * y;fn.props = &#x27;hello&#x27;; å¤šç”¨äº React ä¸­ ä½•æ—¶ä½¿ç”¨ interfaceå£°æ˜æ¥å£ï¼Œç”¨äºæè¿°å¯¹è±¡çš„å±æ€§ declare the shapes of objects 12345interface Data &#123; [k: string]: string; &#125;interface Point &#123; x: number; y: number; &#125;interface Points extends Array&lt;Point&gt; &#123;&#125;interface Fn &#123; (x: number, y: number): number; &#125;interface Date2 extends Date &#123;&#125; type å¦‚ä½•å®ç°ç»§æ‰¿ï¼Ÿ 123456interface X &#123; age: number; &#125;type Al = Array&lt;string&gt; &amp; &#123; name: string; &#125; &amp; X;// A1å‡ ä¹ç­‰ä»·äºA2interface A2 extends Array&lt;string&gt;, X &#123; name: string; &#125; type å’Œ interface çš„åŒºåˆ«åŒºåˆ«ä¸€interface åªèƒ½æè¿°å¯¹è±¡ï¼Œè€Œ type èƒ½æè¿°æ‰€æœ‰æ•°æ®ç±»å‹ åŒºåˆ«äºŒtype å¹¶ä¸ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å‹ï¼Œåªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªç±»å‹åˆ«åï¼›è€Œ interface åˆ™æ˜¯ç±»å‹å£°æ˜ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å‹ 12345type A = string;type B = A; // B çš„ç±»å‹æ˜¯ stringinterface D extends Date &#123;&#125;type E = D; // E çš„ç±»å‹æ˜¯ D åŒºåˆ«ä¸‰type ä¸å¯é‡æ–°èµ‹å€¼ï¼Œå› æ­¤ä¸èƒ½å­˜åœ¨åŒåçš„ typeï¼›è€Œ interface å¯ä»¥å£°æ˜åŒåçš„ç±»å‹ï¼ŒåŒåçš„ interface ä¼šè‡ªåŠ¨åˆå¹¶ 123456type A = string; // æŠ¥é”™ Duplicate identifier &#x27;A&#x27;type A = number; // æŠ¥é”™ Duplicate identifier &#x27;A&#x27;interface X &#123; name: string; &#125;interface X &#123; age: number; &#125;const x: X = &#123; name: &#x27;ClariS&#x27;, age: 18 &#125;; // X ä¸º &#123; name: string; age: number; &#125; ä½¿ç”¨ type æ— æ³•è¿›è¡Œç±»å‹æ‰©å±•ï¼Œå› æ­¤ å¯¹å¤– API å°½é‡ç”¨ interfaceï¼Œæ–¹ä¾¿ç”¨æˆ·è¿›è¡Œç±»å‹æ‰©å±•ï¼›å¯¹å†… API å°½é‡ç”¨ typeï¼Œé˜²æ­¢ä»£ç åˆ†æ•£ æ‰©å±• interface çš„å®ä¾‹ï¼š æ‰©å±• axios 1234567import &#123; AxiosRequestConfig &#125; from &#x27;axios&#x27;;declare module &#x27;axios&#x27; &#123; export interface AxiosRequestConfig &#123; _autoLoading?: boolean; _mock?: string; &#125;&#125; æ‰©å±• string 12345declare global &#123; interface String &#123; padZero(length: number): string; &#125;&#125; void12345678910111213141516171819type Fn = () =&gt; void;const fn: Fn = () =&gt; &#123; return &#x27;xxx&#x27;; // ä¸æŠ¥é”™&#125;;const x = fn();console.log(x.toString()); // æŠ¥é”™ï¼šProperty &#x27;toString&#x27; does not exist on type &#x27;void&#x27;.console.log((x as any).toString()); // ä¸æŠ¥é”™function fn1(a: number): void &#123; return &#x27;xxx&#x27;; // æŠ¥é”™ï¼šType &#x27;string&#x27; is not assignable to type &#x27;void&#x27;.&#125;const fn2 = (a: number): void =&gt; &#123; return &#x27;xxx&#x27;; // æŠ¥é”™ï¼šType &#x27;string&#x27; is not assignable to type &#x27;void&#x27;.&#125;;","tags":["TypeScript","enum"],"categories":["å­¦ä¹ ç¬”è®°","TypeScript"]},{"title":"TypeScript ä¸­çš„ç±»å‹ï¼ˆä¸Šï¼‰","path":"/2022/12/28/typescript/ts-2/","content":"JS&#x2F;TS ä¸­æœ‰å“ªäº›æ•°æ®ç±»å‹ ç”¨é›†åˆæ¥ç†è§£ TS æ•°æ®ç±»å‹ number å¯çœ‹åš 1ã€1.1ã€2ã€2.3 ç­‰æ‰€æœ‰æ•°å­—å€¼ç»„æˆçš„é›†åˆstring å¯çœ‹åš aã€bã€abã€cã€abc ç­‰æ‰€æœ‰å­—ç¬¦ä¸²å€¼ç»„æˆçš„é›†åˆboolean å¯çœ‹åš true å’Œ false è¿™ä¸¤ä¸ªå€¼ç»„æˆçš„é›†åˆ JS ä¸­çš„ Numberã€Stringã€Boolean åªç”¨äºåŒ…è£…å¯¹è±¡ï¼Œä¸€èˆ¬ä¸ä¼šç”¨åˆ°å®ƒä»¬ï¼›åŒæ ·åœ°åœ¨ TS ä¸­ä¹Ÿä¸ä¼šç”¨åˆ°å®ƒä»¬ã€‚ TS ä¸­ä¸€èˆ¬ä¸ä¼šç”¨ Object æ¥æè¿°å¯¹è±¡çš„ç±»å‹ï¼Œå› ä¸º Object æ‰€è¡¨ç¤ºçš„ç±»å‹èŒƒå›´å¤ªå¤§äº† å¦‚ä½•ç”¨ TS æ¥æè¿°å¯¹è±¡ ç”¨ class&#x2F;constructor æè¿° ç”¨ type&#x2F;interface æè¿° æè¿°æ™®é€šå¯¹è±¡ç”±äº object&#x2F;Object å¤ªä¸ç²¾ç¡®ï¼Œæ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨ç´¢å¼•ç­¾åæˆ–Record æ³›å‹æ¥æè¿°æ™®é€šå¯¹è±¡ ä½¿ç”¨ç´¢å¼•ç­¾å æ€è€ƒé¢˜ï¼škey çš„ç±»å‹å¯ä»¥ä¸æ˜¯ string å—ï¼Ÿç»æµ‹è¯•ï¼Œk çš„ç±»å‹åªèƒ½ä¸º numberã€stringã€symbol è¿™ä¸‰ç§ ä½¿ç”¨ Record ä½¿ç”¨å…·ä½“çš„å­—æ®µ1234type A = &#123; name: string; age: number;&#125;; æè¿°æ•°ç»„å¯¹è±¡ç”±äº Array å¤ªä¸ç²¾ç¡®ï¼Œæ‰€ä»¥ä¸€èˆ¬ç”¨ Array&lt;?&gt; æˆ– string[] æˆ– [string, number] æ¥æè¿°æ•°ç»„ æ€è€ƒé¢˜ 12type A = [1, 2, 3]const a: A = ?????? ä»¥ä¸Š TS ä»£ç ä¸­ a çš„å€¼æ˜¯ï¼Ÿå½“äºåªæœ‰ä¸€ä¸ªå…ƒç´ çš„é›†åˆï¼Œå› æ­¤ a çš„å€¼åªèƒ½æ˜¯ [1, 2, 3] æè¿°å‡½æ•°å¯¹è±¡ç”±äº Function å¤ªä¸ç²¾ç¡®ï¼Œæ‰€ä»¥ä¸€èˆ¬ç”¨ () =&gt; ? æ¥æè¿°å‡½æ•° 1234567891011121314type FnA = (a: number, b: number) =&gt; number;type FnReturnVoid = (s: string) =&gt; void;type FnReturnUndefined = (s: string) =&gt; undefined;const v: FnReturnVoid = (s: string) =&gt; &#123; console.log(s);&#125;;const u: FnReturnUndefined = (s: string) =&gt; &#123; console.log(s); return undefined;&#125;; å¸¦æœ‰ this çš„å‡½æ•°å£°æ˜ 123456789101112type Person = &#123;name: string, age: number, sayHi: FnWithThis&#125;type FnWithThis = (this: Person, name: string) =&gt; voidconst sayHi: FnWithThis = function(name) &#123; // æ­¤å¤„ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œå› ä¸ºç®­å¤´å‡½æ•°å†…ä¸å­˜åœ¨ this console.log(&quot;hi&quot;, this.name)&#125;const x: Person = &#123;name: &quot;vivy&quot;, age: 18, sayHi&#125;// å¦‚æœå‡½æ•°å£°æ˜ä¸­æœ‰ thisï¼Œé‚£ä¹ˆè°ƒç”¨å‡½æ•°æ—¶å¿…é¡»æ˜¾ç¤ºåœ°ä¼ é€’è¿™ä¸ª thisx.sayHi(&quot;Citrus&quot;)sayHi.call(x, &quot;Citrus&quot;) æè¿°å…¶ä»–å¯¹è±¡ç›´æ¥ç”¨ classï¼ˆæ„é€ å‡½æ•°ï¼‰ æè¿°å³å¯ 12345678910111213const d: Date = new Date();const r: RegExp = /ab+c/;const m: Map&lt;string, number&gt; = new Map();m.set(&#x27;xxx&#x27;, 1);const wm: WeakMap&lt;&#123; name: string &#125;, number&gt; = new WeakMap();const s: Set&lt;&#123; name: string &#125;&gt; = new Set();s.add(&#123; name: &#x27;ClariS&#x27; &#125;);const ws: WeakSet&lt;string[]&gt; = new WeakSet(); anyã€unknownã€never æ˜¯ä»€ä¹ˆä»é›†åˆçš„è§’åº¦ç†è§£ï¼šany æ˜¯å…¨é›†ï¼Œnever æ˜¯ç©ºé›†ï¼Œunknown æ˜¯æœªçŸ¥é›† TS çš„ç»å¤§éƒ¨åˆ†è§„åˆ™å¯¹ any ç±»å‹ä¸ç”Ÿæ•ˆï¼ˆTS ä¸æŠ¥é”™ï¼‰ å¯å¯¹ unknown è¿›è¡Œæ–­è¨€ï¼Œé€‚ç”¨äºå€¼æ˜¯ä»å¤–éƒ¨è·å–çš„ï¼Œæ²¡åŠæ³•æå‰çŸ¥é“ç±»å‹çš„æƒ…å†µï¼›æ¯”å¦‚å½“ä½¿ç”¨ ajax è·å–æ•°æ®æ—¶ï¼Œåå°è¿”å›çš„æ•°æ®æ ¼å¼ä¸ç¡®å®šï¼Œæ­¤æ—¶å¯å°†æ¥å£å“åº”çš„æ•°æ®ç±»å‹å¯å®šä¹‰ä¸º unknownï¼Œç„¶åå†å¯¹å…¶è¿›è¡Œæ–­è¨€ 12const a: unknown = await ajax.get(&#x27;/api/users&#x27;)const b = a as number never ä¸€èˆ¬ä¸ä¼šç”¨æ¥å£°æ˜ç±»å‹ï¼Œè€Œæ˜¯ç”¨æ¥è¿›è¡Œç±»å‹æ¨æ–­çš„ 12345678910111213type A = string | number | boolean;const a: A = &#x27;hello&#x27; as any;if (typeof a === &#x27;string&#x27;) &#123; a.split(&#x27;&#x27;);&#125; else if (typeof a === &#x27;number&#x27;) &#123; a.toFixed(2);&#125; else if (typeof a === &#x27;boolean&#x27;) &#123; a.valueOf();&#125; else &#123; a.toString(); // æŠ¥é”™ï¼šProperty &#x27;toString&#x27; does not exist on type &#x27;never&#x27;&#125; JS ç±»å‹ä¸ TS ç±»å‹çš„åŒºåˆ«æˆ‘æ˜¯è¿™ä¹ˆç†è§£çš„ï¼š JS è¿™é—¨è¯­è¨€å…¶å®å¹¶æ²¡æœ‰æä¾›ç±»å‹ç›¸å…³çš„å…³é”®å­—ï¼ˆå¦‚å°å†™çš„ numberã€stringã€booleanï¼‰ï¼Œåªæ˜¯æä¾›äº†typeofè®©æˆ‘ä»¬è·å–å˜é‡çš„ç±»å‹ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸º JS å¯¹ç±»å‹éå¸¸ä¸é‡è§†ã€‚ è€Œ TS åˆ™å°† JS ä¸­çš„ç±»å‹æå‡åˆ°å¾ˆé«˜çš„ä½ç½®ï¼Œé«˜åˆ°å¦‚æœä½ æŠŠç±»å‹å†™é”™äº†ä»£ç å°±ä¸èƒ½é€šè¿‡ç¼–è¯‘ã€‚å› æ­¤è¿™ä¸¤é—¨è¯­è¨€ä¸­çš„ç±»å‹å…¶å®æ²¡æœ‰å¯æ¯”æ€§ï¼Œåªæ˜¯çœ‹èµ·æ¥æœ‰é‡å éƒ¨åˆ†è€Œå·²ã€‚å¦‚æœä¸€å®šè¦æ¯”è¾ƒï¼Œæˆ‘ä¼šè¿™ä¹ˆè¯´ï¼š ç²’åº¦ä¸åŒï¼šåœ¨ JS ä¸­çš„ç±»å‹ number ä¸å¯å†ç»†åˆ†ï¼Œè€Œ TS ä¸­çš„ number å¯ä»¥çœ‹åš 1ã€1.1ã€2ã€2.3 ç­‰æ— æ•°ä¸ªå°ç±»å‹çš„è”åˆ å¯å˜æ€§ä¸åŒï¼šJS ä¸­çš„å˜é‡ç±»å‹æ˜¯å¯å˜çš„ï¼Œä¸€ä¸ª number éšæ—¶å¯ä»¥å˜æˆä¸€ä¸ª stringï¼›TS ä¸­é™¤äº† anyï¼Œå…¶ä»–ç±»å‹è¦ä¹ˆæ˜¯ä¸å¯å˜çš„ï¼Œè¦ä¹ˆå°±ç®—å¯å˜ä¹Ÿæ˜¯æœ‰é™åˆ¶çš„","tags":["TypeScript"],"categories":["å­¦ä¹ ç¬”è®°","TypeScript"]},{"title":"TypeScript çš„è¿è¡Œä¸è°ƒè¯•","path":"/2022/09/07/typescript/ts-1/","content":"å¦‚ä½•æ“¦é™¤ç±»å‹ å¦‚ä½•è¿è¡Œ TypeScriptåœ¨çº¿ç¼–è¾‘ TypeScript Playgroundï¼ˆç¼ºç‚¹æ˜¯ URL å¤ªé•¿ï¼‰ playcode stackblitz codesandbox æœ¬åœ°ç¼–è¾‘ + æµè§ˆå™¨ä½¿ç”¨ vite å’Œ chrome æœ¬åœ°ç¼–è¾‘ + Node ts-node swc-node @esbuild-kit&#x2F;esm-loader esno å¦‚ä½•è°ƒè¯• TypeScripté¼ æ ‡æ‚¬æµ®ä¸Šå»çœ‹æŠ¥é”™æç¤ºå³å¯ å­¦ä¹ èµ„æ–™æ¨è ç¼–ç¨‹ä¸ç±»å‹ç³»ç»Ÿ TypeScript ç¼–ç¨‹ ç±»å‹å’Œç¨‹åºè®¾è®¡è¯­è¨€","tags":["TypeScript"],"categories":["å­¦ä¹ ç¬”è®°","TypeScript"]},{"title":"DNS ä¸ TCP","path":"/2021/08/20/dns-and-tcp/","content":"ä¸€å›¾æ¦‚è§ˆimage.png DNS &amp; hostsDNSï¼Œå…¨ç§°ï¼šDomainÂ NameÂ Systemï¼Œä¸­æ–‡ï¼šåŸŸåç³»ç»Ÿ åŸŸåç³»ç»Ÿæœ¬èº«çš„åŸç†æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œä½†åŸŸåç³»ç»Ÿçš„åŠŸèƒ½å¾ˆç®€å•ï¼Œå°±æ˜¯è¾“å…¥ä¸€ä¸ªåŸŸåï¼Œè¾“å‡ºä¸€ä¸ª IPï¼Œè¿™é‡Œæˆ‘ä»¬åªå¯¹ DNS åšç®€å•è®¨è®º ä¸¾ä¾‹è¯´æ˜ï¼š åœ¨æµè§ˆå™¨è¾“å…¥ baidu.com è¿™ä¸ªåœ°å€ æµè§ˆå™¨éœ€è¦çŸ¥é“ä½ è®¿é—®çš„è¿™ä¸ªåœ°å€å¯¹åº”çš„ IP æ˜¯å¤šå°‘ï¼Œäºæ˜¯æµè§ˆå™¨å°±ä¼šå»é—®æ“ä½œç³»ç»Ÿ å¦‚æœæ“ä½œç³»ç»Ÿä¹Ÿä¸çŸ¥é“ï¼Œå°±ä¼šå»é—®ç”µä¿¡ã€ç§»åŠ¨ã€è”é€šè¿™æ ·çš„ç½‘ç»œè¿è¡Œå•†ï¼ˆä»¥ä¸‹ç®€ç§° ISPï¼‰ å½“ä½ ä»˜è´¹ä¹‹åï¼Œç½‘ç»œè¿è¥å•†å°±ä¼šå‘Šè¯‰ä½  baidu.com è¿™ä¸ªåœ°å€å¯¹åº”çš„ IP æ˜¯å¤šå°‘ï¼ˆå‡è®¾è¿™é‡Œ baidu.com å¯¹åº”çš„ IP æ˜¯ 1.2.3.4ï¼‰ï¼Œç„¶åå°† IP è¿”å›ç»™ä½  æµè§ˆå™¨è·å–åˆ° baidu.com å¯¹åº”çš„ IP ä¹‹åï¼Œå°±ä¼šä¸ 1.2.3.4 è¿™ä¸ª IP å»ºç«‹ TCP è¿æ¥ ç»†åŒ–è¿‡ç¨‹ï¼š åœ¨æµè§ˆå™¨è¾“å…¥ baidu.com è¿™ä¸ªåœ°å€çš„æ—¶å€™ï¼Œæµè§ˆå™¨é¦–å…ˆä¼šå»æ£€æŸ¥è‡ªèº«æ˜¯å¦æœ‰ç¼“å­˜ï¼Œå¦‚æœå‘ç°ä¹‹å‰è®¿é—®è¿‡ baidu.com ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°±ä¼šç›´æ¥å°†ä¸Šä¸€æ¬¡çš„ IP è¿›è¡Œè¿”å› å¦‚æœæµè§ˆå™¨æ²¡æœ‰ç¼“å­˜ï¼Œå°±å›å»è¯¢é—®æ“ä½œç³»ç»Ÿï¼Œç„¶åæ“ä½œç³»ç»Ÿé¦–å…ˆä¹Ÿæ˜¯ä¼šæ£€æŸ¥è‡ªèº«æ˜¯å¦æœ‰ç¼“å­˜ï¼Œå¦‚æœæ²¡æœ‰å°±ä¼šå»è¯¢é—® ISPï¼ˆç½‘ç»œè¿è¡Œå•†ï¼‰ å¹³æ—¶æˆ‘ä»¬ä¿®æ”¹ hosts è¿™ä¸ªæ–‡ä»¶ï¼Œå…¶å®å°±æ˜¯åœ¨æ‰‹åŠ¨ç»™æ“ä½œç³»ç»Ÿè®¾ç½®ç¼“å­˜ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨ hosts ä¸­å†™å…¥baidu.com 2.3.4.5ï¼Œä»¥åæ¯æ¬¡è®¿é—® baidu.com è¿™ä¸ªåœ°å€çš„æ—¶å€™å°±ä¸ä¼šå†å»è¯¢é—® ISP äº†ï¼Œç›´æ¥ä¼šé€šè¿‡ hosts ä¸­çš„è®¾ç½®å»è®¿é—® 2.3.4.5 è¿™ä¸ª IP TCP ä¸‰æ¬¡æ¡æ‰‹TCP å…¨ç§°ï¼šTransmission Control Protocolï¼Œå³ä¼ è¾“æ§åˆ¶åè®® image.png å‡è®¾ A æ˜¯æµè§ˆå™¨ï¼ŒB æ˜¯æœåŠ¡å™¨ A é¦–å…ˆä¼šå‘ B å‘é€ä¸€ä¸ªå«åšSYN(x)ï¼ˆå‡è®¾è¿™é‡Œ x &#x3D; 100ï¼‰çš„ä¿¡æ¯ SYN æ˜¯ synchronize(åŒæ­¥) çš„ç¼©å†™ï¼ŒåŒæ­¥ä¸æ˜¯æŒ‡ã€ŒåŒæ­¥å¼‚æ­¥ã€ä¸­çš„åŒæ­¥ï¼Œè€Œæ˜¯ã€ŒåŒæ­¥ä¿¡æ¯ã€ä¸­çš„åŒæ­¥ï¼›è¿™é‡Œçš„ x ä¸€èˆ¬æ˜¯ä¸€ä¸ªæ•°å­—ç¼–å·ï¼Œä¸” x å’Œ y ä¸€èˆ¬éƒ½æ˜¯ä» 0 å¼€å§‹çš„ï¼Œè¿™é‡Œæˆ‘ä»¬å¯¹ x å’Œ y çš„æ„ä¹‰ä¸åšè®¨è®ºï¼Œæœ‰å…´è¶£çš„è¯·è‡ªè¡Œç ”ç©¶ B æ”¶åˆ° A å‘æ¥çš„åŒæ­¥ä¿¡æ¯åï¼Œå°±ä¼šè¿”å›ACK(x+1)ï¼ˆ101ï¼‰ SYN(y)ï¼ˆè¿™é‡Œå‡è®¾ y &#x3D; 200ï¼‰ ACK æ˜¯ acknowledge(çŸ¥é“) çš„ç¼©å†™ ç„¶å A ä¼šå›å¤æ¶ˆæ¯ ACK(y+1)ï¼ˆ201ï¼‰ç»™ B ä»ä»¥ä¸Šè¿‡ç¨‹ä¸­èƒ½å¤Ÿç¡®ä¿ä»¥ä¸‹å‡ ä»¶äº‹ï¼š A å¯ä»¥å‘ B å‘é€ä¿¡æ¯ B èƒ½æ”¶åˆ° A å‘é€çš„ä¿¡æ¯ B ä¹Ÿå¯ä»¥å‘ A å‘é€ä¿¡æ¯ A ä¹Ÿèƒ½æ”¶åˆ° B å‘é€çš„ä¿¡æ¯ ä¸‰æ¬¡æ¡æ‰‹æˆåŠŸåå°±å¼€å§‹å»ºç«‹ TCP è¿æ¥äº†ï¼Œå»ºç«‹è¿æ¥åå°±å¯ä»¥å¼€å§‹ä¼ è¾“å†…å®¹äº†ï¼ˆä¸€èˆ¬æ˜¯ HTTP å†…å®¹ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–å†…å®¹ï¼Œä¸”ä¼ è¾“çš„è¿‡ç¨‹ä¹Ÿå¯ä»¥æ˜¯åŒå‘çš„ï¼Œå¹¶éä¸€å®šæ˜¯å•å‘çš„ï¼‰ï¼ŒHTTP å†…å®¹ä¼ è¾“ç»“æŸåï¼Œå°±ä¼šã€Œå…³é—­ã€ TCP å››æ¬¡æŒ¥æ‰‹image.png ä¸Šè¿°å†…å®¹ä¼ è¾“å®Œæˆåï¼ŒA ä¼šå‘é€ä¸€ä¸ªFIN(x) æ³¨æ„ï¼šä¸ä¸€å®šæ˜¯ A å…ˆå‘é€ FINï¼Œä¹Ÿå¯ä»¥æ˜¯ B å…ˆå‘é€ B å…ˆå›å¤ACK(x+1) æ³¨æ„ï¼šå…³é—­æ—¶çš„ x å’Œ y ä¸€èˆ¬éƒ½ä¸æ˜¯ 0 ç„¶åå†å›å¤FIN(y) æ­¥éª¤ 2 å’Œæ­¥éª¤ 3 ä¸­é—´å¯èƒ½ä¼šå¤¹æ‚ç€å…¶ä»–å†…å®¹ A å›å¤ACK(y+1) æœ€åï¼ŒA å’Œ B å„è‡ªå…³é—­è‡ªå·±çš„ TCP è¿æ¥ ä¸€äº› Q &amp; Aä¸ºä»€ä¹ˆéœ€è¦å…³é—­ TCP è¿æ¥ï¼Ÿå› ä¸ºä¸€ç›´ä¿æŒè¿æ¥ä¼šæµªè´¹å†…å­˜å’Œ CPU TCP å’Œ UDP çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ å…«è‚¡æ–‡ï¼Œé¢è¯•å¿…èƒŒ TCP é¢å‘è¿æ¥æœ‰çŠ¶æ€ï¼ŒUDP æ— çŠ¶æ€ TCP å¯é ï¼ˆä¸ä¸¢å¤±ä¸é‡å¤ï¼‰ï¼ŒUDP ä¸å¯é  TCP ä¼ è¾“æ•ˆç‡è¾ƒä½ï¼ŒUDP è¾ƒé«˜ ä¸ºä»€ä¹ˆ TCP çš„ä¸‰æ¬¡æ¡æ‰‹ä¸èƒ½ç²¾ç®€ä¸ºä¸¤æ¬¡ï¼Ÿä¸ºäº†ç¡®ä¿å®¢æˆ·ç«¯ï¼ˆAç«¯ï¼‰èƒ½æ¥æ”¶åˆ°æœåŠ¡ç«¯ï¼ˆBç«¯ï¼‰çš„æ•°æ®ï¼ˆåªæœ‰ä¸¤æ¬¡çš„è¯ï¼Œæ— æ³•åˆ¤æ–­ A æ˜¯å¦èƒ½æ¥æ”¶åˆ° B çš„æ•°æ®ï¼‰ ä¸ºä»€ä¹ˆ TCP çš„å››æ¬¡æŒ¥æ‰‹ä¸èƒ½å°†ä¸­é—´ä¸¤æ­¥åˆå¹¶æˆä¸€æ­¥ï¼Ÿå› ä¸ºä¸¤æ­¥ä¸­é—´ï¼ˆæŒ‡å‘é€ACK(x+1)å’ŒFIN(y)ä¹‹é—´ï¼‰å¾€å¾€ä¼šæœ‰å…¶ä»–æ•°æ®éœ€è¦å‘é€ï¼Œéœ€è¦ç­‰å…¶ä»–æ•°æ®å‘é€å®Œæˆä¹‹åï¼Œå†å‘é€FIN(y)","tags":["DNS","TCP"],"categories":["å­¦ä¹ ç¬”è®°"]},{"title":"æµ…æ Promiseã€Async/Await","path":"/2021/08/17/promise-async-await/","content":"PromiseåŸºæœ¬ç”¨æ³•Promise çš„ç®€å•å°è£…ä¸ä½¿ç”¨ 1234567891011// å°è£…function æ‘‡è‰²å­() &#123; return new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(Math.floor(Math.random() * 6) + 1) &#125;, 3000) &#125;)&#125;// ä½¿ç”¨æ‘‡è‰²å­().then(success1, failed1).then(success2, failed2) Ma Mi ä»»åŠ¡æ¨¡å‹ Ma æŒ‡ MacroTask(å®ä»»åŠ¡)ï¼ŒMi æŒ‡ MicroTask(å¾®ä»»åŠ¡) å…ˆ Ma å† Miï¼Œå³å…ˆæ‰§è¡Œå®ä»»åŠ¡å†æ‰§è¡Œå¾®ä»»åŠ¡ JavaScript è¿è¡Œæ—¶ï¼Œé™¤äº†ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ä¸»çº¿ç¨‹ï¼Œå¼•æ“è¿˜æä¾›ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ï¼ˆtask queueï¼‰ï¼Œé‡Œé¢æ˜¯å„ç§éœ€è¦å½“å‰ç¨‹åºå¤„ç†çš„å¼‚æ­¥ä»»åŠ¡ å…¶å®æœ€åˆ JS åªå­˜åœ¨ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ï¼Œä¸ºäº†è®© Promise å›è°ƒæ›´æ—©æ‰§è¡Œï¼Œå¼ºè¡Œåˆæ’å…¥äº†ä¸€ä¸ªå¼‚æ­¥çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œç”¨æ¥å­˜æ”¾ Mi ä»»åŠ¡ å®ä»»åŠ¡ï¼šsetTimeout()ã€setInterval()ã€ setImmediate()ã€ I&#x2F;Oã€UIæ¸²æŸ“ï¼ˆå¸¸è§çš„å®šæ—¶å™¨ï¼Œç”¨æˆ·äº¤äº’äº‹ä»¶ç­‰ç­‰ï¼‰ å¾®ä»»åŠ¡ï¼šPromiseã€process.nextTickã€Object.observeã€MutationObserver Promise çš„å…¶ä»– APIPromise.resolve(result): åˆ¶é€ ä¸€ä¸ªæˆåŠŸï¼ˆæˆ–å¤±è´¥ï¼‰åˆ¶é€ æˆåŠŸ 123456789101112function æ‘‡è‰²å­() &#123; return Promise.resolve(4)&#125;// ç­‰ä»·äºfunction æ‘‡è‰²å­() &#123; return new Promise((resolve, reject) =&gt; &#123; resolve(4) &#125;)&#125;æ‘‡è‰²å­().then(n =&gt; console.log(n)) // 4 åˆ¶é€ å¤±è´¥ 123456function æ‘‡è‰²å­() &#123; // æ­¤å¤„ Promise.resolve æ¥æ”¶çš„æ˜¯ä¸€ä¸ªå¤±è´¥çš„ Promise å®ä¾‹ï¼ˆçŠ¶æ€ä¸º rejectï¼‰ return Promise.resolve(new Promise((resolve, reject) =&gt; reject()))&#125;æ‘‡è‰²å­().then(n =&gt; console.log(n)) // 1 Uncaught (in promise) undefined å…³äº Promise.resolve æ¥æ”¶å‚æ•°çš„é—®é¢˜ï¼ŒECMAScript 6 å…¥é—¨é‡Œå…¶å®è¯´å¾—å¾ˆæ¸…æ¥š å¦‚æœå‚æ•°æ˜¯ Promise å®ä¾‹ï¼Œé‚£ä¹ˆPromise.resolveå°†ä¸åšä»»ä½•ä¿®æ”¹ã€åŸå°ä¸åŠ¨åœ°è¿”å›è¿™ä¸ªå®ä¾‹ï¼›å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªåŸå§‹å€¼ï¼Œæˆ–è€…æ²¡æœ‰å‚æ•°ï¼ŒPromise.resolveéƒ½ä¼šç›´æ¥è¿”å›ä¸€ä¸ªresolvedçŠ¶æ€çš„ Promise å¯¹è±¡ã€‚ Promise.reject(reason): åˆ¶é€ ä¸€ä¸ªå¤±è´¥12345Promise.reject(&#x27;æˆ‘é”™äº†&#x27;)// ç­‰ä»·äºnew Promise((resolve, reject) =&gt; reject(&#x27;æˆ‘é”™äº†&#x27;))Promise.reject(&#x27;æˆ‘é”™äº†&#x27;).then(null, reason =&gt; console.log(reason)) // æˆ‘é”™äº† Promise.all(æ•°ç»„): ç­‰å¾…å…¨éƒ¨æˆåŠŸï¼Œæˆ–è€…æœ‰ä¸€ä¸ªå¤±è´¥å…¨éƒ¨æˆåŠŸï¼Œå°†æ‰€æœ‰æˆåŠŸ promise ç»“æœç»„æˆçš„æ•°ç»„è¿”å› 12Promise.all([Promise.resolve(1), Promise.resolve(2), Promise.resolve(3)]) .then(values =&gt; console.log(values)) // [1, 2, 3] åªè¦æœ‰ä¸€ä¸ªå¤±è´¥ï¼Œå°±ç»“æŸï¼Œè¿”å›æœ€å…ˆè¢« reject å¤±è´¥çŠ¶æ€çš„å€¼ 12Promise.all([Promise.reject(1), Promise.resolve(2), Promise.resolve(3)]) .then(values =&gt; console.log(values)) // Uncaught (in promise) 1 Promse.all åœ¨éœ€è¦å¯¹å¤šä¸ªå¼‚æ­¥è¿›è¡Œå¤„ç†æ—¶å¾€å¾€éå¸¸æœ‰ç”¨ï¼› ä¸è¿‡åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œç›´æ¥ä½¿ç”¨Promse.allå°±æ˜¾å¾—ä¸é‚£ä¹ˆæ–¹ä¾¿äº† ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ç°åœ¨æœ‰ 3 ä¸ªè¯·æ±‚ï¼Œrequest1, request2 å’Œ request3ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è¿™ 3 ä¸ªè¯·æ±‚è¿›è¡Œç»Ÿä¸€å¤„ç†ï¼Œå¹¶ä¸”ä¸ç®¡è¯·æ±‚æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½éœ€è¦æ‹¿åˆ°æ‰€æœ‰çš„å“åº”ç»“æœï¼Œå¦‚æœè¿™æ—¶å€™ä½¿ç”¨Promise.all([request1, request2, request3])çš„è¯ï¼Œrequest1 è¯·æ±‚å¤±è´¥äº†ï¼Œåé¢çš„ä¸¤ä¸ªè¯·æ±‚ request2, request3 å°±éƒ½ä¸ä¼šæ‰§è¡Œäº†ï¼ˆè¿™é‡Œå®é™…ä¸Šæ˜¯ request1 åœ¨ rejected ä¹‹åï¼Œè¢« Promise.all([]).catch ç»™æ•è·äº† ï¼‰ã€‚ å¦‚ä½•è§£å†³ Promise.all() åœ¨ç¬¬ä¸€ä¸ª Promise å¤±è´¥å°±ä¼šä¸­æ–­çš„é—®é¢˜ï¼Ÿ åˆ©ç”¨ .then() åä¼šè¿”å›ä¸€ä¸ªçŠ¶æ€ä¸º resolved çš„ Promiseï¼ˆå³ä¼šè‡ªåŠ¨åŒ…è£…æˆä¸€ä¸ªå·²resolvedçš„promiseï¼‰ï¼Œä»è€Œé¿å…è¢« Promise.all([]).catch æ•è· 123456789101112131415161718192021222324// 3 ä¸ªè¯·æ±‚const request1 = () =&gt; new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; reject(&#x27;ç¬¬ 1 ä¸ªè¯·æ±‚å¤±è´¥&#x27;) &#125;, 1000)&#125;)const request2 = () =&gt; new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; reject(&#x27;ç¬¬ 2 ä¸ªè¯·æ±‚å¤±è´¥&#x27;) &#125;, 2000)&#125;)const request3 = () =&gt; new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(&#x27;ç¬¬ 3 ä¸ªè¯·æ±‚æˆåŠŸ&#x27;) &#125;, 3000)&#125;)Promise.all([ request1().then(value =&gt; (&#123; status: &#x27;ok&#x27;, value &#125;), reason =&gt; (&#123; status: &#x27;not ok&#x27;, reason &#125;)), request2().then(value =&gt; (&#123; status: &#x27;ok&#x27;, value &#125;), reason =&gt; (&#123; status: &#x27;not ok&#x27;, reason &#125;)), request3().then(value =&gt; (&#123; status: &#x27;ok&#x27;, value &#125;), reason =&gt; (&#123; status: &#x27;not ok&#x27;, reason &#125;))]).then(result =&gt; console.log(result)) å¯ä»¥æŠŠå¯¹æ¯ä¸ªè¯·æ±‚çš„.thenæ“ä½œå°è£…ä¸€ä¸‹ 123456789101112const x = promiseList =&gt; promiseList.map(promise =&gt; promise.then(value =&gt; (&#123; status: &#x27;ok&#x27;, value&#125;), reason =&gt; (&#123; status: &#x27;not ok&#x27;, reason&#125;)))const xxx = promiseList =&gt; Promise.all(x(promiseList))xxx([request1(), request2(), request3()]) .then(result =&gt; console.log(result)) æ‰“å°ç»“æœå¦‚ä¸‹ï¼š Promise.allSettled(æ•°ç»„): ç­‰å¾…å…¨éƒ¨çŠ¶æ€æ”¹å˜12Promise.allSettled([Promise.reject(1), Promise.resolve(2), Promise.resolve(3)]) .then(result =&gt; console.log(result)) æ‰“å°ç»“æœå¦‚ä¸‹ï¼š å¯ä»¥çœ‹å‡º Promise.allSettled çš„ä½œç”¨å…¶å®å’Œä¸Šé¢æˆ‘ä»¬å®ç°çš„ xxx å‡½æ•°çš„ä½œç”¨æ˜¯ä¸€è‡´çš„ï¼Œå› æ­¤é’ˆå¯¹ä¸Šæ–‡æåˆ°åœºæ™¯ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ Promise.allSettledï¼Œæ›´åŠ ç®€æ´ã€‚ Promise.race(æ•°ç»„): ç­‰å¾…ç¬¬ä¸€ä¸ªçŠ¶æ€æ”¹å˜12345Promise.race([request1(), request2(), request3()]).then((result) =&gt; &#123; console.log(result)&#125;).catch((error) =&gt; &#123; console.log(error) // ç¬¬ 1 ä¸ªè¯·æ±‚å¤±è´¥&#125;) Promise.race([request1, request2, request3])é‡Œé¢å“ªä¸ªè¯·æ±‚æœ€å…ˆå“åº”ï¼Œå°±è¿”å›å…¶å¯¹åº”çš„ç»“æœï¼Œä¸ç®¡ç»“æœæœ¬èº«æ˜¯æˆåŠŸçŠ¶æ€è¿˜æ˜¯å¤±è´¥çŠ¶æ€ï¼ˆè¿™é‡Œæœ€å…ˆå“åº”çš„è¯·æ±‚æ˜¯ request1ï¼‰ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ç”¨ä¸åˆ° Promise.race è¿™ä¸ª apiï¼Œä¸è¿‡åœ¨æŸäº›åœºæ™¯ä¸‹è¿˜æ˜¯æœ‰ç”¨çš„ã€‚ä¾‹å¦‚åœ¨å¤šå°æœåŠ¡å™¨éƒ¨ç½²äº†åŒæ ·çš„æœåŠ¡ç«¯ä»£ç ï¼Œè¦ä»ä¸€ä¸ªå•†å“åˆ—è¡¨çš„æ¥å£æ‹¿æ•°æ®ï¼Œè¿™æ—¶å€™å°±å¯ä»¥åœ¨ race ä¸­å†™ä¸Šæ‰€æœ‰æœåŠ¡å™¨ä¸­çš„æŸ¥è¯¢å•†å“åˆ—è¡¨çš„æ¥å£åœ°å€ï¼Œå“ªä¸ªæœåŠ¡å™¨å“åº”å¿«ï¼Œå°±ä¼˜å…ˆä»å“ªä¸ªæœåŠ¡å™¨æ‹¿æ•°æ®ã€‚ Promise çš„åº”ç”¨åœºæ™¯å¤šæ¬¡å¤„ç†ä¸€ä¸ªç»“æœ1æ‘‡è‰²å­().then(v =&gt; v1).then(v1 =&gt; v2) ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°å®Œæˆä»¥åï¼Œä¼šå°†è¿”å›ç»“æœä½œä¸ºå‚æ•°ï¼Œä¼ å…¥ç¬¬äºŒä¸ªå›è°ƒå‡½æ•°ã€‚ ä¸²è¡Œ è¿™é‡Œæœ‰ä¸€ä¸ªæ‚–è®ºï¼šä¸€æ—¦ promise å‡ºç°ï¼Œé‚£ä¹ˆä»»åŠ¡å°±å·²ç»æ‰§è¡Œäº† æ‰€ä»¥ä¸æ˜¯ promise ä¸²è¡Œï¼Œè€Œæ˜¯ä»»åŠ¡ä¸²è¡Œ è§£æ³•ï¼šæŠŠä»»åŠ¡æ”¾è¿›é˜Ÿåˆ—ï¼Œå®Œæˆä¸€ä¸ªå†åšä¸‹ä¸€ä¸ªï¼ˆç”¨ Reduce å®ç° Promise ä¸²è¡Œæ‰§è¡Œï¼‰ å¹¶è¡ŒPromise.allã€Promise.allSettledã€Promise.raceéƒ½å¯ä»¥çœ‹ä½œæ˜¯å¹¶è¡Œåœ°åœ¨å¤„ç†ä»»åŠ¡ è¿™é‡Œå¯èƒ½ä½ ä¼šäº§ç”Ÿç–‘é—®ï¼ŒJS ä¸æ˜¯å•çº¿ç¨‹å—ï¼Œæ€ä¹ˆåšåˆ°å¹¶è¡Œæ‰§è¡Œä»»åŠ¡ï¼Ÿ è¿™é‡ŒæŒ‡çš„æ˜¯å¹¶è¡Œåœ°åšç½‘ç»œè¯·æ±‚çš„ä»»åŠ¡ï¼Œè€Œç½‘ç»œè¯·æ±‚å®é™…ä¸Šæ˜¯ç”±æµè§ˆå™¨æ¥åšçš„ï¼Œå¹¶éæ˜¯ JS åšçš„ï¼Œå°±åƒ setTimeout æ˜¯æµè§ˆå™¨çš„åŠŸèƒ½è€Œä¸æ˜¯ JS çš„ï¼ŒsetTimeout åªæ˜¯æµè§ˆå™¨æä¾›ç»™ JS çš„ä¸€ä¸ªæ¥å£ã€‚ Promise çš„é”™è¯¯å¤„ç†è‡ªèº«çš„é”™è¯¯å¤„ç†promise è‡ªèº«çš„é”™è¯¯å¤„ç†å…¶å®æŒºå¥½ç”¨çš„ï¼Œç›´æ¥åœ¨.thençš„ç¬¬äºŒä¸ªå›è°ƒå‚æ•°ä¸­è¿›è¡Œé”™è¯¯å¤„ç†å³å¯ 1promise.then(s1, f1) æˆ–è€…ä½¿ç”¨.catchè¯­æ³•ç³– 12// ä¸Šé¢å†™æ³•çš„è¯­æ³•ç³–promise.then(s1).catch(f1) å»ºè®®æ€»æ˜¯ä½¿ç”¨catch()æ–¹æ³•ï¼Œè€Œä¸ä½¿ç”¨then()æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ï¼ŒåŸå› æ˜¯ç¬¬äºŒç§å†™æ³•å¯ä»¥æ•è·å‰é¢thenæ–¹æ³•æ‰§è¡Œä¸­çš„é”™è¯¯ï¼Œä¹Ÿæ›´æ¥è¿‘åŒæ­¥çš„å†™æ³•ï¼ˆtry/catchï¼‰ å…¨å±€é”™è¯¯å¤„ç†ä»¥axiosä¸ºä¾‹ï¼ŒAxios ä½œå¼Šè¡¨ é”™è¯¯å¤„ç†ä¹‹å å¦‚æœä½ æ²¡æœ‰ç»§ç»­æŠ›é”™ï¼Œé‚£ä¹ˆé”™è¯¯å°±ä¸å†å‡ºç° å¦‚æœä½ ç»§ç»­æŠ›é”™ï¼Œé‚£ä¹ˆåç»­å›è°ƒå°±è¦ç»§ç»­å¤„ç†é”™è¯¯ å‰ç«¯ä¼¼ä¹å¯¹ Promise ä¸æ»¡Async&#x2F;Awaitæ›¿ä»£Promiseçš„6ä¸ªç†ç”±ï¼Œä¸»è¦æ˜¯ä»¥ä¸‹ 6 ä¸ªæ–¹é¢ï¼š ç®€æ´ é”™è¯¯å¤„ç† æ¡ä»¶è¯­å¥ ä¸­é—´å€¼ é”™è¯¯æ ˆ è°ƒè¯•ï¼ˆåœ¨.thenä»£ç å—ä¸­è®¾ç½®æ–­ç‚¹ï¼Œä½¿ç”¨ Step Over å¿«æ·é”®ï¼Œè°ƒè¯•å™¨ä¸ä¼šè·³åˆ°ä¸‹ä¸€ä¸ª.thenï¼Œå› ä¸ºå®ƒåªä¼šè·³è¿‡å¼‚æ­¥ä»£ç ï¼‰ async &#x2F; awaitasync &#x2F; await åŸºæœ¬ç”¨æ³•æœ€å¸¸è§çš„ç”¨æ³• 1234const fn = async() =&gt; &#123; const temp = await makePromise() return temp + 1&#125; ä¼˜ç‚¹ï¼šå®Œå…¨æ²¡æœ‰ç¼©è¿›ï¼Œå°±åƒæ˜¯åœ¨å†™åŒæ­¥ä»£ç  å°è£…ä¸€ä¸ª async å‡½æ•°asyncçš„å°è£…å’Œä½¿ç”¨ 1234567891011121314function æ‘‡è‰²å­() &#123; return new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(Math.floor(Math.random() * 6) + 1) &#125;, 3000) &#125;)&#125;async function fn() &#123; const result = await æ‘‡è‰²å­() console.log(result)&#125;fn() ç”¨try...catchè¿›è¡Œé”™è¯¯å¤„ç† 1234567891011121314async function æ‘‡è‰²å­() &#123; throw new Error(&#x27;è‰²å­åäº†&#x27;)&#125;async function fn() &#123; try &#123; const result = await æ‘‡è‰²å­() console.log(result) &#125; catch (error) &#123; console.log(error) &#125;&#125;fn() ä¸ºä»€ä¹ˆéœ€è¦ asyncåœ¨å‡½æ•°å‰é¢åŠ ä¸€ä¸ªasyncï¼Œè¿™çœ‹èµ·æ¥éå¸¸å¤šä½™ï¼Œawaitæ‰€åœ¨çš„å‡½æ•°å°±æ˜¯asyncï¼Œä¸æ˜¯å—ï¼Ÿ ç†ç”±ä¹‹ä¸€ï¼š åœ¨ ES æ ‡å‡†çš„ async&#x2F;await å‡ºæ¥ä¹‹å‰ï¼Œæœ‰äº›äººè‡ªå·±ç”¨å‡½æ•°å®ç°äº† awaitï¼Œä¸ºäº†å…¼å®¹æ—§ä»£ç é‡Œæ™®é€šå‡½æ•°çš„ await(xxx)ï¼ˆä¸ºäº†å°†æ—§ä»£ç é‡Œé¢çš„ await å’Œæ–°çš„ ES æ ‡å‡†é‡Œçš„ async&#x2F;await åŒºåˆ†å¼€æ¥ï¼‰ï¼Œå…¶å® async æœ¬èº«å¹¶æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ã€‚ ä½ å¯èƒ½ä¼šè¯´ï¼Œasyncå‡½æ•°ä¼šéšå¼åœ°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡å‘€ï¼Œä½†è¿™å¹¶ä¸èƒ½æˆä¸ºå¿…é¡»è¦åœ¨å‡½æ•°å‰åŠ asyncçš„ç†ç”±ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»çœ‹çœ‹çŸ¥ä¹ä¸Šå…³äºasyncçš„è®¨è®ºã€‚ ä¸ºä»€ä¹ˆjsé‡Œä½¿ç”¨äº†awaitçš„æ–¹æ³•å¿…é¡»å®šä¹‰æˆasyncçš„ï¼Ÿ C#ä¸­ï¼Œasyncå…³é”®å­—åˆ°åº•èµ·ä»€ä¹ˆä½œç”¨ï¼Ÿ await é”™è¯¯å¤„ç†ç”¨ try&#x2F;catch æ¥åŒæ—¶å¤„ç†åŒæ­¥å’Œå¼‚æ­¥é”™è¯¯æ˜¯å¾ˆå¸¸è§çš„åšæ³• 12345678910let responsetry &#123; response = await axios.get(&#x27;/xxx&#x27;)&#125; catch (e) &#123; if (e.response) &#123; console.log(e.response.status) throw e &#125;&#125;console.log(response) ä½†å…¶å®è¿˜æœ‰æ›´å¥½çš„å†™æ³•ï¼Œå°±åƒä¸‹é¢è¿™æ · 123456789101112const errorHandler = error =&gt; &#123; console.log(error) // æ³¨æ„è¿™é‡Œè¦æŠ›å‡ºä¸€ä¸ªé”™è¯¯ throw error // æˆ–è€… return Promise.reject(error)ï¼Œæ³¨æ„ï¼šä¸€å®šè¦ return&#125;// åªç”¨ä¸€å¥ä»£ç å°±å¯ä»¥å¤„ç†æˆåŠŸå’Œå¤±è´¥const response = await axios.get(&#x27;/xxx&#x27;).then(null, errorHandler)// æˆ–è€…ä½¿ç”¨ catch è¯­æ³•ç³–const response = await axios.get(&#x27;/xxx&#x27;).catch(errorHandler) éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒerrorHandlerå‡½æ•°ä¸­ä¸è¦ç›´æ¥returnä¸€ä¸ªå€¼ï¼Œä¸€å®šè¦æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼ˆæ‰“æ–­ç¨‹åºçš„è¿è¡Œï¼‰ã€‚å› ä¸ºåœ¨è¯·æ±‚è°ƒç”¨å¤±è´¥çš„æƒ…å†µä¸‹ï¼Œä¼šæŠŠerrorHandleré‡Œreturnçš„å€¼ç›´æ¥èµ‹å€¼ç»™ responseï¼ˆé€šä¿—çš„è¯´æ³•å°±æ˜¯â€œPromise ä¼šåƒæ‰é”™è¯¯â€ï¼‰ï¼Œåœ¨errorHandlerä¸­æŠ›å‡ºä¸€ä¸ªé”™è¯¯èƒ½å¤Ÿä¿è¯åœ¨è¯·æ±‚æˆåŠŸçš„æƒ…å†µä¸‹æ‰ä¼šæœ‰ responseï¼Œè¯·æ±‚å¤±è´¥çš„æƒ…å†µä¸‹ä¸€å®šæ˜¯ä¼šè¿›å…¥errorHandlerå‡½æ•°ä¸­çš„ ä¸‹é¢æ˜¯ä¸€ä¸ªå®é™…çš„ä¾‹å­ 123456789101112131415161718const ajax = function() &#123; return new Promise((resolve, reject) =&gt; &#123; reject(&#x27;è¿™æ˜¯å¤±è´¥åçš„æç¤º&#x27;) // resolve(&#x27;è¿™æ˜¯æˆåŠŸåçš„ç»“æœ&#x27;) &#125;)&#125;const error = (error) =&gt; &#123; console.log(&#x27;error:&#x27;, error) return Promise.reject(error)&#125;async function fn() &#123; const response = await ajax().then(null, error) console.log(&#x27;response:&#x27;, response)&#125;fn() å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä»…ä»…åªç”¨äº†ä¸€å¥ä»£ç å°±å¯ä»¥åŒæ—¶å¤„ç† Promise æˆåŠŸå’Œå¤±è´¥çš„æƒ…å†µäº†ï¼Œç»å¤§å¤šæ•°çš„ ajax è°ƒç”¨éƒ½æ˜¯å¯ä»¥ç”¨è¿™æ ·çš„æ–¹å¼æ¥å¤„ç†çš„ã€‚ æ‰€ä»¥ï¼Œå¯¹äºasync/awaitï¼Œå¹¶ä¸æ˜¯ä¸€å®šéœ€è¦ä½¿ç”¨try/catchæ¥åšé”™è¯¯å¤„ç†çš„ã€‚ ä¹‹å‰æˆ‘å¸¸å¸¸é™·å…¥ä¸€ä¸ªè¯¯åŒºï¼šå°±æ˜¯è®¤ä¸ºawaitå’Œ.thenæ˜¯å¯¹ç«‹çš„ï¼Œå§‹ç»ˆè§‰å¾—ç”¨äº†awaitåå°±ä¸åº”è¯¥å†å‡ºç°.thenã€‚ ä½†å…¶å®å¹¶éå¦‚æ­¤ï¼Œè¯´åˆ°åº•async/awaitä¹Ÿåªä¸è¿‡æ˜¯.thençš„è¯­æ³•ç³–è€Œå·²ã€‚å°±åƒä¸Šé¢çš„ä¾‹å­ä¸€æ ·ï¼Œ.thenå’Œawaitå®Œå…¨æ˜¯å¯ä»¥ç»“åˆåœ¨ä¸€èµ·ä½¿ç”¨çš„ï¼Œåœ¨.thenä¸­è¿›è¡Œé”™è¯¯å¤„ç†ï¼Œè€Œawaitå·¦è¾¹åªæ¥å—æˆåŠŸç»“æœã€‚ å¦å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŠŠ 4xx&#x2F;5xx ç­‰å¸¸è§é”™è¯¯ç”¨æ‹¦æˆªå™¨å…¨å±€å¤„ç†ï¼ŒerrorHandlerä¹Ÿå¯ä»¥æ”¾åœ¨æ‹¦æˆªå™¨é‡Œã€‚ await çš„ä¼ æŸ“æ€§ä»£ç ï¼š 123console.log(1)await console.log(2)console.log(3) // await ä¼šä½¿è¿™å¥ä»£ç å˜æˆå¼‚æ­¥çš„ï¼Œå¦‚æœæƒ³è¦è®©ä»–ç«‹å³æ‰§è¡Œï¼Œæ”¾åˆ° await å‰é¢å³å¯ åˆ†æï¼š awaitä¼šä½¿å¾—æ‰€æœ‰å®ƒå·¦è¾¹çš„å’Œä¸‹é¢çš„ä»£ç å˜æˆå¼‚æ­¥ä»£ç  console.log(3)å˜æˆå¼‚æ­¥ä»»åŠ¡äº† Promise åŒæ ·æœ‰ä¼ æŸ“æ€§ï¼ˆåŒæ­¥å˜å¼‚æ­¥ï¼‰ï¼Œæ”¾åˆ°.thenå›è°ƒå‡½æ•°ä¸­çš„ä»£ç ä¼šå˜æˆå¼‚æ­¥çš„ï¼Œä¸è¿‡ç›¸æ¯”äºawaitï¼Œ.thenä¸‹é¢çš„ä»£ç å¹¶ä¸ä¼šå˜æˆå¼‚æ­¥çš„ å›è°ƒæ²¡æœ‰ä¼ æŸ“æ€§ await çš„åº”ç”¨åœºæ™¯å¤šæ¬¡å¤„ç†ä¸€ä¸ªç»“æœ123const r1 = await makePromise()const r2 = handleR1(r1)const r3 = handleR2(r2) ä¸²è¡Œå¤©ç”Ÿä¸²è¡Œï¼ˆå¤šä¸ªawaitå¹¶æ’æ—¶ï¼Œä»ä¸Šåˆ°ä¸‹ä¾æ¬¡æ‰§è¡Œï¼Œåé¢çš„ä¼šç­‰å‰é¢æ‰§è¡Œå®Œäº†å†æ‰§è¡Œï¼‰ 1234await promise1await promise2await promise3... å¹¶è¡ŒåŒ Promiseï¼Œawait Promise.all([p1, p2, p3])ã€await Promise.allSettled([p1, p2, p3])ã€await Promise.race([p1, p2, p3]) éƒ½æ˜¯å¹¶è¡Œçš„ å¾ªç¯çš„æ—¶å€™å­˜åœ¨ bugæ­£å¸¸æƒ…å†µä¸‹ï¼Œå³ä¾¿åœ¨å¾ªç¯ä¸­ï¼Œawaitä¹Ÿåº”å½“æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ã€‚ ä¾‹å¦‚ for å¾ªç¯ä¸­çš„ await æ˜¯ä¸²è¡Œçš„ï¼ˆåé¢ç­‰å‰é¢ï¼‰ 1234567891011121314151617181920async function runPromiseByQueue(myPromises) &#123; for (let i = 0; i &lt; myPromises.length; i++) &#123; await myPromises[i](); &#125;&#125;const createPromise = (time, id) =&gt; () =&gt; new Promise((resolve) =&gt; setTimeout(() =&gt; &#123; console.log(&quot;promise&quot;, id); resolve(); &#125;, time) );runPromiseByQueue([ createPromise(3000, 4), createPromise(2000, 2), createPromise(1000, 1)]);// 4 2 1 ä½†æ˜¯åœ¨æŸäº›å¾ªç¯ä¸­ï¼Œå¦‚ forEach å’Œ map ä¸­ï¼Œawait ä¼šå¹¶è¡Œæ‰§è¡Œï¼ˆåé¢ä¸ç­‰å‰é¢ï¼‰ 1234567891011121314151617181920async function runPromiseByQueue(myPromises) &#123; myPromises.forEach(async (task) =&gt; &#123; await task(); &#125;);&#125;const createPromise = (time, id) =&gt; () =&gt; new Promise((resolve) =&gt; setTimeout(() =&gt; &#123; console.log(&quot;promise&quot;, id); resolve(); &#125;, time) );runPromiseByQueue([ createPromise(3000, 4), createPromise(2000, 2), createPromise(1000, 1)]);// 1 2 4 åé¢ JS åˆå‡ºäº†ä¸€ä¸ªæ–°çš„ä¸œè¥¿ for awaitâ€¦of æ¥å¼¥è¡¥è¿™ä¸ª bug 123456789101112131415161718192021async function runPromiseByQueue(myPromises) &#123; // å¼‚æ­¥è¿­ä»£ for await (let item of myPromises) &#123; console.log(&#x27;promise&#x27;, item); &#125;&#125;const createPromise = (time, id) =&gt; new Promise((resolve) =&gt; setTimeout(() =&gt; &#123; resolve(id); &#125;, time) );runPromiseByQueue([ createPromise(3000, 4), createPromise(2000, 2), createPromise(1000, 1)]);// 4 2 1","tags":["Promise","async/await"],"categories":["å­¦ä¹ ç¬”è®°"]},{"title":"JavaScript Snippets","path":"/2021/07/23/javascript-snippets/","content":":::infoæ”¶é›†çš„ä¸€äº›å¸¸ç”¨çš„ JavaScript ä»£ç ç‰‡æ®µ::: å°†ç»™å®šå­—ç¬¦ä¸²ä¸­æ¯ä¸ªå•è¯çš„é¦–å­—æ¯è½¬ä¸ºå¤§å†™1234const capitalizeWord = (string) =&gt; string.replace(/\\b[a-z]/g, (char) =&gt; char.toUpperCase());console.log(capitalizeWord(&quot;hello world in javascript&quot;)); // Hello World In Javascript è®¡ç®—ç»™å®šå­—ç¬¦ä¸²çš„å­—èŠ‚é•¿åº¦1234const byteSize = (string) =&gt; new Blob([string]).size;console.log(byteSize(&quot;vivy&quot;)); // 4console.log(byteSize(&quot;æ½®é¸£&quot;)); // 6 å°†æ•°ç»„å…ƒç´ è½¬æ¢ä¸ºæŒ‡å®šçš„ HTML å…ƒç´ ï¼Œä¸»è¦ç”¨äºå°†æ•°æ®è½¬æ¢ä¸ºç•Œé¢ HTML æ ¼å¼12345const arrayToHtmlList = (array, tag = &quot;li&quot;) =&gt; array.map((item) =&gt; `&lt;$&#123;tag&#125;&gt;$&#123;item&#125;&lt;/$&#123;tag&#125;&gt;`).join(&quot;&quot;);console.log(arrayToHtmlList([&quot;ç¬¬ä¸€æ¡&quot;, &quot;ç¬¬äºŒæ¡&quot;])); // &lt;li&gt;ç¬¬ä¸€æ¡&lt;/li&gt;&lt;li&gt;ç¬¬äºŒæ¡&lt;/li&gt;console.log(arrayToHtmlList([&quot;ç¬¬ä¸€æ¡&quot;, &quot;ç¬¬äºŒæ¡&quot;], &quot;p&quot;)); // &lt;p&gt;ç¬¬ä¸€æ¡&lt;/p&gt;&lt;p&gt;ç¬¬äºŒæ¡&lt;/p&gt; å¤šä¸ªæ•°å€¼æ±‚å¹³å‡å€¼1234567const average = (...nums) =&gt; nums.reduce((acc, val) =&gt; acc + val, 0) / nums.length;const ages = [23, 56, 15, 28];// æ­¤ä»£ç ä¹Ÿå±•ç¤ºäº†å‡½æ•°å¦‚ä½•ä¼ é€’ä¸å®šå‚æ•°ï¼ˆä½¿ç”¨ ES6 æ‰©å±•è¿ç®—ç¬¦ï¼‰console.log(average(...ages)); // 30.5console.log(average(23, 56, 15, 28)); // 30.5 è®¡ç®— map æ•°ç»„æŒ‰ç…§æŒ‡å®š key çš„å¹³å‡å€¼ï¼Œä¹Ÿå¯ä»¥ç»™å®šä¸€ä¸ªè¿­ä»£å‡½æ•°123456789101112const averageBy = (array, fn) =&gt; array.map(typeof fn === &quot;function&quot; ? fn : (val) =&gt; val[fn]).reduce((acc, val) =&gt; acc + val, 0) / array.length;const users = [ &#123; name: &quot;saber&quot;, size: 23 &#125;, &#123; name: &quot;vivy&quot;, size: 56 &#125;, &#123; name: &quot;tico&quot;, size: 15 &#125;, &#123; name: &quot;k423&quot;, size: 28 &#125;,];const average1 = averageBy(users, (item) =&gt; item.size);const average2 = averageBy(users, &quot;size&quot;);console.log(average1); // 30.5console.log(average2); // 30.5 å°è£… localStorage12345678910111213141516171819202122232425const useStorage = (storageKey = &quot;authorization&quot;) =&gt; &#123; const localKey = `devpoint.local.$&#123;storageKey&#125;`; const save = (data) =&gt; &#123; window.localStorage.setItem(localKey, JSON.stringify(data)); &#125;; const get = () =&gt; &#123; const localData = window.localStorage.getItem(localKey); if (localData &amp;&amp; localData !== &quot;&quot;) &#123; return JSON.parse(localData); &#125; else &#123; return false; &#125; &#125;; const clear = () =&gt; &#123; window.localStorage.setItem(localKey, &quot;&quot;); &#125;; return &#123; save, get, clear &#125;;&#125;;const storageAuth = useStorage();const loginInfo = &#123; username: &quot;vivy&quot;, age: 18,&#125;;storageAuth.save(loginInfo);console.log(storageAuth.get()); è®¡ç®—æ•°ç»„ä¸­æŸä¸ªå€¼çš„é‡å¤æ¬¡æ•°123456789const countOccurrences = (array, value) =&gt; array.reduce( (accumulator, current) =&gt; current === value ? accumulator + 1 : accumulator, 0 );console.log(countOccurrences([...&quot;vivy&quot;], &quot;v&quot;)); // 2console.log(countOccurrences([1, 3, 3, 4, 3, 3, 2, 3], 3)); // 5 æ£€æŸ¥å€¼æ˜¯å¦å±äºæŸä¸ªæ•°æ®ç±»å‹123456789const isCheck = (type, val) =&gt; ![undefined, null].includes(val) &amp;&amp; val.constructor === type;console.log(isCheck(Array, [&quot;a&quot;])); // trueconsole.log(isCheck(Object, &#123;&#125;)); // trueconsole.log(isCheck(ArrayBuffer, new ArrayBuffer())); // trueconsole.log(isCheck(Boolean, new Boolean(true))); // trueconsole.log(isCheck(RegExp, /./g)); // trueconsole.log(isCheck(Number, 0)); // true éå†å¯¹è±¡çš„æ¯ä¸ªå±æ€§ï¼Œå¹¶åˆ†åˆ«ä¸ºæ¯ä¸ªå±æ€§è¿­ä»£ä¸€ä¸ªå›è°ƒ123456789101112const forObject = (obj, callback) =&gt; Object.keys(obj).forEach((key) =&gt; callback(obj[key], key, obj));const testObj = &#123; word: &quot;ä¿¡ã˜ã‚‹å¿ƒãŒã‚ãªãŸã®é­”æ³•ã€œ&quot;, author: &quot;ç¯æ•¦å­&quot;,&#125;;forObject(testObj, (val, key) =&gt; &#123; console.log(`$&#123;key&#125;:$&#123;val&#125;`);&#125;);// word:ä¿¡ã˜ã‚‹å¿ƒãŒã‚ãªãŸã®é­”æ³•ã€œ// author:ç¯æ•¦å­ é€šè¿‡é”®å€¼æŸ¥æ‰¾å¯¹è±¡ï¼Œè¿”å›æ»¡è¶³ç»™å®šå‡½æ•°çš„ç¬¬ä¸€ä¸ª key12345678910const findKey = (obj, fn) =&gt; Object.keys(obj).find((key) =&gt; fn(obj[key], key, obj));const testObj = &#123; vivy: &#123; age: 17 &#125;, k423: &#123; age: 18 &#125;, saber: &#123; age: 19 &#125;,&#125;;console.log(findKey(testObj, (item) =&gt; item.age &gt; 18)); // saber å°†ä¸€ç»„æ•°æ®æŒ‰ç…§æŒ‡å®šçš„ key çš„è¿›è¡Œåˆ†ç»„ï¼Œå¹¶æŒ‰ç…§åˆ†ç»„è¿›è¡Œå½’ç±»1234567891011121314151617181920212223242526272829303132333435363738const groupBy = (obj, key) =&gt; &#123; const values = obj instanceof Map || obj instanceof Set ? Array.from(obj.values()) : Object.values(obj); return values.reduce((acc, value) =&gt; &#123; const groupKey = value[key]; if (!Array.isArray(acc[groupKey])) &#123; acc[groupKey] = [value]; &#125; else &#123; acc[groupKey].push(value); &#125; return acc; &#125;, &#123;&#125;);&#125;;const arrayRoles = [ &#123; title: &quot;Mieruko-chan&quot;, category: &quot;xxx&quot; &#125;, &#123; title: &quot;Vladilena MirizÃ©&quot;, category: &quot;xxx&quot; &#125;, &#123; title: &quot;Nakano Azusa&quot;, category: &quot;xxx&quot; &#125;, &#123; title: &quot;Shirahane Suou&quot;, category: &quot;yyy&quot; &#125;, &#123; title: &quot;Mio Akiyama&quot;, category: &quot;yyy&quot; &#125;,];console.log(groupBy(arrayRoles, &quot;category&quot;));/*&#123; &#x27;xxx&#x27;: [ &#123; title: &#x27;Mieruko-chan&#x27;, category: &#x27;xxx&#x27; &#125;, &#123; title: &#x27;Vladilena MirizÃ©&#x27;, category: &#x27;xxx&#x27; &#125;, &#123; title: &#x27;Nakano Azusa&#x27;, category: &#x27;xxx&#x27; &#125; ], &#x27;yyy&#x27;: [ &#123; title: &#x27;Shirahane Suou&#x27;, category: &#x27;yyy&#x27; &#125;, &#123; title: &#x27;Mio Akiyama&#x27;, category: &#x27;yyy&#x27; &#125; ]&#125;*/","tags":["JavaScript Snippets","Tool function"],"categories":["å­¦ä¹ ç¬”è®°"]},{"title":"ç¬¬ä¸‰æ–¹åº”ç”¨æˆæƒï¼šOAuth 2.0","path":"/2021/06/21/oauth2.0/","content":"ä»‹ç»OAuth 2.0 æ˜¯ç›®å‰æœ€æµè¡Œçš„æˆæƒæœºåˆ¶ï¼Œç”¨æ¥æˆæƒç¬¬ä¸‰æ–¹åº”ç”¨ï¼Œè·å–ç”¨æˆ·æ•°æ®ã€‚ ç®€å•è¯´ï¼ŒOAuth å°±æ˜¯ä¸€ç§æˆæƒæœºåˆ¶ã€‚æ•°æ®çš„æ‰€æœ‰è€…å‘Šè¯‰ç³»ç»Ÿï¼ŒåŒæ„æˆæƒç¬¬ä¸‰æ–¹åº”ç”¨è¿›å…¥ç³»ç»Ÿï¼Œè·å–è¿™äº›æ•°æ®ã€‚ç³»ç»Ÿä»è€Œäº§ç”Ÿä¸€ä¸ªçŸ­æœŸçš„è¿›å…¥ä»¤ç‰Œï¼ˆaccess_tokenï¼‰ï¼Œç”¨æ¥ä»£æ›¿å¯†ç ï¼Œä¾›ç¬¬ä¸‰æ–¹åº”ç”¨ä½¿ç”¨ã€‚ OAuth 2.0 çš„ä¼˜ç‚¹ï¼šä¿è¯äº†ä»¤ç‰Œæ—¢å¯ä»¥è®©ç¬¬ä¸‰æ–¹åº”ç”¨è·å¾—æƒé™ï¼ŒåŒæ—¶åˆéšæ—¶å¯æ§ï¼Œä¸ä¼šå±åŠç³»ç»Ÿå®‰å…¨ ä»¤ç‰Œä¸å¯†ç çš„åŒºåˆ«ä»¤ç‰Œï¼ˆtokenï¼‰ä¸å¯†ç ï¼ˆpasswordï¼‰çš„ä½œç”¨æ˜¯ä¸€æ ·çš„ï¼Œéƒ½å¯ä»¥è¿›å…¥ç³»ç»Ÿï¼Œä½†æ˜¯æœ‰ä¸‰ç‚¹å·®å¼‚ã€‚ ä»¤ç‰Œæ˜¯çŸ­æœŸçš„ï¼Œåˆ°æœŸä¼šè‡ªåŠ¨å¤±æ•ˆï¼Œç”¨æˆ·è‡ªå·±æ— æ³•ä¿®æ”¹ã€‚å¯†ç ä¸€èˆ¬é•¿æœŸæœ‰æ•ˆï¼Œç”¨æˆ·ä¸ä¿®æ”¹ï¼Œå°±ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚ ä»¤ç‰Œå¯ä»¥è¢«æ•°æ®æ‰€æœ‰è€…æ’¤é”€ï¼Œä¼šç«‹å³å¤±æ•ˆã€‚å¯†ç ä¸€èˆ¬ä¸å…è®¸è¢«ä»–äººæ’¤é”€ã€‚ ä»¤ç‰Œæœ‰æƒé™èŒƒå›´ï¼ˆscopeï¼‰ã€‚å¯¹äºç½‘ç»œæœåŠ¡æ¥è¯´ï¼Œåªè¯»ä»¤ç‰Œå°±æ¯”è¯»å†™ä»¤ç‰Œæ›´å®‰å…¨ã€‚å¯†ç ä¸€èˆ¬æ˜¯å®Œæ•´æƒé™ã€‚ :::warningåªè¦çŸ¥é“äº†ä»¤ç‰Œï¼Œå°±èƒ½è¿›å…¥ç³»ç»Ÿã€‚ç³»ç»Ÿä¸€èˆ¬ä¸ä¼šå†æ¬¡ç¡®è®¤èº«ä»½ï¼Œæ‰€ä»¥ä»¤ç‰Œå¿…é¡»ä¿å¯†ï¼Œæ³„æ¼ä»¤ç‰Œä¸æ³„æ¼å¯†ç çš„åæœæ˜¯ä¸€æ ·çš„ã€‚ è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä»¤ç‰Œçš„æœ‰æ•ˆæœŸï¼Œä¸€èˆ¬éƒ½è®¾ç½®å¾—å¾ˆçŸ­çš„åŸå› ã€‚::: å››ç§æˆæƒç±»å‹ï¼ˆauthorization grantï¼‰å³å››ç§é¢å‘ä»¤ç‰Œçš„æ–¹å¼ï¼š æˆæƒç ï¼ˆauthorization-codeï¼‰ éšè—å¼ï¼ˆimplicitï¼‰ å¯†ç å¼ï¼ˆpasswordï¼‰ï¼š å®¢æˆ·ç«¯å‡­è¯ï¼ˆclient credentialsï¼‰ :::primaryä¸ç®¡å“ªä¸€ç§æˆæƒæ–¹å¼ï¼Œç¬¬ä¸‰æ–¹åº”ç”¨ç”³è¯·ä»¤ç‰Œä¹‹å‰ï¼Œéƒ½å¿…é¡»å…ˆåˆ°ç³»ç»Ÿå¤‡æ¡ˆï¼Œè¯´æ˜è‡ªå·±çš„èº«ä»½ï¼Œç„¶åä¼šæ‹¿åˆ°ä¸¤ä¸ªèº«ä»½è¯†åˆ«ç ï¼šå®¢æˆ·ç«¯ IDï¼ˆclient IDï¼‰å’Œå®¢æˆ·ç«¯å¯†é’¥ï¼ˆclient secretï¼‰ã€‚è¿™æ˜¯ä¸ºäº†é˜²æ­¢ä»¤ç‰Œè¢«æ»¥ç”¨ï¼Œæ²¡æœ‰å¤‡æ¡ˆè¿‡çš„ç¬¬ä¸‰æ–¹åº”ç”¨ï¼Œæ˜¯ä¸ä¼šæ‹¿åˆ°ä»¤ç‰Œçš„ã€‚::: ç¬¬ä¸€ç§æˆæƒæ–¹å¼ï¼šæˆæƒç æˆæƒç ï¼ˆauthorization codeï¼‰æ–¹å¼ï¼ŒæŒ‡çš„æ˜¯ç¬¬ä¸‰æ–¹åº”ç”¨å…ˆç”³è¯·ä¸€ä¸ªæˆæƒç ï¼Œç„¶åå†ç”¨è¯¥ç è·å–ä»¤ç‰Œã€‚:::infoè¿™ç§æ–¹å¼æ˜¯&#x3D;&#x3D;æœ€å¸¸ç”¨çš„æµç¨‹&#x3D;&#x3D;ï¼Œå®‰å…¨æ€§ä¹Ÿæœ€é«˜ï¼Œå®ƒé€‚ç”¨äºé‚£äº›++æœ‰åç«¯çš„ Web åº”ç”¨++{.wavy .success}ã€‚æˆæƒç é€šè¿‡å‰ç«¯ä¼ é€ï¼Œ++ä»¤ç‰Œåˆ™æ˜¯å‚¨å­˜åœ¨åç«¯++{.dot}ï¼Œè€Œä¸”æ‰€æœ‰ä¸èµ„æºæœåŠ¡å™¨çš„é€šä¿¡éƒ½åœ¨åç«¯å®Œæˆã€‚è¿™æ ·çš„å‰åç«¯åˆ†ç¦»ï¼Œå¯ä»¥é¿å…ä»¤ç‰Œæ³„æ¼ã€‚::: ä¸¾ä¾‹è¯´æ˜ï¼š A ç½‘ç«™æä¾›ä¸€ä¸ªé“¾æ¥ï¼Œç”¨æˆ·ç‚¹å‡»åå°±ä¼šè·³è½¬åˆ° B ç½‘ç«™ï¼Œæˆæƒç”¨æˆ·æ•°æ®ç»™ A ç½‘ç«™ä½¿ç”¨ 12345https://b.com/oauth/authorize? response_type=code&amp; client_id=CLIENT_ID&amp; redirect_uri=CALLBACK_URL&amp; scope=read response_typeå‚æ•°è¡¨ç¤ºè¦æ±‚è¿”å›æˆæƒç ï¼ˆcodeï¼‰ï¼Œclient_idå‚æ•°è®© B çŸ¥é“æ˜¯è°åœ¨è¯·æ±‚ï¼Œredirect_uriå‚æ•°æ˜¯ B æ¥å—æˆ–æ‹’ç»è¯·æ±‚åçš„è·³è½¬ç½‘å€ï¼Œscopeå‚æ•°è¡¨ç¤ºè¦æ±‚çš„æˆæƒèŒƒå›´ï¼ˆè¿™é‡Œæ˜¯åªè¯»ï¼‰ã€‚ ç”¨æˆ·è·³è½¬åï¼ŒB ç½‘ç«™ä¼šè¦æ±‚ç”¨æˆ·ç™»å½•ï¼Œç„¶åè¯¢é—®æ˜¯å¦åŒæ„ç»™äºˆ A ç½‘ç«™æˆæƒã€‚ç”¨æˆ·è¡¨ç¤ºåŒæ„ï¼Œè¿™æ—¶ B ç½‘ç«™å°±ä¼šè·³å›redirect_uriå‚æ•°æŒ‡å®šçš„ç½‘å€ã€‚è·³è½¬æ—¶ï¼Œä¼šä¼ å›ä¸€ä¸ªæˆæƒç  1https://a.com/callback?code=AUTHORIZATION_CODE A ç½‘ç«™æ‹¿åˆ°æˆæƒç ä»¥åï¼Œå°±å¯ä»¥&#x3D;&#x3D;åœ¨åç«¯&#x3D;&#x3D;ï¼Œå‘ B ç½‘ç«™è¯·æ±‚ä»¤ç‰Œ 123456https://b.com/oauth/token? client_id=CLIENT_ID&amp; client_secret=CLIENT_SECRET&amp; grant_type=authorization_code&amp; code=AUTHORIZATION_CODE&amp; redirect_uri=CALLBACK_URL client_idå‚æ•°å’Œclient_secretå‚æ•°ç”¨æ¥è®© B ç¡®è®¤ A çš„èº«ä»½ï¼ˆclient_secretå‚æ•°æ˜¯ä¿å¯†çš„ï¼Œå› æ­¤åªèƒ½åœ¨åç«¯å‘è¯·æ±‚ï¼‰ï¼Œgrant_typeå‚æ•°çš„å€¼æ˜¯AUTHORIZATION_CODEï¼Œè¡¨ç¤ºé‡‡ç”¨çš„æˆæƒæ–¹å¼æ˜¯æˆæƒç ï¼Œcodeå‚æ•°æ˜¯ä¸Šä¸€æ­¥æ‹¿åˆ°çš„æˆæƒç ï¼Œredirect_uriå‚æ•°æ˜¯ä»¤ç‰Œé¢å‘åçš„å›è°ƒç½‘å€ã€‚ B ç½‘ç«™æ”¶åˆ°è¯·æ±‚ä»¥åï¼Œå°±ä¼šé¢å‘ä»¤ç‰Œã€‚å…·ä½“åšæ³•æ˜¯å‘redirect_uriæŒ‡å®šçš„ç½‘å€ï¼Œå‘é€ä¸€æ®µ JSON æ•°æ® 123456789&#123; &quot;access_token&quot;:&quot;ACCESS_TOKEN&quot;, &quot;token_type&quot;:&quot;bearer&quot;, &quot;expires_in&quot;:2592000, &quot;refresh_token&quot;:&quot;REFRESH_TOKEN&quot;, &quot;scope&quot;:&quot;read&quot;, &quot;uid&quot;:100101, &quot;info&quot;:&#123;...&#125;&#125; access_tokenå­—æ®µå°±æ˜¯ä»¤ç‰Œï¼ŒA ç½‘ç«™åœ¨åç«¯æ‹¿åˆ°äº†ã€‚ ç¬¬äºŒç§æ–¹å¼ï¼šéšè—å¼æœ‰äº› Web åº”ç”¨æ˜¯&#x3D;&#x3D;çº¯å‰ç«¯åº”ç”¨&#x3D;&#x3D;ï¼Œæ²¡æœ‰åç«¯ã€‚è¿™æ—¶å°±ä¸èƒ½ç”¨ä¸Šé¢çš„æ–¹å¼äº†ï¼Œå¿…é¡»++å°†ä»¤ç‰Œå‚¨å­˜åœ¨å‰ç«¯++{.dot}ã€‚RFC 6749 å°±è§„å®šäº†ç¬¬äºŒç§æ–¹å¼ï¼Œå…è®¸ç›´æ¥å‘å‰ç«¯é¢å‘ä»¤ç‰Œã€‚è¿™ç§æ–¹å¼++æ²¡æœ‰æˆæƒç è¿™ä¸ªä¸­é—´æ­¥éª¤++{.dot}ï¼Œæ‰€ä»¥ç§°ä¸ºï¼ˆæˆæƒç ï¼‰â€éšè—å¼â€ï¼ˆimplicitï¼‰ã€‚ A ç½‘ç«™æä¾›ä¸€ä¸ªé“¾æ¥ï¼Œè¦æ±‚ç”¨æˆ·è·³è½¬åˆ° B ç½‘ç«™ï¼Œæˆæƒç”¨æˆ·æ•°æ®ç»™ A ç½‘ç«™ä½¿ç”¨ 12345https://b.com/oauth/authorize? response_type=token&amp; client_id=CLIENT_ID&amp; redirect_uri=CALLBACK_URL&amp; scope=read response_typeå‚æ•°ä¸ºtokenï¼Œè¡¨ç¤ºè¦æ±‚ç›´æ¥è¿”å›ä»¤ç‰Œã€‚ ç”¨æˆ·è·³è½¬åˆ° B ç½‘ç«™ï¼Œç™»å½•ååŒæ„ç»™äºˆ A ç½‘ç«™æˆæƒã€‚è¿™æ—¶ï¼ŒB ç½‘ç«™å°±ä¼šè·³å›redirect_uriå‚æ•°æŒ‡å®šçš„è·³è½¬ç½‘å€ï¼Œå¹¶ä¸”æŠŠä»¤ç‰Œä½œä¸º URL å‚æ•°ï¼Œä¼ ç»™ A ç½‘ç«™ã€‚ 1https://a.com/callback#token=ACCESS_TOKEN tokenå‚æ•°å°±æ˜¯ä»¤ç‰Œï¼ŒA ç½‘ç«™å› æ­¤ç›´æ¥åœ¨å‰ç«¯æ‹¿åˆ°ä»¤ç‰Œã€‚ :::infoæ³¨æ„ï¼Œä»¤ç‰Œçš„ä½ç½®æ˜¯ URL é”šç‚¹ï¼ˆfragmentï¼‰ï¼Œè€Œä¸æ˜¯æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆquerystringï¼‰ï¼Œè¿™æ˜¯å› ä¸º OAuth 2.0 å…è®¸è·³è½¬ç½‘å€æ˜¯ HTTP åè®®ï¼Œå› æ­¤å­˜åœ¨â€ä¸­é—´äººæ”»å‡»â€çš„é£é™©ï¼Œè€Œæµè§ˆå™¨è·³è½¬æ—¶ï¼Œé”šç‚¹ä¸ä¼šå‘åˆ°æœåŠ¡å™¨ï¼Œå°±å‡å°‘äº†æ³„æ¼ä»¤ç‰Œçš„é£é™©ã€‚å¦å¤–ï¼Œè¿™ç§æ–¹å¼æŠŠä»¤ç‰Œç›´æ¥ä¼ ç»™å‰ç«¯ï¼Œæ˜¯å¾ˆä¸å®‰å…¨çš„ã€‚å› æ­¤ï¼Œåªèƒ½ç”¨äºä¸€äº›å®‰å…¨è¦æ±‚ä¸é«˜çš„åœºæ™¯ï¼Œå¹¶ä¸”ä»¤ç‰Œçš„æœ‰æ•ˆæœŸå¿…é¡»éå¸¸çŸ­ï¼Œé€šå¸¸å°±æ˜¯ä¼šè¯æœŸé—´ï¼ˆsessionï¼‰æœ‰æ•ˆï¼Œæµè§ˆå™¨å…³æ‰ï¼Œä»¤ç‰Œå°±å¤±æ•ˆäº†ã€‚::: ç¬¬ä¸‰ç§æ–¹å¼ï¼šå¯†ç å¼å¦‚æœä½ é«˜åº¦ä¿¡ä»»æŸä¸ªåº”ç”¨ï¼ŒRFC 6749 ä¹Ÿå…è®¸ç”¨æˆ·æŠŠç”¨æˆ·åå’Œå¯†ç ï¼Œç›´æ¥å‘Šè¯‰è¯¥åº”ç”¨ã€‚è¯¥åº”ç”¨å°±ä½¿ç”¨ä½ çš„å¯†ç ï¼Œç”³è¯·ä»¤ç‰Œï¼Œè¿™ç§æ–¹å¼ç§°ä¸ºâ€å¯†ç å¼â€ï¼ˆpasswordï¼‰ã€‚ A ç½‘ç«™è¦æ±‚ç”¨æˆ·æä¾› B ç½‘ç«™çš„ç”¨æˆ·åå’Œå¯†ç ã€‚æ‹¿åˆ°ä»¥åï¼ŒA å°±ç›´æ¥å‘ B è¯·æ±‚ä»¤ç‰Œã€‚ 12345https://oauth.b.com/token? grant_type=password&amp; username=USERNAME&amp; password=PASSWORD&amp; client_id=CLIENT_ID grant_typeå‚æ•°æ˜¯æˆæƒæ–¹å¼ï¼Œè¿™é‡Œçš„passwordè¡¨ç¤ºâ€å¯†ç å¼â€ï¼Œusernameå’Œpasswordæ˜¯ B çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ B ç½‘ç«™éªŒè¯èº«ä»½é€šè¿‡åï¼Œç›´æ¥ç»™å‡ºä»¤ç‰Œã€‚æ³¨æ„ï¼Œè¿™æ—¶ä¸éœ€è¦è·³è½¬ï¼Œè€Œæ˜¯æŠŠä»¤ç‰Œæ”¾åœ¨ JSON æ•°æ®é‡Œé¢ï¼Œä½œä¸º HTTP å“åº”ï¼ŒA å› æ­¤æ‹¿åˆ°ä»¤ç‰Œã€‚ :::dangerè¿™ç§æ–¹å¼éœ€è¦ç”¨æˆ·ç»™å‡ºè‡ªå·±çš„ç”¨æˆ·å&#x2F;å¯†ç ï¼Œæ˜¾ç„¶é£é™©å¾ˆå¤§ï¼Œå› æ­¤åªé€‚ç”¨äºå…¶ä»–æˆæƒæ–¹å¼éƒ½æ— æ³•é‡‡ç”¨çš„æƒ…å†µï¼Œè€Œä¸”å¿…é¡»æ˜¯ç”¨æˆ·é«˜åº¦ä¿¡ä»»çš„åº”ç”¨ã€‚::: ç¬¬å››ç§æ–¹å¼ï¼šå‡­è¯å¼æœ€åä¸€ç§æ–¹å¼æ˜¯å‡­è¯å¼ï¼ˆclient credentialsï¼‰ï¼Œé€‚ç”¨äº++æ²¡æœ‰å‰ç«¯çš„å‘½ä»¤è¡Œåº”ç”¨++{.dot}ï¼Œå³åœ¨å‘½ä»¤è¡Œä¸‹è¯·æ±‚ä»¤ç‰Œã€‚ A åº”ç”¨åœ¨å‘½ä»¤è¡Œå‘ B å‘å‡ºè¯·æ±‚ã€‚ 1234https://oauth.b.com/token? grant_type=client_credentials&amp; client_id=CLIENT_ID&amp; client_secret=CLIENT_SECRET grant_typeå‚æ•°ç­‰äºclient_credentialsè¡¨ç¤ºé‡‡ç”¨å‡­è¯å¼ï¼Œclient_idå’Œclient_secretç”¨æ¥è®© B ç¡®è®¤ A çš„èº«ä»½ã€‚ B ç½‘ç«™éªŒè¯é€šè¿‡ä»¥åï¼Œç›´æ¥è¿”å›ä»¤ç‰Œ :::infoè¿™ç§æ–¹å¼ç»™å‡ºçš„ä»¤ç‰Œï¼Œæ˜¯é’ˆå¯¹ç¬¬ä¸‰æ–¹åº”ç”¨çš„ï¼Œè€Œä¸æ˜¯é’ˆå¯¹ç”¨æˆ·çš„ï¼Œå³æœ‰å¯èƒ½å¤šä¸ªç”¨æˆ·å…±äº«åŒä¸€ä¸ªä»¤ç‰Œã€‚::: ä»¤ç‰Œçš„ä½¿ç”¨A ç½‘ç«™æ‹¿åˆ°ä»¤ç‰Œä»¥åï¼Œå°±å¯ä»¥å‘ B ç½‘ç«™çš„ API è¯·æ±‚æ•°æ®äº†ã€‚ æ­¤æ—¶ï¼Œæ¯ä¸ªå‘åˆ° API çš„è¯·æ±‚ï¼Œéƒ½å¿…é¡»å¸¦æœ‰ä»¤ç‰Œã€‚å…·ä½“åšæ³•æ˜¯åœ¨è¯·æ±‚çš„å¤´ä¿¡æ¯ï¼ŒåŠ ä¸Šä¸€ä¸ªAuthorizationå­—æ®µï¼Œä»¤ç‰Œå°±æ”¾åœ¨è¿™ä¸ªå­—æ®µé‡Œé¢ã€‚ 12curl -H &quot;Authorization: Bearer ACCESS_TOKEN&quot; \\&quot;https://api.b.com&quot; æ›´æ–°ä»¤ç‰Œä»¤ç‰Œçš„æœ‰æ•ˆæœŸåˆ°äº†ï¼Œå¦‚æœè®©ç”¨æˆ·é‡æ–°èµ°ä¸€éä¸Šé¢çš„æµç¨‹ï¼Œå†ç”³è¯·ä¸€ä¸ªæ–°çš„ä»¤ç‰Œï¼Œå¾ˆå¯èƒ½ä½“éªŒä¸å¥½ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰å¿…è¦ã€‚OAuth 2.0 å…è®¸ç”¨æˆ·è‡ªåŠ¨æ›´æ–°ä»¤ç‰Œã€‚ å…·ä½“æ–¹æ³•æ˜¯ï¼ŒB ç½‘ç«™é¢å‘ä»¤ç‰Œçš„æ—¶å€™ï¼Œä¸€æ¬¡æ€§é¢å‘ä¸¤ä¸ªä»¤ç‰Œï¼Œä¸€ä¸ªç”¨äºè·å–æ•°æ®ï¼Œå¦ä¸€ä¸ªç”¨äºè·å–æ–°çš„ä»¤ç‰Œï¼ˆrefresh token å­—æ®µï¼‰ã€‚ä»¤ç‰Œåˆ°æœŸå‰ï¼Œç”¨æˆ·ä½¿ç”¨ refresh token å‘ä¸€ä¸ªè¯·æ±‚ï¼Œå»æ›´æ–°ä»¤ç‰Œã€‚ 12345https://b.com/oauth/token? grant_type=refresh_token&amp; client_id=CLIENT_ID&amp; client_secret=CLIENT_SECRET&amp; refresh_token=REFRESH_TOKEN grant_typeå‚æ•°ä¸ºrefresh_tokenè¡¨ç¤ºè¦æ±‚æ›´æ–°ä»¤ç‰Œï¼Œclient_idå‚æ•°å’Œclient_secretå‚æ•°ç”¨äºç¡®è®¤èº«ä»½ï¼Œrefresh_tokenå‚æ•°å°±æ˜¯ç”¨äºæ›´æ–°ä»¤ç‰Œçš„ä»¤ç‰Œã€‚ B ç½‘ç«™éªŒè¯é€šè¿‡ä»¥åï¼Œå°±ä¼šé¢å‘æ–°çš„ä»¤ç‰Œã€‚","tags":["OAuth 2.0","ç¬¬ä¸‰æ–¹åº”ç”¨æˆæƒ"],"categories":["å­¦ä¹ ç¬”è®°"]},{"title":"npm & package.json","path":"/2021/06/17/npm&package.json/","content":"npm æ˜¯ä»€ä¹ˆnpm æ˜¯ Node.js çš„åŒ…ç®¡ç†å·¥å…·ï¼ŒNode.js package mangerï¼Œé€šè¿‡ npm Node.js å¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨ç¬¬ä¸‰æ–¹å¼€å‘çš„å¼€æºæ¨¡å—ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æŠŠè‡ªå·±çš„æ¨¡å—å‘å¸ƒåˆ° npm ä¾›å…¶å®ƒå¼€å‘è€…ä½¿ç”¨ã€‚ npm ä¸»è¦ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š npm websiteï¼šhttps://npmjs.comï¼Œå¼€å‘è€…æŸ¥æ‰¾å‘ç° package çš„ç«™ç‚¹ CLIï¼ˆå‘½ä»¤è¡Œï¼‰ï¼šå¼€å‘è€…å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·å’Œ npm è¿›è¡Œäº¤äº’ï¼Œå¯¹ package è¿›è¡Œå®‰è£…ã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œ registryï¼ˆæ³¨å†Œè¡¨ï¼‰ï¼špackage åŠå…¶å…ƒä¿¡æ¯å­˜å‚¨çš„æ•°æ®åº“ :::infoæ³¨å†Œè¡¨æ˜¯ä¸€ä¸ªå·¨å¤§çš„æ•°æ®åº“ï¼Œä¿å­˜äº†æ¯ä¸ªåŒ…ï¼ˆpackageï¼‰çš„ä¿¡æ¯ã€‚ä¾‹å¦‚æˆ‘ä»¬è¦æŸ¥è¯¢ vue åŒ…çš„ä¿¡æ¯ï¼Œå¯ä»¥è®¿é—®https://registry.npmjs.org/vueï¼Œå°±ä¼šçœ‹åˆ° vue æ¨¡å—æ‰€æœ‰ç‰ˆæœ¬çš„ä¿¡æ¯ã€‚æ¨¡å—ååé¢ï¼Œè¿˜å¯ä»¥è·Ÿä¸Šç‰ˆæœ¬å·æˆ–è€…æ ‡ç­¾ï¼Œç”¨æ¥æŸ¥è¯¢æŸä¸ªå…·ä½“ç‰ˆæœ¬çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼šhttps://registry.npmjs.org/vue/3.0.0 æŸ¥çœ‹ vue 3.0.0 ç‰ˆæœ¬çš„ä¿¡æ¯å…·ä½“ç”¨æ³•å°±æ˜¯ï¼Œhttps://registry.npmjs.org/æ¨¡å—å/ç‰ˆæœ¬å·::: yarnyarn æ˜¯ Facebook 2017 å¹´æ¨å‡ºçš„å’Œ npm åŠŸèƒ½ç±»ä¼¼çš„åŒ…ç®¡ç†å·¥å…·ï¼Œä¸»è¦è§£å†³å½“æ—¶ npm çš„å‡ ä¸ªæ ¸å¿ƒé—®é¢˜ å®‰è£…åŒ…ä¸å¤Ÿå¿«é€Ÿä¸ç¨³å®š å­˜åœ¨å®‰å…¨éšæ‚£ åŒæ—¶ yarn çš„ cli å·¥å…·æä¾›äº†æ›´ç®€å•çš„å‘½ä»¤ï¼Œå½“ç„¶é¢å¯¹ yarn å¸¦æ¥çš„å‹åŠ›ï¼Œnpm åœ¨ 5.0 åæä¾›äº†ç±»ä¼¼çš„æ”¹è¿›ï¼Œä¸¤è€…ç°åœ¨å·®è·ä¸å†å·¨å¤§ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®ä¸ªäººä¹ æƒ¯å’Œé¡¹ç›®è§„èŒƒè‡ªç”±é€‰æ‹©ï¼ˆæˆ‘ä¸ªäººæ›´å–œæ¬¢ä½¿ç”¨ yarnï¼‰ npxnpm ä»5.2ç‰ˆæœ¬å¼€å§‹ï¼Œå¢åŠ äº† npx å‘½ä»¤ï¼Œnpx æƒ³è¦è§£å†³çš„ä¸»è¦é—®é¢˜ï¼Œå°±æ˜¯è°ƒç”¨é¡¹ç›®å†…éƒ¨å®‰è£…çš„æ¨¡å—ã€‚åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯è¿è¡Œçš„æ—¶å€™ï¼Œä¼šåˆ°node_modules/.binè·¯å¾„å’Œç¯å¢ƒå˜é‡$PATHé‡Œé¢ï¼Œæ£€æŸ¥å‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼›å¦‚æœå­˜åœ¨ï¼Œåˆ™æ‰§è¡Œï¼›ä¸å­˜åœ¨ï¼Œåˆ™è¿›è¡Œä¸´æ—¶å®‰è£…ï¼Œç„¶åæ‰§è¡Œï¼Œæ‰§è¡Œå®Œæ¯•åå°†åŒ…åˆ é™¤ã€‚ å¯¹ npx çš„è¯¦ç»†ä»‹ç»è§npxä½¿ç”¨æ•™ç¨‹ package.jsonnpm é€šè¿‡ Node.js æ¨¡å—æ ¹ç›®å½•çš„ package.json æ–‡ä»¶è·å–æ¨¡å—å…ƒæ•°æ®å’Œä¾èµ–å…³ç³»ç­‰ï¼Œä¾‹å¦‚react çš„ package.json åŒ…å«å¦‚ä¸‹ä¿¡æ¯:::infoå¯ä»¥é€šè¿‡npm init -yæˆ–è€…yarn init -yç”Ÿæˆä¸€ä»½é»˜è®¤çš„ package.json é…ç½®::: react çš„ package.json123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&#123; &quot;name&quot;: &quot;react&quot;, &quot;description&quot;: &quot;React is a JavaScript library for building user interfaces.&quot;, &quot;keywords&quot;: [ &quot;react&quot; ], &quot;version&quot;: &quot;17.0.3&quot;, &quot;homepage&quot;: &quot;https://reactjs.org/&quot;, &quot;bugs&quot;: &quot;https://github.com/facebook/react/issues&quot;, &quot;license&quot;: &quot;MIT&quot;, &quot;files&quot;: [ &quot;LICENSE&quot;, &quot;README.md&quot;, &quot;build-info.json&quot;, &quot;index.js&quot;, &quot;cjs/&quot;, &quot;umd/&quot;, &quot;jsx-runtime.js&quot;, &quot;jsx-dev-runtime.js&quot;, &quot;unstable-shared-subset.js&quot; ], &quot;main&quot;: &quot;index.js&quot;, &quot;exports&quot;: &#123; &quot;.&quot;: &#123; &quot;react-server&quot;: &quot;./unstable-shared-subset.js&quot;, &quot;default&quot;: &quot;./index.js&quot; &#125;, &quot;./index&quot;: &#123; &quot;react-server&quot;: &quot;./unstable-shared-subset.js&quot;, &quot;default&quot;: &quot;./index.js&quot; &#125;, &quot;./build-info.json&quot;: &quot;./build-info.json&quot;, &quot;./jsx-runtime&quot;: &quot;./jsx-runtime.js&quot;, &quot;./jsx-dev-runtime&quot;: &quot;./jsx-dev-runtime.js&quot;, &quot;./&quot;: &quot;./&quot; &#125;, &quot;repository&quot;: &#123; &quot;type&quot;: &quot;git&quot;, &quot;url&quot;: &quot;https://github.com/facebook/react.git&quot;, &quot;directory&quot;: &quot;packages/react&quot; &#125;, &quot;engines&quot;: &#123; &quot;node&quot;: &quot;&gt;=0.10.0&quot; &#125;, &quot;dependencies&quot;: &#123; &quot;loose-envify&quot;: &quot;^1.1.0&quot;, &quot;object-assign&quot;: &quot;^4.1.1&quot; &#125;, &quot;browserify&quot;: &#123; &quot;transform&quot;: [ &quot;loose-envify&quot; ] &#125;&#125; namename æ˜¯æ¨¡å—çš„å”¯ä¸€æ ‡è¯†ï¼Œå®‰è£…ã€ä½¿ç”¨æ¨¡å—éƒ½éœ€è¦ä½¿ç”¨æ¨¡å—çš„ nameï¼Œå¯ä»¥ä½¿ç”¨å­—æ¯ï¼ˆåªèƒ½ä½¿ç”¨å°å†™å­—æ¯ï¼‰ã€æ•°å­—ã€_ã€-å’Œ.ï¼Œä¾‹å¦‚å®‰è£…å’Œä½¿ç”¨ vue éœ€è¦ç”¨åˆ°å¦‚ä¸‹å‘½ä»¤ 1yarn add vue 1import &#123;inject, Ref&#125; from &#x27;vue&#x27; å¯ä»¥é€šè¿‡ scope ç»„ç»‡å…·æœ‰ç›¸å…³æ€§çš„æ¨¡å—ï¼Œæ¨¡å—åä¹‰@å¼€å¤´çš„åŒ…å°±æ˜¯ä¸€ä¸ª scoped packageï¼Œscope å°±æ˜¯@å’Œ/ä¹‹é—´çš„å†…å®¹ 1@scope/project-name ä¾‹å¦‚@antv&#x2F;g2plot versionç‰ˆæœ¬å·éµä»è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒï¼Œä½¿ç”¨x.y.zå½¢å¼ï¼Œå¯¹åº”ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢ç‰ˆæœ¬ ï¼Œç‰ˆæœ¬å·é€’å¢è§„åˆ™å¦‚ä¸‹ï¼š ä¸»ç‰ˆæœ¬ï¼ˆmajorï¼‰ï¼šå½“ä½ åšäº†ä¸å…¼å®¹çš„ API ä¿®æ”¹ï¼Œä¸€èˆ¬æ”¹åŠ¨å¾ˆå¤§ï¼Œä¸å…¼å®¹ä½ç‰ˆæœ¬ æ¬¡ç‰ˆæœ¬ï¼ˆminorï¼‰ï¼šå½“ä½ åšäº†å‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢ï¼Œå…¼å®¹åŒä¸€ä¸ªå¤§ç‰ˆæœ¬çš„ API å’Œç”¨æ³• ä¿®è®¢ç‰ˆæœ¬ï¼ˆpatchï¼‰ï¼šå½“ä½ åšäº†å‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£ï¼Œä¸€èˆ¬ç”¨æ¥ä¿®å¤ bug å…ˆè¡Œç‰ˆæœ¬x.y.zæ ¼å¼æ˜¯æ¨¡å—æ­£å¼ç‰ˆæœ¬ï¼Œé‡è¦æ¨¡å—ä¸ºäº†ä¿è¯ç¨³å®šï¼Œä¼šåœ¨æ”¾å‡ºæ­£å¼ç‰ˆæœ¬ä¹‹å‰æä¾›å…ˆè¡Œç‰ˆæœ¬ alpha: å†…éƒ¨ç‰ˆæœ¬ beta: å…¬æµ‹ç‰ˆæœ¬ rc: Release candidateï¼Œæ­£å¼ç‰ˆæœ¬çš„å€™é€‰ç‰ˆæœ¬ stable: ç¨³å®šç‰ˆ csp ä¾‹ï¼šnpm ä¸Š vue éƒ¨åˆ†ç‰ˆæœ¬è®°å½• è¿™ç§ç‰¹æ®Šç‰ˆæœ¬é™¤éå¼€å‘è€…&#x3D;&#x3D;ç²¾ç¡®å£°æ˜ä½¿ç”¨&#x3D;&#x3D;ï¼Œä¾‹å¦‚npm install vue@3.0.0-rc.13ï¼Œå¦åˆ™npm installä¸ä¼šè‡ªåŠ¨å®‰è£…å¯¹åº”ç‰ˆæœ¬å†…å®¹ å¿«æ·å‘½ä»¤npm æä¾›äº†å¿«æ·å‡çº§å‘½ä»¤ å‡çº§ä¸»ç‰ˆæœ¬å·ï¼šnpm version major å‡çº§æ¬¡ç‰ˆæœ¬å·ï¼šnpm version minor å‡çº§ä¿®è®¢ç‰ˆæœ¬å·ï¼šnpm version patch è®¾ç½®ç‰ˆæœ¬å·ä¸ºæŒ‡å®šçš„ç‰ˆæœ¬å·ï¼šnpm version ç‰ˆæœ¬å· å‡çº§å…ˆè¡Œç‰ˆæœ¬å·ï¼šnpm version prerelease å‡çº§å…ˆè¡Œç‰ˆæœ¬å·å¹¶æŒ‡å®šå…ˆè¡Œç‰ˆæœ¬çš„åå­—ï¼šnpm version prerelease --preid=&lt;prerelease-id&gt; ç¤ºä¾‹ï¼š 1234567# å‡å®šç°åœ¨çš„ç‰ˆæœ¬å·æ˜¯1.1.1npm version major # 2.0.0npm version minor # 1.2.0npm version patch # 1.1.2npm version prerelease # 1.1.2-0npm version prerelease --preid=alpha # 1.1.2-alpha.0npm version 4.1.2 # 4.1.2 :::infoæ‰§è¡Œnpm versionä¿®æ”¹å®Œç‰ˆæœ¬å·ä¹‹åï¼Œè¿˜ä¼šé»˜è®¤æ‰§è¡Œ git add -&gt; git commit -&gt; git tag æ“ä½œï¼Œcommit çš„ä¿¡æ¯å’Œä¸º tag å‡ä¸ºç‰ˆæœ¬å·ï¼Œä¸”è¯¥æ­¥éª¤åº”åœ¨npm publishä¹‹å‰è¿›è¡Œã€‚::: tagnpm ä¸­çš„ tag ç±»ä¼¼äº git ä¸­çš„ branch ï¼Œå‘å¸ƒè€…å¯ä»¥åœ¨æŒ‡å®šçš„ tag ä¸Šè¿›è¡Œå‘ç‰ˆï¼Œä½¿ç”¨è€…å¯ä»¥é€‰æ‹©æŒ‡å®š tag æ¥å®‰è£…ï¼Œé»˜è®¤çš„ tag æ˜¯latestã€‚è¿™å¯¹äºæˆ‘ä»¬æ—¥å¸¸å¼€å‘éå¸¸æœ‰ç”¨ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬æƒ³è¦å‘å¸ƒç‰ˆæœ¬æ¥è¿›è¡ŒéªŒè¯åŠŸèƒ½ï¼Œä½†æ˜¯åˆä¸æƒ³å½±å“æ­£åœ¨ä½¿ç”¨çš„äººï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ tag å’Œå…ˆè¡Œç‰ˆæœ¬æ¥è¿›è¡Œå‘åŒ…ã€‚ 12npm publish --tag alpha # å‘ç‰ˆåˆ°åä¸º alpha çš„ tag ä¸Šnpm i &lt;package&gt;@&lt;tag&gt; # ä»æŒ‡å®š tag ä¸Šå®‰è£…åŒ… dependencies &amp; devDependenciesdependencies å’Œ devDependencies å­—æ®µç”¨æ¥è¡¨ç¤ºæ¨¡å—çš„ä¾èµ–å’Œå¼€å‘ç¯å¢ƒä¾èµ–ï¼Œæ¨¡å—ä¾èµ–çš„ç‰ˆæœ¬å·æœ‰äº›å‡ ç§ä¸åŒå†™æ³•ï¼Œæ¥ä¿è¯å®‰è£…çš„æ—¶å€™ä½¿ç”¨å¯¹åº”çš„ç‰ˆæœ¬ x.y.z ä½¿ç”¨ç²¾ç¡®ç‰ˆæœ¬å· * ä»»æ„ç‰ˆæœ¬ï¼Œç¬¬ä¸€æ¬¡å®‰è£…ä¼šä½¿ç”¨æ¨¡å—æœ€æ–°ç‰ˆæœ¬ ^x.y.z x ä½é”æ­»ï¼Œyã€z ä½ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ 3.xå’Œ^3.0.0å«ä¹‰ç›¸åŒï¼Œx ä½ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬ï¼Œyã€z ä½ä½¿ç”¨æœ€æ–° ~x.y.z xã€y é”å®šï¼Œz ä½ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ npm æä¾›äº†å¿«æ·å‘½ä»¤ï¼Œå¯ä»¥åœ¨å®‰è£…çš„æ—¶å€™å°±è‡ªåŠ¨æŠŠå¯¹åº”å†…å®¹å†™åˆ° package.json ä¸­ 12npm install &lt;package_name&gt; --save # å®‰è£…æ¨¡å—å¹¶å†™å…¥ dependenciesnpm install &lt;package_name&gt; --save-dev # å®‰è£…æ¨¡å—å¹¶å†™å…¥ devDependencies peerDependenciesæœ‰æ—¶å€™æ¨¡å—éœ€è¦ä¸å®¿ä¸»æ¨¡å—å…±äº«ä¾èµ–ï¼Œä¹Ÿå°±æ˜¯æœ‰å¯èƒ½ä¼šç”¨åˆ°æŸä¸ªæ¨¡å—ï¼Œä½†è‡ªå·±ä¸å®‰è£…ï¼Œå¸Œæœ›å®¿ä¸»ç¯å¢ƒå®‰è£…çš„æ—¶å€™ä½¿ç”¨ peerDependencies å£°æ˜ï¼Œæ¯”å¦‚ react-dom çš„ package.json çš„ä½¿ç”¨ 12345678&quot;dependencies&quot;: &#123; &quot;loose-envify&quot;: &quot;^1.1.0&quot;, &quot;object-assign&quot;: &quot;^4.1.1&quot;, &quot;scheduler&quot;: &quot;^0.20.1&quot;&#125;,&quot;peerDependencies&quot;: &#123; &quot;react&quot;: &quot;17.0.3&quot;&#125; repositoryrepository ç”¨æ¥æŒ‡å®šæ¨¡å—æºä»£ç ä¿¡æ¯ 12345&quot;repository&quot;: &#123; &quot;type&quot;: &quot;git&quot;, &quot;url&quot;: &quot;https://github.com/facebook/react.git&quot;, &quot;directory&quot;: &quot;packages/react&quot;&#125; main å­—æ®µmain å­—æ®µç”¨æ¥æ ‡è¯†æ¨¡å—çš„é»˜è®¤å…¥å£æ–‡ä»¶ï¼Œæ¯”å¦‚ react main: &quot;index.js&quot; ï¼Œä¸‹é¢ä¸¤å¥å†™æ³•å«ä¹‰ç›¸åŒ 12const react = require(&#x27;react&#x27;);const react = require(&#x27;react/index.js&#x27;); å‘å¸ƒ package åœ¨ npmjs.com ä¸Šæ³¨å†Œè´¦å· åœ¨++å‘½ä»¤è¡Œ++{.dot}ä½¿ç”¨npm loginç™»å½• ä½¿ç”¨npm publishè¿›è¡Œå‘å¸ƒ :::warningåœ¨è¿›è¡Œnpm publishæ“ä½œå‰ï¼Œè¯·ç¡®è®¤ä½¿ç”¨çš„æ˜¯ npm å®˜æ–¹æºï¼Œå¦‚æœå½“å‰ä½¿ç”¨çš„æ˜¯éå®˜æ–¹æºï¼Œå¯ä»¥ä½¿ç”¨npm config set registry https://registry.npmjs.orgæˆ–è€…nrmåˆ‡æ¢è‡³ npm å®˜æ–¹æº:::","tags":["npm","package.json"],"categories":["å­¦ä¹ ç¬”è®°"]},{"title":"Google æœç´¢æŠ€å·§","path":"/2021/03/01/google-search-skills/","content":"ä½¿ç”¨å¼•å·å¼ºåˆ¶è¿›è¡Œç²¾ç¡®åŒ¹é…æœç´¢:::default no-iconâ€œwhat is javascriptâ€::: ANDè¿ç®—ç¬¦å°†åªè¿”å›ä¸è¿™ä¸¤ä¸ªæœ¯è¯­ç›¸å…³çš„ç»“æœ:::default no-iconhtml AND css::: ä½¿ç”¨ORè¿ç®—ç¬¦è·å–ä¸å…¶ä¸­ä¸€ä¸ªæœç´¢è¯ç›¸å…³çš„ç»“æœ:::default no-icon(javascript OR python) free courseæˆ–è€…(javascript | python) free course::: search_skill_03 -è¿ç®—ç¬¦å°†æ’é™¤åŒ…å«ä»¥ä¸‹æœ¯è¯­æˆ–çŸ­è¯­çš„ç»“æœ:::default no-iconjavascript -css::: search_skill_04 ä½¿ç”¨*é€šé…ç¬¦ä½œä¸ºå ä½ç¬¦ï¼Œå®ƒå°†è¢«ä»»ä½•å•è¯æˆ–çŸ­è¯­æ›¿æ¢:::default no-iconâ€œhow to start * in 6 monthsâ€::: search_skill_05 åœ¨å•ä¸ªç½‘ç«™å†…æœç´¢:::default no-iconsite:freecodecamp.org::: search_skill_06 ä¹Ÿå¯ä»¥ç”¨site:æ¥é™åˆ¶æœç´¢ç»“æœçš„é¡¶çº§åŸŸï¼Œä¾‹å¦‚.comã€.eduã€.org search_skill_06 æŸ¥æ‰¾ç‰¹å®šçš„æ–‡ä»¶ç±»å‹:::default no-iconfiletype:pdf learn cssæˆ–è€…ext:pdf learn css::: search_skill_07 æœç´¢ä¸€ä¸ªæ•°å­—èŒƒå›´:::default no-iconecmascript 2016..2018::: search_skill_08","tags":["Google æœç´¢æŠ€å·§"],"categories":["å…¶ä»–"]},{"title":"æµ…æå‰ç«¯è·¯ç”±","path":"/2021/02/22/frontend-routing/","content":"ä»€ä¹ˆæ˜¯å‰ç«¯è·¯ç”±ç”¨æœ€ç®€å•çš„è¯æ¥è¯´å°±æ˜¯ï¼Œé¡µé¢é—´çš„è·³è½¬ä»…ç”±å‰ç«¯æ¥æ§åˆ¶ï¼Œè€Œä¸éœ€è¦å‘åç«¯å‘èµ·è¯·æ±‚ã€‚å‰ç«¯è·¯ç”±åæ˜ çš„æ˜¯URLå’Œç»„ä»¶ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚ å‰ç«¯è·¯ç”±åæ˜ çš„æ˜¯ URL å’Œç»„ä»¶ä¹‹é—´çš„æ˜ å°„å…³ç³» route_01 å¦‚ä½•å®ç°å‰ç«¯è·¯ç”±vue-router ä¸­æœ‰ 3 ç§è·¯ç”±æ¨¡å¼ï¼šhashã€historyã€abstractï¼ˆä¸å¸¸ç”¨ï¼‰ï¼Œè¿™é‡Œä»…ä»‹ç»ä¸‹ hash æ¨¡å¼å’Œ history æ¨¡å¼çš„ç®€å•å®ç° hash æ¨¡å¼æ—©æœŸçš„å‰ç«¯è·¯ç”±çš„å®ç°å°±æ˜¯åŸºäº location.hash æ¥å®ç°çš„ã€‚å®ç°åŸç†å¾ˆç®€å•ï¼Œlocation.hash çš„å€¼å°±æ˜¯ URL ä¸­ # åé¢çš„å†…å®¹ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªç½‘ç«™ï¼Œå®ƒçš„ location.hash çš„å€¼ä¸º â€˜#firstâ€™ã€‚ 1http://www.example.com#first hash è·¯ç”±æ¨¡å¼çš„å®ç°ä¸»è¦åŸºäºä¸‹é¢å‡ ä¸ªç‰¹æ€§ï¼š URL ä¸­ hash å€¼åªæ˜¯å®¢æˆ·ç«¯çš„ä¸€ç§çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´å½“å‘æœåŠ¡å™¨ç«¯å‘å‡ºè¯·æ±‚æ—¶ï¼Œ&#x3D;&#x3D;hash éƒ¨åˆ†å¹¶ä¸ä¼šè¢«å‘é€&#x3D;&#x3D;ï¼› hash å€¼çš„ä»»æ„æ”¹å˜ï¼Œéƒ½ä¼šåœ¨æµè§ˆå™¨çš„è®¿é—®å†å²ä¸­å¢åŠ ä¸€ä¸ªè®°å½•ã€‚å› æ­¤æˆ‘ä»¬èƒ½é€šè¿‡&#x3D;&#x3D;æµè§ˆå™¨çš„å›é€€ã€å‰è¿›æŒ‰é’®&#x3D;&#x3D;æ¥æ§åˆ¶ hash çš„åˆ‡æ¢ï¼› é€šè¿‡&#x3D;&#x3D;è®¾ç½®Â aÂ æ ‡ç­¾çš„Â hrefÂ å±æ€§&#x3D;&#x3D;ï¼Œå½“ç”¨æˆ·ç‚¹å‡»è¿™ä¸ªæ ‡ç­¾åï¼ŒURLÂ çš„ hash å€¼ä¼šå‘ç”Ÿæ”¹å˜ï¼›æˆ–è€…ç›´æ¥&#x3D;&#x3D;å¯¹Â loaction.hashÂ è¿›è¡Œèµ‹å€¼&#x3D;&#x3D;ï¼Œæ”¹å˜ URL çš„ hash å€¼ï¼› é€šè¿‡æµè§ˆå™¨åŸç”Ÿçš„hashchangeäº‹ä»¶æ¥++ç›‘å¬ hash å€¼çš„å˜åŒ–++{.dot .warning}ï¼Œä»è€Œå¯¹é¡µé¢è¿›è¡Œè·³è½¬ï¼ˆæ¸²æŸ“ï¼‰ã€‚ 1234567891011121314151617181920212223242526272829303132333435&lt;ul&gt; &lt;li&gt;&lt;a href=&quot;#/page1&quot;&gt;page1&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;#/page2&quot;&gt;page2&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;!--æ¸²æŸ“å¯¹åº”ç»„ä»¶çš„åœ°æ–¹--&gt;&lt;div id=&quot;route-view&quot;&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt; // ç¬¬ä¸€æ¬¡åŠ è½½çš„æ—¶å€™ï¼Œä¸ä¼šæ‰§è¡Œ hashchange ç›‘å¬äº‹ä»¶ï¼Œé»˜è®¤æ‰§è¡Œä¸€æ¬¡ // DOMContentLoaded ä¸ºæµè§ˆå™¨ DOM åŠ è½½å®Œæˆæ—¶è§¦å‘ window.addEventListener(&#x27;DOMContentLoaded&#x27;, Load) window.addEventListener(&#x27;hashchange&#x27;, HashChange) // å±•ç¤ºé¡µé¢ç»„ä»¶çš„èŠ‚ç‚¹ var routeView = null function Load() &#123; routeView = document.getElementById(&#x27;route-view&#x27;) HashChange() &#125; function HashChange() &#123; // æ¯æ¬¡è§¦å‘ hashchange äº‹ä»¶ï¼Œé€šè¿‡ location.hash æ‹¿åˆ°å½“å‰æµè§ˆå™¨åœ°å€çš„ hash å€¼ // æ ¹æ®ä¸åŒçš„è·¯å¾„å±•ç¤ºä¸åŒçš„å†…å®¹ switch(location.hash) &#123; case &#x27;#/page1&#x27;: routeView.innerHTML = &#x27;page1&#x27; return case &#x27;#/page2&#x27;: routeView.innerHTML = &#x27;page2&#x27; return default: routeView.innerHTML = &#x27;page1&#x27; return &#125; &#125;&lt;/script&gt; :::infoè¿™ä»…æ˜¯æœ€ç®€æ˜“çš„å®ç°ï¼ŒçœŸå®çš„ hash æ¨¡å¼ï¼Œè¿˜è¦è€ƒè™‘åˆ°å¾ˆå¤šå¤æ‚çš„æƒ…å†µï¼Œå…·ä½“æƒ…å†µå¯ä»¥å»çœ‹ Vue Router çš„æºç ã€‚::: history æ¨¡å¼history æ¨¡å¼çš„å®ç°åŸºäº HTML5 æä¾›çš„ History APIï¼Œå…¶ä¸­æœ€ä¸»è¦çš„ API ä¸ºï¼šhistory.pushState()å’Œhistory.repalceState()ã€‚è¿™ä¸¤ä¸ª API å‡å¯åœ¨ä¸åˆ·æ–°é¡µé¢çš„æƒ…å†µä¸‹ï¼Œå¯¹æµè§ˆå™¨çš„å†å²çºªå½•è¿›è¡Œæ“ä½œã€‚å”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå‰è€…æ˜¯æ–°å¢ä¸€ä¸ªå†å²è®°å½•ï¼Œåè€…æ˜¯ç›´æ¥æ›¿æ¢å½“å‰çš„å†å²è®°å½•ã€‚ history è·¯ç”±æ¨¡å¼çš„å®ç°ä¸»è¦åŸºäºä¸‹é¢å‡ ä¸ªç‰¹æ€§ï¼š é€šè¿‡ pushState å’Œ repalceState è¿™ä¸¤ä¸ª API æ¥æ“ä½œå®ç° URL çš„å˜åŒ–ï¼ˆå®é™…ä¸Šæ˜¯æ”¹å˜äº†æµè§ˆå™¨çš„location.pathnameå±æ€§å€¼ï¼‰ ï¼› é€šè¿‡æµè§ˆå™¨åŸç”Ÿçš„popstateäº‹ä»¶æ¥&#x3D;&#x3D;ç›‘å¬æµè§ˆå™¨åŠ¨ä½œçš„å˜åŒ–&#x3D;&#x3D;ï¼Œä»è€Œå¯¹é¡µé¢è¿›è¡Œè·³è½¬ï¼ˆæ¸²æŸ“ï¼‰ï¼› ä½†history.pushState()æˆ–history.replaceState()åªèƒ½æ”¹å˜ URLï¼Œå¹¶ä¸ä¼šè§¦å‘ popstate äº‹ä»¶ï¼Œéœ€è¦&#x3D;&#x3D;æ‰‹åŠ¨è§¦å‘é¡µé¢è·³è½¬ï¼ˆæ¸²æŸ“ï¼‰&#x3D;&#x3D;ã€‚ :::infoéœ€è¦æ³¨æ„çš„æ˜¯è°ƒç”¨history.pushState()æˆ–history.replaceState()ä¸ä¼šè§¦å‘popstateäº‹ä»¶ã€‚åªæœ‰åœ¨åšå‡ºæµè§ˆå™¨åŠ¨ä½œæ—¶ï¼Œæ‰ä¼šè§¦å‘è¯¥äº‹ä»¶ï¼Œå¦‚ç”¨æˆ·ç‚¹å‡»æµè§ˆå™¨çš„å›é€€æŒ‰é’®ï¼ˆæˆ–è€…åœ¨ Javascript ä»£ç ä¸­è°ƒç”¨history.back()æˆ–è€…history.forward()æ–¹æ³•ï¼‰ï¼ˆæ‘˜è‡ª MDN å¯¹ popstate çš„è§£é‡Šï¼‰::: 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;ul&gt; &lt;li&gt;&lt;a href=&quot;/page1&quot;&gt;page1&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;/page2&quot;&gt;page2&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div id=&quot;route-view&quot;&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt; window.addEventListener(&#x27;DOMContentLoaded&#x27;, Load) window.addEventListener(&#x27;popstate&#x27;, PopChange) var routeView = null function Load() &#123; routeView = document.getElementById(&#x27;route-view&#x27;) // é»˜è®¤æ‰§è¡Œä¸€æ¬¡ popstate çš„å›è°ƒå‡½æ•°ï¼ŒåŒ¹é…ä¸€æ¬¡é¡µé¢ç»„ä»¶ PopChange() // è·å–æ‰€æœ‰å¸¦ href å±æ€§çš„ a æ ‡ç­¾èŠ‚ç‚¹ var aList = document.querySelectorAll(&#x27;a[href]&#x27;) // éå† a æ ‡ç­¾èŠ‚ç‚¹æ•°ç»„ï¼Œé˜»æ­¢é»˜è®¤äº‹ä»¶ï¼Œæ·»åŠ ç‚¹å‡»äº‹ä»¶å›è°ƒå‡½æ•° aList.forEach(aNode =&gt; aNode.addEventListener(&#x27;click&#x27;, function(e) &#123; e.preventDefault() //é˜»æ­¢aæ ‡ç­¾çš„é»˜è®¤äº‹ä»¶ var href = aNode.getAttribute(&#x27;href&#x27;) // æ‰‹åŠ¨ä¿®æ”¹æµè§ˆå™¨çš„åœ°å€æ  history.pushState(null, &#x27;&#x27;, href) // é€šè¿‡ history.pushState æ‰‹åŠ¨ä¿®æ”¹åœ°å€æ ï¼Œ // popstate æ˜¯ç›‘å¬ä¸åˆ°åœ°å€æ çš„å˜åŒ–ï¼Œæ‰€ä»¥æ­¤å¤„éœ€è¦æ‰‹åŠ¨æ‰§è¡Œå›è°ƒå‡½æ•° PopChange PopChange() &#125;)) &#125; function PopChange() &#123; console.log(&#x27;location&#x27;, location) switch(location.pathname) &#123; case &#x27;/page1&#x27;: routeView.innerHTML = &#x27;page1&#x27; return case &#x27;/page2&#x27;: routeView.innerHTML = &#x27;page2&#x27; return default: routeView.innerHTML = &#x27;page1&#x27; return &#125; &#125;&lt;/script&gt; ä»¥ä¸Šä»£ç çš„æ€è·¯ï¼šé€šè¿‡éå†é¡µé¢ä¸Šçš„æ‰€æœ‰ a æ ‡ç­¾ï¼Œé˜»æ­¢ aÂ æ ‡ç­¾çš„é»˜è®¤äº‹ä»¶çš„åŒæ—¶ï¼ŒåŠ ä¸Šç‚¹å‡»äº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œåœ¨å›è°ƒå‡½æ•°å†…è·å– a æ ‡ç­¾çš„ hrefÂ å±æ€§å€¼ï¼Œå†é€šè¿‡ pushState å»æ”¹å˜æµè§ˆå™¨çš„ location.pathname å±æ€§å€¼ã€‚ç„¶åæ‰‹åŠ¨æ‰§è¡Œ popstate äº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œå»åŒ¹é…ç›¸åº”çš„è·¯ç”±ã€‚ :::warningè¿™é‡Œæ³¨æ„ï¼Œä»¥ä¸Šä»£ç ä¸èƒ½åœ¨æµè§ˆå™¨ç›´æ¥æ‰“å¼€é™æ€æ–‡ä»¶ï¼ˆä¼šæŠ¥é”™ï¼‰ï¼Œéœ€è¦é€šè¿‡ web æœåŠ¡ï¼Œå¯åŠ¨ç«¯å£å»æµè§ˆç½‘å€ã€‚::: å•é¡µé¢åº”ç”¨ v.s. å¤šé¡µé¢åº”ç”¨å¯¹å‰ç«¯æ¥è¯´ï¼Œè·¯ç”±æ¦‚å¿µçš„å‡ºç°æ˜¯ä¼´éšç€SPAå‡ºç°çš„ï¼›åœ¨SPAå‡ºç°ä¹‹å‰ï¼Œé¡µé¢çš„è·³è½¬(å¯¼èˆª)éƒ½æ˜¯é€šè¿‡æœåŠ¡ç«¯æ¥æ§åˆ¶çš„ï¼Œå¹¶ä¸”é¡µé¢è·³è½¬å­˜åœ¨ä¸€ä¸ªæ˜æ˜¾ç™½å±è·³è½¬è¿‡ç¨‹ï¼›SPAå‡ºç°åï¼Œç”¨æˆ·ä½“éªŒå¥½ã€å¿«ï¼Œå†…å®¹çš„æ”¹å˜ä¸éœ€è¦é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ï¼Œé¿å…äº†ä¸å¿…è¦çš„è·³è½¬å’Œé‡å¤æ¸²æŸ“ï¼Œå°±ä¸å†è®©æœåŠ¡ç«¯æ§åˆ¶é¡µé¢è·³è½¬äº†ï¼Œäºæ˜¯å‰ç«¯è·¯ç”±å‡ºç°äº†ï¼Œå‰ç«¯å¯ä»¥è‡ªç”±æ§åˆ¶ç»„ä»¶çš„æ¸²æŸ“ï¼Œæ¥æ¨¡æ‹Ÿé¡µé¢è·³è½¬ã€‚ å•é¡µé¢åº”ç”¨å’Œå¤šé¡µé¢åº”ç”¨çš„å¯¹æ¯”å¦‚ä¸‹ï¼š å•é¡µé¢åº”ç”¨ï¼ˆSinglePage Web Applicationï¼ŒSPAï¼‰ å¤šé¡µé¢åº”ç”¨ï¼ˆMultiPage Applicationï¼ŒMPAï¼‰ ç»„æˆ ä¸€ä¸ªå¤–å£³é¡µé¢å’Œå¤šä¸ªé¡µé¢ç‰‡æ®µç»„æˆ å¤šä¸ªå®Œæ•´é¡µé¢æ„æˆ èµ„æºå…±ç”¨ï¼ˆcssï¼Œjsï¼‰ å…±ç”¨ï¼Œåªéœ€åœ¨å¤–å£³éƒ¨åˆ†åŠ è½½ ä¸å…±ç”¨ï¼Œæ¯ä¸ªé¡µé¢éƒ½éœ€è¦åŠ è½½ åˆ·æ–°æ–¹å¼ é¡µé¢å±€éƒ¨åˆ·æ–°æˆ–æ›´æ”¹ æ•´é¡µåˆ·æ–° URL æ¨¡å¼ xxx.com/#/firstxxx.com/#/second xxx.com/#/first.htmlxxx.com/#/second.html ç”¨æˆ·ä½“éªŒ é¡µé¢ç‰‡æ®µé—´åˆ‡æ¢å¿«ï¼Œç”¨æˆ·ä½“éªŒå¥½ é¡µé¢åˆ‡æ¢åŠ è½½ç¼“æ…¢ï¼Œæµç•…åº¦ä¸å¤Ÿï¼Œç”¨æˆ·ä½“éªŒè¾ƒå·® è½¬åœºåŠ¨ç”» å®¹æ˜“å®ç° æ— æ³•å®ç° æ•°æ®ä¼ é€’ å®¹æ˜“ ä¾èµ– URL ä¼ å‚ï¼Œæˆ–è€… cookieã€localStorage ç­‰ æœç´¢å¼•æ“ä¼˜åŒ–ï¼ˆSEOï¼‰ éœ€è¦å•ç‹¬æ–¹æ¡ˆã€å®ç°è¾ƒä¸ºå›°éš¾ã€ä¸åˆ©äºSEOæ£€ç´¢ã€å¯åˆ©ç”¨æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰ä¼˜åŒ– å®¹æ˜“å®ç° ä½¿ç”¨èŒƒå›´ é«˜è¦æ±‚çš„ä½“éªŒåº¦ã€è¿½æ±‚ç•Œé¢æµç•…çš„åº”ç”¨ï¼ˆä¸€èˆ¬æ˜¯åå°ç®¡ç†ç³»ç»Ÿï¼‰ é€‚ç”¨äºè¿½æ±‚é«˜åº¦æ”¯æŒæœç´¢å¼•æ“çš„åº”ç”¨ ç»´æŠ¤æˆæœ¬ ç›¸å¯¹å®¹æ˜“ ç›¸å¯¹å¤æ‚","tags":["å‰ç«¯è·¯ç”±"],"categories":["å­¦ä¹ ç¬”è®°"]},{"title":"Vue ä¸¤ä¸ªç‰ˆæœ¬çš„åŒºåˆ«ï¼ˆå®Œæ•´ç‰ˆ v.s. è¿è¡Œæ—¶ç‰ˆï¼‰","path":"/2020/06/30/vue-difference-version/","content":"ä½¿ç”¨ Vue å®ä¾‹çš„ä¸‰ç§æ–¹å¼ æ–¹æ³•ä¸€ï¼šä» HTML å¾—åˆ°è§†å›¾ ä½¿ç”¨ã€Œå®Œæ•´ç‰ˆ Vueã€ é€šè¿‡ cdn æˆ– import æ¥å¼•å…¥ vue.js æˆ–è€… vue.min.js å°†è§†å›¾å†™åœ¨ HTML ä¸­æˆ–è€…å†™åœ¨ template é€‰é¡¹ä¸­ æ–¹æ³•äºŒï¼šç”¨ JS æ¥æ„å»ºè§†å›¾ ä½¿ç”¨ã€Œéå®Œæ•´ç‰ˆ Vueã€ é€šè¿‡ cdn æˆ– import æ¥å¼•å…¥ vue.runtime.js æˆ–è€… vue.runtime.min.js ä½¿ç”¨ render å‡½æ•° æ–¹æ³•ä¸‰ï¼šä½¿ç”¨ vue-loaderï¼ˆwebpack çš„ä¸€ä¸ª loaderï¼‰ ä½¿ç”¨ã€Œéå®Œæ•´ç‰ˆ Vueã€ vue-loader å¯ä»¥æŠŠ *.vue æ–‡ä»¶ç¿»è¯‘æˆ h æ„å»ºæ–¹æ³• è¿™ç§åšæ³•çš„ç¼ºç‚¹æ˜¯ï¼ŒHTML å†…å°±åªæœ‰ä¸€ä¸ª div#appï¼Œå¯¹ SEO ä¸å‹å¥½ å®Œæ•´ç‰ˆï¼ˆè¿è¡Œæ—¶ + ç¼–è¯‘å™¨ï¼‰ v.s. éå®Œæ•´ç‰ˆï¼ˆåªåŒ…å«è¿è¡Œæ—¶ï¼‰å¯¹æ¯”å¦‚ä¸‹ï¼š Vue å®Œæ•´ç‰ˆ ï¼ˆè¿è¡Œæ—¶ + ç¼–è¯‘å™¨ï¼‰ Vue éå®Œæ•´ç‰ˆï¼ˆåªåŒ…å«è¿è¡Œæ—¶ï¼‰ è¯„ä»· ç‰¹ç‚¹ æœ‰ compiler æ²¡æœ‰ compiler compiler å  30% ä½“ç§¯ è§†å›¾ å†™åœ¨ HTML ä¸­æˆ–è€…å†™åœ¨ template é€‰é¡¹ä¸­ å†™åœ¨ render å‡½æ•°é‡Œç”¨ h æ¥åˆ›å»ºæ ‡ç­¾ h æ˜¯å°¤é›¨æºªå†™å¥½ä¼ ç»™ render çš„ cdn å¼•å…¥ vue.js vue.runtime.js æ–‡ä»¶åä¸åŒï¼Œç”Ÿäº§ç¯å¢ƒåç¼€ä¸º .min.js webpack å¼•å…¥ éœ€è¦é…ç½® alias é»˜è®¤ä½¿ç”¨æ­¤ç‰ˆ å°¤é›¨æºªé…ç½®çš„ @vue&#x2F;cli å¼•å…¥ éœ€è¦é¢å¤–é…ç½® é»˜è®¤ä½¿ç”¨æ­¤ç‰ˆ å°¤é›¨æºªã€è’‹è±ªç¾¤é…ç½®çš„ 1234567891011// éœ€è¦ç¼–è¯‘å™¨new Vue(&#123; template: &#x27;&lt;div&gt;&#123;&#123; hi &#125;&#125;&lt;/div&gt;&#x27;&#125;)// ä¸éœ€è¦ç¼–è¯‘å™¨new Vue(&#123; render (h) &#123; return h(&#x27;div&#x27;, this.hi) &#125;&#125;) å½“ä½¿ç”¨ vue-loader æˆ– vueify çš„æ—¶å€™ï¼Œ*.vue æ–‡ä»¶å†…éƒ¨çš„æ¨¡æ¿ä¼šåœ¨æ„å»ºæ—¶é¢„ç¼–è¯‘æˆ JavaScriptã€‚ä½ åœ¨æœ€ç»ˆæ‰“å¥½çš„åŒ…é‡Œå®é™…ä¸Šæ˜¯ä¸éœ€è¦ç¼–è¯‘å™¨çš„ï¼Œæ‰€ä»¥åªç”¨è¿è¡Œæ—¶ç‰ˆæœ¬å³å¯ã€‚ æœ€ä½³å®è·µï¼šæ€»æ˜¯ä½¿ç”¨éå®Œæ•´ç‰ˆï¼Œç„¶åé…åˆvue-loader å’Œ vue å•æ–‡ä»¶ç»„ä»¶ã€‚ Vue ä½œè€…çš„æ€è·¯ï¼š ä¸ºäº†ä¿è¯ç”¨æˆ·ä½“éªŒï¼Œè®©ç”¨æˆ·ä¸‹è½½çš„ JS æ–‡ä»¶ä½“ç§¯æ›´å°ï¼Œä½†åªæ”¯æŒ h å‡½æ•° ä¸ºäº†ä¿è¯å¼€å‘ä½“éªŒï¼Œè®©å¼€å‘è€…å¯ä»¥ç›´æ¥åœ¨ vue æ–‡ä»¶é‡Œå†™ HTML æ ‡ç­¾ï¼Œè€Œä¸å†™ h å‡½æ•° ç”±æ­¤å‘æ˜äº† vue-loaderï¼Œè„æ´»å„¿è®© loader æ¥åšï¼Œvue-loader æŠŠ vue æ–‡ä»¶é‡Œçš„ HTML è½¬ä¸º h å‡½æ•° SEO åŸºæœ¬åŸç† å…¨ç§°ï¼šSearch Engine Optimizationï¼Œä¸­æ–‡ï¼šæœç´¢å¼•æ“ä¼˜åŒ– ä½ å¯ä»¥è®¤ä¸ºæœç´¢å¼•æ“å°±æ˜¯åœ¨ä¸åœçš„å‘èµ· curl æœç´¢å¼•æ“æ ¹æ® curl çš„ç»“æœæ¥çŒœæµ‹é¡µé¢çš„å†…å®¹ å¦‚æœé¡µé¢çš„å†…å®¹æ˜¯é€šè¿‡ JS æ¸²æŸ“ä¸Šå»çš„ï¼Œåˆ™ä¸åˆ©äº SEO JS åˆ›å»º div æ¯”å¦‚ Vue çš„ HTML å†…åˆå§‹å°±åªæœ‰ä¸€ä¸ª div#appï¼Œè¿™ä¸ª div çš„å†…å®¹æ˜¯é€šè¿‡ JS åé¢å¡«å……è¿›å»çš„ï¼Œå› æ­¤ Vue ä¸åˆ©äº SEOï¼ˆå¯ä»¥ç”¨ SSR æ¥è§£å†³ Vue çš„ SEO é—®é¢˜ï¼‰ è§£å†³ã€ŒSEO ä¸å‹å¥½ã€æ–¹æ³•ï¼š åŸåˆ™ä¸Šåªè¦è®© curl èƒ½å¾—åˆ°é¡µé¢çš„ä¿¡æ¯ï¼ŒSEO å°±èƒ½æ­£å¸¸å·¥ä½œ æŠŠ titleã€descriptionã€keywordã€metaã€h1ã€a å†™å¥½å³å¯ ç™¾åº¦çš„ SEO å°±æ˜¯ä¸ªç¬‘è¯ï¼Œå……é’±ä½ å°±èƒ½å˜å¼º Google å…¶å®å¯ä»¥è·å– JS åˆ›å»ºçš„å†…å®¹ï¼Œä½†æ¯•ç«Ÿåœ¨å¢™å¤–ï¼Œå›½å†…è¿˜æ˜¯åˆ«æƒ³äº†","tags":["Vue","SEO","Vue compiler"],"categories":["å­¦ä¹ ç¬”è®°"]},{"title":"æœ‹å‹ä»¬","path":"/friends/index.html","content":"Notevå„ªèŒåˆè¯äº‘ä¹‹å·…æ¶¼é¢¨æ¡œé›¨æ˜Ÿæ—¥è¯­Hairy'Blog"}]